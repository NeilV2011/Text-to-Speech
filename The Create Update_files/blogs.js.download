!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=42)}([function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"translate",value:function(e){return window._translations?null!==e?_translations[e]||e:void 0:e}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=new o},function(e,t,n){"use strict";var a=n(2),o=n(0),r=n(6);function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var s=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chosen=function(e){var n=parseInt($(e.target).data("choice")),a=t.modals[0].callbacks.onChoice[n];t.close(),a&&a()},this.close=function(){var e=null;if(t.modals.length>0){var n=t.modals.shift();$("#modal-"+n.id).remove(),e=n.callbacks.onClose}t.draw(),e&&e()},this.modals=[],$("body").on("click",".alert-modal .close, .choice-modal .close",this.close),$("body").on("click",".choice-modal .choice",this.chosen)}var t,n,s;return t=e,(n=[{key:"draw",value:function(){if($(".modal").hide(),0==this.modals.length)$("#overlay-mask-new").hide();else{$("#overlay-mask-new").show();var e=this.modals[0];$("#modal-"+e.id).show(),setTimeout((function(){$("#modal-".concat(e.id," .auto-focus")).focus()}),100)}}},{key:"open",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.a.close(),this.modals.unshift({id:e,callbacks:n}),$("#overlay-new").append(t),this.draw()}},{key:"alert",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n=i.hideFooter?"":i.customFooter?'<div class="modal-footer">'.concat(o.a.translate(i.customFooter),"</div>"):'<div class="modal-footer"><button class="close blue auto-focus">'.concat(o.a.translate("Okay"),"</button></div>");var s=i.customClass||"",l=a.a.getUniqueId(),c='\n      <div id="modal-'.concat(l,'" class="modal alert-modal ').concat(s,'">\n        <div class="modal-content">\n          <div class="modal-header">\n            <div class="modal-title">').concat(o.a.translate(e),'</div>\n            <div class="close close-x" aria-label="Close">\n              <span aria-hidden="true">×</span>\n            </div>\n          </div>\n          <div class="modal-body">\n            ').concat(o.a.translate(t),"\n          </div>\n          ").concat(n,"\n        </div>\n      </div>");this.open(l,c,{onClose:r})}},{key:"loading",value:function(e){var t=a.a.getUniqueId(),n='\n      <div id="modal-'.concat(t,'" class="modal loading-modal">\n        <div class="modal-content">\n          <div class="modal-body">\n            <div class="msg">').concat(o.a.translate(e),'</div>\n            <div class="spinner"><i class="fa fa-spinner fa-spin fa-2x"></i></div>\n          </div>\n        </div>\n      </div>');this.open(t,n)}},{key:"choice",value:function(e,t,n,r){var i=a.a.getUniqueId(),s='\n      <div id="modal-'.concat(i,'" class="modal choice-modal">\n        <div class="modal-content">\n          <div class="modal-header">\n            <div class="modal-title">').concat(o.a.translate(e),'</div>\n            <div class="close close-x" aria-label="Close">\n              <span aria-hidden="true">×</span>\n            </div>\n          </div>\n          <div class="modal-body">\n            ').concat(o.a.translate(t),'\n          </div>\n          <div class="modal-footer">\n            <button class="choice blue" data-choice="0">').concat(o.a.translate(n[0]),'</button>\n            <button class="choice blue" data-choice="1">').concat(o.a.translate(n[1]),"</button>\n          </div>\n        </div>\n      </div>");this.open(i,s,{onChoice:r})}}])&&i(t.prototype,n),s&&i(t,s),e}();t.a=new s},function(e,t,n){"use strict";n(0);function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i={"Á":"A","À":"A","Â":"A","Ä":"A","Ǎ":"A","Ă":"A","Ā":"A","Ã":"A","Å":"A","Ǻ":"A","Ą":"A","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ɓ":"B","Ć":"C","Ċ":"C","Ĉ":"C","Č":"C","Ç":"C","Ď":"D","Ḍ":"D","Đ":"D","Ɗ":"D","Ð":"D","É":"E","È":"E","Ė":"E","Ê":"E","Ë":"E","Ě":"E","Ĕ":"E","Ē":"E","Ę":"E","Ẹ":"E","Ǝ":"E","Ə":"E","Ɛ":"E","Ġ":"G","Ĝ":"G","Ǧ":"G","Ğ":"G","Ģ":"G","Ĥ":"H","Ḥ":"H","Ħ":"H",I:"I","Í":"I","Ì":"I","İ":"I","Î":"I","Ï":"I","Ǐ":"I","Ĭ":"I","Ī":"I","Ĩ":"I","Į":"I","Ị":"I","Ĳ":"IJ","Ĵ":"J","Ķ":"K","Ƙ":"K","Ĺ":"L","Ļ":"L","Ł":"L","Ľ":"L","Ŀ":"L","ʼN":"N","Ń":"N","N̈":"N","Ň":"N","Ñ":"N","Ņ":"N","Ó":"O","Ò":"O","Ô":"O","Ö":"O","Ǒ":"O","Ŏ":"O","Ō":"O","Õ":"O","Ő":"O","Ǫ":"O","Ọ":"O","Ø":"O","Ǿ":"O","Ơ":"O","Œ":"OE","Ŕ":"R","Ř":"R","Ŗ":"R","Ś":"S","Ŝ":"S","Š":"S","Ş":"S","Ș":"S","Ṣ":"S","ß":"SS","ẞ":"SS","Þ":"TH","þ":"TH","Ť":"T","Ţ":"T","Ṭ":"T","Ŧ":"T","Ț":"T","Ú":"U","Ù":"U","Û":"U","Ü":"U","Ǔ":"U","Ŭ":"U","Ū":"U","Ũ":"U","Ű":"U","Ů":"U","Ų":"U","Ụ":"U","Ư":"U","Ẃ":"W","Ẁ":"W","Ŵ":"W","Ẅ":"W","Ý":"Y","Ỳ":"Y","Ŷ":"Y","Ÿ":"Y","Ȳ":"Y","Ỹ":"Y","Ƴ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","ș":"S"},s="ABCDEFGHIJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789",l=[{name:"arabic",code:"ar",native:"اَلْعَرَبِيَّةُ‎",points:!1,all:"",recent:"",translated:!0},{name:"bulgarian",code:"bg",native:"български",points:!1,all:"",recent:"",translated:!1},{name:"chinese",code:"cn",native:"简体中文",points:!1,all:"",recent:"",translated:!1},{name:"croatian",code:"hr",native:"hrvatski",points:!1,all:"",recent:"",translated:!1},{name:"czech",code:"cz",native:"čeština",points:!1,all:"",recent:"",translated:!1},{name:"danish",code:"dk",native:"dansk",points:!1,all:"",recent:"",translated:!1},{name:"dutch",code:"nl",native:"nederlands",points:!0,all:"aanbevolen",recent:"recent",translated:!0},{name:"english",code:"en",native:"english",points:!0,all:"all",recent:"recent",translated:!1},{name:"finnish",code:"fi",native:"suomi",points:!0,all:"suositellut",recent:"viimeaikaiset",translated:!0},{name:"french",code:"fr",native:"français",points:!0,all:"propose",recent:"recent",translated:!0},{name:"german",code:"de",native:"deutsch",points:!0,all:"featured",recent:"aktuelle",translated:!0},{name:"greek",code:"el",native:"eλληνικά",points:!1,all:"",recent:"",translated:!1},{name:"hungarian",code:"hu",native:"magyar",points:!1,all:"",recent:"",translated:!1},{name:"italian",code:"it",native:"italiano",points:!0,all:"featured",recent:"recente",translated:!0},{name:"japanese",code:"jp",native:"日本語",points:!1,all:"",recent:"",translated:!1},{name:"norwegian",code:"no",native:"norsk",points:!1,all:"",recent:"",translated:!1},{name:"polish",code:"pl",native:"polski",points:!0,all:"wszystkie",recent:"ostatni",translated:!0},{name:"portuguese",code:"pt",native:"português",points:!0,all:"destacados",recent:"recente",translated:!0},{name:"russian",code:"ru",native:"русский",points:!1,all:"",recent:"",translated:!1},{name:"serbian",code:"sr",native:"српски",points:!1,all:"",recent:"",translated:!1},{name:"spanish",code:"es",native:"español",points:!0,all:"recomendado",recent:"reciente",translated:!0},{name:"swedish",code:"se",native:"svenska",points:!1,all:"",recent:"",translated:!1},{name:"turkish",code:"tr",native:"türkçe",points:!1,all:"",recent:"",translated:!1}],c=new RegExp(/{[^}]*}/),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"copyTextToClipboard",value:function(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.focus(),t.select();var n=!1;try{n=document.execCommand("copy")}catch(e){}return document.body.removeChild(t),n}},{key:"capFirstLetter",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},{key:"randomInt",value:function(e,t){return e+Math.floor(Math.random()*(t-e))}},{key:"getRandomFromArray",value:function(e,t){for(var n=Object.assign([],e),a=[],o=0;o<t&&0!=n.length;o++){var r=Math.floor(Math.random()*n.length);a.push(n[r]),n.splice(r,1)}return a}},{key:"drawUnderlinedDisplay",value:function(e){return this.hasBrackets(e)?e.replace(/{([^}]*)}/g,'<span class="underline">$1</span>'):e}},{key:"stripLineBreak",value:function(e){return e.replace(/<BR[^>]*>/gi," ")}},{key:"breakArray",value:function(e,t){for(var n=[],a=e.length,o=0;o<t;o++){var r=Math.ceil((a-o)/t);n[o]=e.splice(0,r)}return n}},{key:"isPointsLanguage",value:function(e){var t,n=a(l);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.name==e&&o.points)return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"escapeQuotes",value:function(e){return e.replace(/"/g,"&quot;")}},{key:"getLanguages",value:function(){return l}},{key:"getPointsLanguageObjects",value:function(){return l.filter((function(e){return e.points}))}},{key:"getPointsLanguages",value:function(){return this.getPointsLanguageObjects().map((function(e){return e.name}))}},{key:"getTranslatedAndEnglishObjects",value:function(){return l.filter((function(e){return e.translated||"english"==e.name}))}},{key:"getTranslatedLanguageObjects",value:function(){return l.filter((function(e){return e.translated}))}},{key:"getTranslatedLanguages",value:function(){return l.filter((function(e){return e.translated})).map((function(e){return e.name}))}},{key:"secondsToClock",value:function(e){var t=Math.floor(e/60);return(e%=60)<10&&(e="0"+e),t+":"+e}},{key:"timeToSeconds",value:function(e){var t=e.match(/^([0-9]+):([0-9]+)/);return null==t?null:60*parseInt(t[1])+parseInt(t[2])}},{key:"hasBrackets",value:function(e){return c.test(e)}},{key:"stripTags",value:function(e){return e.replace(/<[^>]*>/g,"")}},{key:"getStrippedBracketedText",value:function(e){return e=this.stripTags(e),this.getBracketedText(e)}},{key:"getBracketedText",value:function(e){var t=e.match(/{[^}]*}/g);return null==t?e:t.join(" ").replace(/[{}]/g,"")}},{key:"isNameSuffix",value:function(e){return e.replace(/[^0-9]/g,"")==e||nameSuffixes.indexOf(e)>=0}},{key:"getAnswerList",value:function(e){var t,n=[],o=a(e.answerOrder);try{for(o.s();!(t=o.n()).done;){var r=t.value;n.push(e.answers[r])}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"getActiveAnswerList",value:function(e){var t,n=[],o=a(e.answerOrder);try{for(o.s();!(t=o.n()).done;){var r=t.value,i=e.answers[r];"ts"==e.whatkind?i.display=i.text:"mc"==e.whatkind&&(i.display=null!=i.text?i.text:""),""!=i.display.trim()&&n.push(i)}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"getActivePhotoAnswers",value:function(e){var t=this.getActiveAnswerList(e);return t=t.filter((function(e){return null!=e.image}))}},{key:"normalizeString",value:function(e){return e=(e=this.stripTags(e)).toUpperCase(),e=(e=this.replaceForeign(e)).replace(/[^A-Z0-9]/g,"")}},{key:"normalizeWords",value:function(e){return e=(e=this.stripTags(e)).toUpperCase(),e=(e=(e=(e=(e=this.replaceForeign(e)).replace(/['.,/]/g,"")).replace(/[^A-Z0-9 ]/g," ")).replace(/[ ]+/g," ")).trim()}},{key:"urlify",value:function(e){return this.normalizeWords(e).toLowerCase().replace(/[ ]/g,"-")}},{key:"replaceForeign",value:function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];t.push(i[a]||a)}return t.join("")}},{key:"getQuizUrl",value:function(e,t){return 1==e?"/quizzes/".concat(t):"/user-quizzes/".concat(e,"/").concat(t)}},{key:"getUniqueIdArray",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getUniqueId());return t}},{key:"getUniqueId",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=[],n=0;n<e;n++){var a=Math.floor(Math.random()*s.length);t.push(s[a])}return t.join("")}},{key:"classNames",value:function(e){var t=[];for(var n in e)e[n]&&t.push(n);return t.join(" ")}},{key:"constrainRange",value:function(e,t,n){return e<t?t:e>n?n:e}},{key:"rangeLoop",value:function(e,t){return e<0?t-1:e>=t?0:e}},{key:"getImageUrl",value:function(e,t){var n=e.fn.substring(0,2);return"/img/user-photo-library/".concat(n,"/").concat(e.fn,"-").concat(t,".").concat(e.ext)}},{key:"getColWidth",value:function(e){return 3==e?235:4==e?175:135}},{key:"constrainImageSize",value:function(e,t,n){if(e>t){if(e>n)return{h:n,w:Math.round(n*t/e)}}else if(t>n)return{h:Math.round(n*e/t),w:n};return{h:e,w:t}}},{key:"svgAddClass",value:function(e,t){$(e).addClass(t)}},{key:"svgRemoveClass",value:function(e,t){$(e).removeClass(t)}},{key:"arrayUnique",value:function(e){for(var t=[],n={},a=0;a<e.length;a++){var o=e[a];n[o]||(n[o]=!0,t.push(o))}return t}},{key:"getMaxUserLevel",value:function(e){var t=1;for(var n in e)e[n].level>t&&(t=e[n].level);return t}},{key:"convertObjectToArray",value:function(e){var t=[];for(var n in e)t.push(e[n]);return t}},{key:"isQuizmaster",value:function(e){return!!e.user&&!![1,176412].includes(e.user.uid)}},{key:"isTrustedUser",value:function(e){if(!e.user||!e.data.quiz)return!1;if(null!=e.data.quiz){if(61345==e.user.uid&&"french"==e.language&&(!e.data.quiz.searchlevel||1==e.data.quiz.searchlevel))return!0;if(234916==e.user.uid&&"dutch"==e.language&&(!e.data.quiz.searchlevel||1==e.data.quiz.searchlevel))return!0;if(24141==e.user.uid&&"german"==e.language&&(!e.data.quiz.searchlevel||1==e.data.quiz.searchlevel))return!0;if(272526==e.user.uid&&"german"==e.language&&(!e.data.quiz.searchlevel||1==e.data.quiz.searchlevel))return!0;if(!(180029!=e.user.uid&&238457!=e.user.uid||"polish"!=e.language||e.data.quiz.searchlevel&&1!=e.data.quiz.searchlevel))return!0}return!1}},{key:"getLangProp",value:function(e,t){var n,o=a(l);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r.name==e&&r.points)return r[t]}}catch(e){o.e(e)}finally{o.f()}return"en"}}])&&r(t.prototype,n),o&&r(t,o),e}();t.a=new u},function(e,t,n){"use strict";var a=n(1);function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"err",value:function(e,t){e||(e="An unknown error occurred"),a.a.close(),t?t(e):a.a.alert("Error",e)}},{key:"go",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.url,o=t.data,r=t.callback||null,i=t.timeout||5e3,s=t.type||"POST",l=t.timeoutMsg||"Timeout",c=t.errCallback||null;"DONOTLOAD"!==t.loading&&a.a.loading(t.loading||"Loading ...");var u={type:s,url:n,data:o,timeout:i,success:function(n){var o;try{o=JSON.parse(n)}catch(t){return void e.err("An unknown error occurred",c)}o.success?("DONOTLOAD"!==t.loading&&a.a.close(),r&&r(o.obj)):e.err(o.err,c)},error:function(t,n){var a="timeout"==n?l:"An unknown error occurred";e.err(a,c)}};t.fileUpload&&(u.processData=!1,u.contentType=!1),$.ajax(u)}}])&&o(t.prototype,n),r&&o(t,r),e}();t.a=new r},function(e,t,n){"use strict";var a=n(2),o=n(10),r=n(5),i=n(0);function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.createTypein=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"s";return{val:e,mode:t}},this.DEFAULT_LANGUAGE=_page.user?_page.user.language:"english",this.DEFAULT_WIDTH=730,this.DEFAULT_SECONDS=240,this.DEFAULT_FIXED_COLS=4,this.DEFAULT_TITLE="Quiz Title",this.DEFAULT_INSTRUCTIONS="Quiz instructions",this.DEFAULT_ANSWERBOX="Enter answer here",this.STYLE_ATTRIBS=["bgc","c","bc","bw","fw","fs","hp","vp"],this.STYLE_LINK_ATTRIBS=["mode","bidx","aid","acol","rid","icid","cid"],this.DEFAULT_STYLE={bc:"ccc",bw:1,c:"000",bgc:"fff",fw:"normal",fs:14,hp:10,vp:5}}var t,n,l;return t=e,(n=[{key:"createGameState",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a={paused:!1,pausesLeft:3,untimed:!1,timeUsed:0,numGuessed:0,seconds:e.seconds,active:!1,finished:!1,answers:[]},i=new o.a,l=s(e.answers);try{for(l.s();!(t=l.n()).done;)(d=t.value).guessed=!1,"v"==e.whatkind&&(d.display=d.cols[e.answerColIdx]),"v"!=e.whatkind&&"p"!=e.whatkind||d.typeins||("auto"==d.mode?d.typeins=r.a.getAutoTypeins(d,n,i).typeins:d.typeins=r.a.getExactTypeins(d.display,d.isName)),"m"!=e.whatkind&&"mc"!=e.whatkind||(d.whichChosen=null),"ts"==e.whatkind&&(d.selected=!1),a.answers.push(d)}catch(e){l.e(e)}finally{l.f()}a.answersById={};var c,u=s(a.answers);try{for(u.s();!(c=u.n()).done;){var d=c.value;a.answersById[d.id]=d}}catch(e){u.e(e)}finally{u.f()}return a}},{key:"createTileQuiz",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createQuiz(e);if(delete t.numRandom,t.whatkind="ts",t.answerBoxText=null!=e.answerBoxText?e.answerBoxText:"Select all...",t.useExplanations=e.useExplanations||!1,t.randomizeTiles=e.randomizeTiles||!1,e.answers)for(var n in t.questionOrder=Object.assign([],e.questionOrder),t.questions={},e.questions)t.questions[n]=this.createTileQuestion(e.questions[n]);else{t.questionOrder=[],t.questions={};for(var a=0;a<5;a++){var o=this.createTileQuestion();t.questionOrder.push(o.id),t.questions[o.id]=o,0==a&&(t.questions[o.id].collapsed=!1)}}var r,i=s(t.questionOrder);try{for(i.s();!(r=i.n()).done;){var l=r.value,c=t.questions[l];for(var u in c.tiles)t.answerOrder.push(u),t.answers[u]=c.tiles[u],t.answers[u].qid=c.id}}catch(e){i.e(e)}finally{i.f()}return t}},{key:"createTileQuestion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||a.a.getUniqueId(),question:e.question||"",explanation:e.explanation||""};if(e.tiles){for(var n in t.tilesGrid=Object.assign({},e.tilesGrid),t.tiles={},e.tiles)null==e.tiles[n].text?t.tiles[n]=this.createPictureTile(e.tiles[n]):t.tiles[n]=this.createTile(e.tiles[n]);t.height=e.height,t.width=e.width,t.collapsed=e.collapsed}else{t.tilesGrid={},t.tiles={},t.height=4,t.width=4;for(var o=0;o<t.height;o++)for(var r=0;r<t.width;r++){var i=this.createTile();i.qid=e.id,t.tilesGrid[o+"-"+r]=i.id,t.tiles[i.id]=i}t.collapsed=!0}return t}},{key:"createTile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||a.a.getUniqueId(),text:e.text||"",sel:e.sel||!1,qid:e.qid||"",smalltext:e.smalltext||!1}}},{key:"createPictureTile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||a.a.getUniqueId(),image:e.image?this.createImage(e.image):null,border:e.border||0,sel:e.sel||!1,qid:e.qid||"",smalltext:e.smalltext||!1}}},{key:"createMcQuiz",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createQuiz(e);if(t.whatkind="mc",t.randomizeChoices=e.randomizeChoices||!1,t.useExplanations=e.useExplanations||!1,e.answers){for(var n in t.answerOrder=Object.assign([],e.answerOrder),t.answers={},e.answers)if(t.answers[n]=this.createMcAnswer(e.answers[n]),1==e.imageBorderWidth)for(var a in t.answers[n].choices)null==t.answers[n].choices[a].text&&(t.answers[n].choices[a].border=1)}else for(var o=0;o<15;o++){var r=this.createMcAnswer();t.answerOrder.push(r.id),t.answers[r.id]=r}return t}},{key:"createMcAnswer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||a.a.getUniqueId(),question:e.question||"",explanation:e.explanation||"",width:e.width||1,collapsed:e.collapsed||!1};if(e.choices){for(var n in t.choiceOrder=Object.assign([],e.choiceOrder),t.choices={},e.choices)null==e.choices[n].text?t.choices[n]=this.createMcPictureChoice(e.choices[n]):t.choices[n]=this.createMcChoice(e.choices[n]);t.correctChoice=e.correctChoice}else{t.choiceOrder=[],t.choices={};for(var o=0;o<4;o++){var r=this.createMcChoice();t.choiceOrder.push(r.id),t.choices[r.id]=r}t.correctChoice=t.choiceOrder[0]}return t}},{key:"createMcChoice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||a.a.getUniqueId(),text:e.text||""}}},{key:"createMcPictureChoice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||a.a.getUniqueId(),image:e.image?this.createImage(e.image):null,border:e.border||0}}},{key:"createMapQuiz",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createQuiz(e);if(t.title=e.title||"Quiz Title - Map Quiz",t.whatkind="m",t.svg=e.svg?this.createSVG(e.svg):null,t.headers=e.headers?Object.assign([],e.headers):["Path","Answer"],t.width=e.width||this.DEFAULT_WIDTH,t.style=e.style?Object.assign([],e.style):["36c","fff"],t.selectorSize=e.selectorSize?Object.assign([],e.selectorSize):["Auto",160],t.sortOrder=e.sortOrder||"Alphabetical",t.selectText=e.selectText||"Select "+t.headers[1],e.answers)for(var n in t.answerOrder=Object.assign([],e.answerOrder),t.answers={},e.answers)t.answers[n]=this.createMapAnswer(e.answers[n]);else for(var a=0;a<15;a++){var o=this.createMapAnswer();t.answerOrder.push(o.id),t.answers[o.id]=o}return t}},{key:"createMapAnswer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||a.a.getUniqueId(),display:e.display||"",path:e.path||""};return t}},{key:"createPictureQuiz",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createQuiz(e);if(t.whatkind="p",t.answerBoxText=e.answerBoxText||this.DEFAULT_ANSWERBOX,t.answerBoxText==this.DEFAULT_ANSWERBOX&&(t.answerBoxText=i.a.translate(this.DEFAULT_ANSWERBOX)),t.useHints=e.useHints||!1,t.photoLayout=e.photoLayout||"fixed",t.fixedCols=e.fixedCols||this.DEFAULT_FIXED_COLS,t.mobileMode=e.mobileMode||"stack",e.answers)for(var n in t.answerOrder=Object.assign([],e.answerOrder),t.answers={},e.answers)t.answers[n]=this.createPictureAnswer(e.answers[n]),1==e.imageBorderWidth&&(t.answers[n].border=1);else for(var a=0;a<15;a++){var o=this.createPictureAnswer();t.answerOrder.push(o.id),t.answers[o.id]=o}return t}},{key:"shallowCopyGrid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{blockOrder:Object.assign([],e.blockOrder),blocks:Object.assign({},e.blocks),rows:Object.assign({},e.rows),cells:Object.assign({},e.cells),innerCols:Object.assign({},e.innerCols)}}},{key:"createTextQuiz",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createQuiz(e);if(t.whatkind="v",t.answerBoxText=e.answerBoxText||this.DEFAULT_ANSWERBOX,t.answerBoxText==this.DEFAULT_ANSWERBOX&&(t.answerBoxText=i.a.translate(this.DEFAULT_ANSWERBOX)),t.mobileMode=e.mobileMode||"default",t.colOrder=e.colOrder?Object.assign([],e.colOrder):[a.a.getUniqueId(),a.a.getUniqueId()],e.headers?t.headers=Object.assign({},e.headers):(t.headers={},t.headers[t.colOrder[0]]="Hint",t.headers[t.colOrder[1]]="Answer"),t.answerCol=e.answerCol||t.colOrder[1],t.designMode=e.designMode||"auto",t.autoBlocks=e.autoBlocks||2,e.answers)for(var n in t.answerOrder=Object.assign([],e.answerOrder),t.answers={},e.answers)t.answers[n]=this.createTextAnswer(e.answers[n]);else for(var o=0;o<15;o++){var r=this.createTextAnswer();t.answerOrder.push(r.id),t.answers[r.id]=r}for(var s in t.styles={},e.styles)t.styles[s]=this.createStyle(e.styles[s]);if(-1==e.id)for(var l=0;l<2;l++){var c=this.createAutoHeaderStyle(l);t.styles[c.id]=c}for(var u in t.blockOrder=Object.assign([],e.blockOrder),t.blocks={},t.rows={},t.cells={},t.innerCols={},e.blocks)t.blocks[u]=this.createGridBlock(e.blocks[u]);for(var d in e.rows)t.rows[d]=this.createGridRow(e.rows[d]);for(var h in e.innerCols)t.innerCols[h]=this.createGridInnerCol(e.innerCols[h]);for(var p in e.cells)t.cells[p]=this.createGridCell(e.cells[p]);for(var g in t.mergeBoxes={},e.mergeBoxes)t.mergeBoxes[g]=this.createMergeBox(e.mergeBoxes[g]);for(var m in t.triggers={},e.triggers)t.triggers[m]=this.createTrigger(e.triggers[m]);return t.customType=e.customType||null,"svg"==t.customType?t.customType=null:"randomsvg"==t.customType&&(t.customType="random"),t.svg=e.svg?this.createSVG(e.svg):null,t.numRandom=e.numRandom||20,t.numRandomGroup=e.numRandomGroup||2,t.crossColumns=e.crossColumns||null,t.missingDotsTextShow=e.missingDotsTextShow||"Show Missing Countries",t.missingDotsTextHide=e.missingDotsTextHide||"Hide Missing Countries",t}},{key:"createQuiz",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.caveats||[];return t=t.filter((function(e){return!!e&&""!=e.trim()})),{id:e.id||-1,language:e.language||this.DEFAULT_LANGUAGE,private:e.private||0,seconds:e.seconds||this.DEFAULT_SECONDS,instructions:e.instructions||this.DEFAULT_INSTRUCTIONS,title:e.title||this.DEFAULT_TITLE,yellowBox:e.yellowBox||!1,caveats:t,width:e.width||this.DEFAULT_WIDTH,answerOrder:[],thumb:e.thumb?this.createImage(e.thumb):null,answers:{},numRandom:e.numRandom||-1}}},{key:"createSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{height:e.height||-1,width:e.width||-1,fn:e.fn||"",placement:e.placement||"top",source:e.source||"user",hiddenPaths:e.hiddenPaths||!1}}},{key:"createImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{raw:e.raw||-1,ext:e.ext||"",transformation:e.transformation?Object.assign({},e.transformation):{},fn:e.fn||"",w:e.w||-1,h:e.h||-1,src:e.src||"",url:e.url||""}}},{key:"createAnswer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||a.a.getUniqueId(),display:e.display||"",isName:e.isName||!1,typeinMode:e.typeinMode||"auto",typeins:null};if("custom"==e.typeinMode){t.typeins=[];var n,o=s(e.typeins);try{for(o.s();!(n=o.n()).done;){var r=n.value;t.typeins.push(this.createTypein(r.val,r.mode))}}catch(e){o.e(e)}finally{o.f()}}return t}},{key:"createPictureAnswer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createAnswer(e);return t.hint=e.hint||"",t.image=e.image?this.createImage(e.image):null,t.customWidth=e.customWidth||-1,t.border=e.border||0,t}},{key:"createTextAnswer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createAnswer(e);return t.cols=e.cols?Object.assign({},e.cols):{},t}},{key:"createAutoHeaderStyle",value:function(e){return this.createStyle({mode:"row",bidx:e,bc:"36c",bgc:"36c",c:"fff",fs:15})}},{key:"createManualHeaderStyle",value:function(e){return this.createStyle({mode:"row",rid:e,bc:"36c",bgc:"36c",c:"fff",fs:15})}},{key:"createStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};t.id=e.id||a.a.getUniqueId();var n,o=s(this.STYLE_ATTRIBS);try{for(o.s();!(n=o.n()).done;){var r=n.value;r in e&&(t[r]=e[r])}}catch(e){o.e(e)}finally{o.f()}var i,l=s(this.STYLE_LINK_ATTRIBS);try{for(l.s();!(i=l.n()).done;){var c=i.value;c in e&&(t[c]=e[c])}}catch(e){l.e(e)}finally{l.f()}return t}},{key:"createGridInnerCol",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||a.a.getUniqueId()};return t}},{key:"createGridCell",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||a.a.getUniqueId(),type:e.type||"t",text:e.text||""};return e.aid&&(t.aid=e.aid),e.acol&&(t.acol=e.acol),t}},{key:"createGridRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||a.a.getUniqueId(),cellOrder:Object.assign([],e.cellOrder)};return t}},{key:"createGridBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||a.a.getUniqueId(),rowOrder:Object.assign([],e.rowOrder),innerColOrder:Object.assign([],e.innerColOrder)}}},{key:"createMergeBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||a.a.getUniqueId(),bid:e.bid,rows:Object.assign([],e.rows),cols:Object.assign([],e.cols)}}},{key:"createTrigger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||a.a.getUniqueId(),aid:e.aid,cid:e.cid}}}])&&c(t.prototype,n),l&&c(t,l),e}();t.a=new u},function(e,t,n){"use strict";var a=n(2),o=n(4);function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=["JR","JUNIOR","SENIOR","SR","I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI"],c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.suffixMap=null}var t,n,i;return t=e,(n=[{key:"normalizeUnicode",value:function(e){return e=(e=a.a.stripTags(e)).toUpperCase(),e=(e=(e=a.a.replaceForeign(e)).replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,\-.\/:;<=>?@\[\]^_`{|}~ʻ]/g,"")).replace(/[\s]/g,"")}},{key:"normalizeWordsUnicode",value:function(e){return e=(e=a.a.stripTags(e)).toUpperCase(),e=(e=(e=(e=(e=a.a.replaceForeign(e)).replace(/['.,]/g,"")).replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,\-.\/:;<=>?@\[\]^_`{|}~ʻ]/g," ")).replace(/[\s]+/g," ")).trim()}},{key:"normalizeRegex",value:function(e){return e=(e=a.a.stripTags(e)).toUpperCase(),e=(e=(e=a.a.replaceForeign(e)).replace(/[\u2000-\u206F\u2E00-\u2E7F'!"#%&,:;<=>@_`{}~ʻ]/g,"")).replace(/[\s]+/g,"")}},{key:"buildSuffixMap",value:function(){this.suffixMap=[];var e,t=r(l);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.suffixMap[n]=!0}}catch(e){t.e(e)}finally{t.f()}}},{key:"isNameSuffix",value:function(e){return null==this.suffixMap&&this.buildSuffixMap(),e.replace(/[^0-9]/g,"")==e||!!this.suffixMap[e]}},{key:"getLastName",value:function(e){var t=this.normalizeWordsUnicode(e).split(" ");if(1==t.length)return t[0];var n=t[t.length-1];return this.isNameSuffix(n)&&(n=t[t.length-2]),n}},{key:"isValidRegex",value:function(e){try{new RegExp(e)}catch(e){return!1}return!0}},{key:"typeinBlank",value:function(e){return""==this.normalizeUnicode(e.val)}},{key:"getRegexErrors",value:function(e){var t,n=[],a=r(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;"r"==o.mode&&(this.isValidRegex(o.val)||n.push("Regex "+o.val+" is invalid"))}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"typesinMatchNormalized",value:function(e,t){var n,a=r(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!this.typeinBlank(o)){var i=!1;switch(o.mode){case"s":i=e.startsWith(o.val);break;case"e":i=e.endsWith(o.val);break;case"c":i=e.includes(o.val);break;case"r":i=new RegExp(o.val).test(e)}if(i)return!0}}}catch(e){a.e(e)}finally{a.f()}return!1}},{key:"typesinMatch",value:function(e,t){return e=this.normalizeUnicode(e),this.typesinMatchNormalized(e,t)}},{key:"typesinMatchGame",value:function(e,t){var n,a=r(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(e.match(o))return!0}}catch(e){a.e(e)}finally{a.f()}return!1}},{key:"typesinMatchGameRegex",value:function(e,t){var n,a=r(t);try{for(a.s();!(n=a.n()).done;)if(n.value.test(e))return!0}catch(e){a.e(e)}finally{a.f()}return!1}},{key:"getCustomTypeins",value:function(e){var t,n=[],a=r(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!this.typeinBlank(o))switch(o.mode){case"s":n.push("^"+o.val);break;case"e":n.push(o.val+"$");break;case"c":case"r":n.push(o.val)}}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"getCustomTypeinsRegex",value:function(e){var t,n=[],a=r(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!this.typeinBlank(o))switch(o.mode){case"s":n.push(new RegExp("^"+o.val));break;case"e":n.push(new RegExp(o.val+"$"));break;case"c":case"r":n.push(new RegExp(o.val))}}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"getKeyForRecommended",value:function(e){var t=a.a.getStrippedBracketedText(e);return this.normalizeUnicode(t)}},{key:"getAutoTypeins",value:function(e,t,n){var o,i=[],s=!0,l=r(a.a.getStrippedBracketedText(e.display).split(/[/|]/));try{for(l.s();!(o=l.n()).done;){var c=o.value,u=this.getKeyForRecommended(c),d=void 0;t[u]?d=t[u]:(d=n.create(c,e.isName),s=!1),i=i.concat(d)}}catch(e){l.e(e)}finally{l.f()}return{typeins:i,official:s}}},{key:"getExactTypeins",value:function(e,t){var n=a.a.getStrippedBracketedText(e),r=o.a.createTypein(this.normalizeUnicode(n));if(!t)return[r];var i=this.normalizeWordsUnicode(n).split(" ");if(i.length<=1)return[r];if(this.isNameSuffix(i[i.length-1])&&i.pop(),2==i.length)return[o.a.createTypein(i.join("")),o.a.createTypein(i[1])];for(var s="^",l=0;l<i.length-1;l++)s=s+"("+i[l]+")?";return s+=i[i.length-1],[o.a.createTypein(s,"r")]}}])&&s(t.prototype,n),i&&s(t,i),e}();t.a=new c},function(e,t,n){"use strict";n(0),n(2);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.linkClicked=function(e){var t=$(e.target).closest(".nav-dropdown-link"),a=$(t).data("dropdown"),o=$(t).position().left-$(".brand").position().left+25;"admin-dropdown"==a&&(o=o-$("#"+a).width()-50),n.open(a,o)},this.checkClose=function(e){0===$(e.target).closest(".nav-dropdown").length&&0===$(e.target).closest(".nav-dropdown-link").length&&n.close()},this.page=t,this.callback=null,this.openId=null,$(".nav-dropdown-link").on("click",this.linkClicked)}var t,n,o;return t=e,(n=[{key:"open",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=this.openId;null!==a&&this.close(),a!=e&&($("#"+e).show(),"user-dropdown"!=e&&$("#"+e).css("left",t),$(document).on("mouseup",this.checkClose),this.callback=n,this.openId=e)}},{key:"close",value:function(){$(".nav-dropdown").hide(),$(document).off("mouseup",this.checkClose),this.callback&&this.callback(),this.openId=null}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=new o},function(e,t,n){"use strict";var a=n(4),o=n(2),r=n(1);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DEFAULT_LANGUAGE=_page.user?_page.user.language:"english",this.ACTION_TRIGGERS=[" ","-","\t","\n"],this.TYPE_HEADING="heading",this.TYPE_TEXT="text",this.TYPE_IMAGE="image",this.TYPE_DIVIDER="divider",this.TYPE_SPLIT="split",this.TYPE_HTML="html",this.VALID_TYPES=[this.TYPE_HEADING,this.TYPE_TEXT,this.TYPE_IMAGE,this.TYPE_DIVIDER,this.TYPE_SPLIT,this.TYPE_HTML],this.DEFAULTS=(i(t={},this.TYPE_HEADING,"New Heading..."),i(t,this.TYPE_TEXT,"New Paragraph..."),i(t,this.TYPE_IMAGE,"Optional Caption..."),t)}var t,n,l;return t=e,(n=[{key:"createBlog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={id:e.id||-1,title:e.title||"",blurb:e.blurb||"",thumb:e.thumb?a.a.createImage(e.thumb):null,language:e.language||this.DEFAULT_LANGUAGE,private:e.private||0,tag:e.tag||0,quicklinks:e.quicklinks||!1,componentOrder:[],components:{}};if(e.components)for(var n in t.componentOrder=Object.assign([],e.componentOrder),e.components)t.components[n]=this.createBlogComponent(e.components[n]);else if(e.content){var o=this.createBlogComponent({type:this.TYPE_HTML});o.html=e.content,t.componentOrder=[o.id],t.components[o.id]=o}if(0==t.componentOrder.length){var r=this.createBlogComponent({type:this.TYPE_HEADING}),i=this.createBlogComponent({type:this.TYPE_TEXT});t.componentOrder=[r.id,i.id],t.components[r.id]=r,t.components[i.id]=i}return t}},{key:"createBlogComponent",value:function(e){if(!e.type||!this.VALID_TYPES.includes(e.type))return r.a.alert("Error","Invalid blog component type specified!"),null;var t={id:e.id||o.a.getUniqueId(),type:e.type,styles:this.createStyles(e.styles||{}),splitState:this.createSplitState(e.splitState||{})};switch(e.type){case this.TYPE_HEADING:t=this.createHeadingComponent(e,t);break;case this.TYPE_TEXT:t=this.createTextComponent(e,t);break;case this.TYPE_IMAGE:t=this.createImageComponent(e,t);break;case this.TYPE_DIVIDER:t=this.createDividerComponent(e,t);break;case this.TYPE_SPLIT:t=this.createSplitComponent(e,t);break;case this.TYPE_HTML:t=this.createHTMLComponent(e,t)}return t}},{key:"createStyles",value:function(e){return{"margin-top":e["margin-top"]||"0px","margin-bottom":e["margin-bottom"]||"6px","text-align":e["text-align"]||"auto"}}},{key:"createSplitState",value:function(e){return{id:e.id||"",level:e.level||0,isc1:e.isc1||!1}}},{key:"createHeadingComponent",value:function(e,t){return t.text=e.text||this.DEFAULTS[t.type],t.textStyles=this.createHeadingStyles(e.textStyles||{}),t}},{key:"createHeadingStyles",value:function(e){return{color:e.color||"#000000","font-weight":e["font-weight"]||"bold","font-size":e["font-size"]||"24px"}}},{key:"createTextComponent",value:function(e,t){return t.text=e.text||this.DEFAULTS[t.type],t}},{key:"createImageComponent",value:function(e,t){return t.image=e.image?a.a.createImage(e.image):null,t.caption=e.caption||this.DEFAULTS[t.type],t.imageBorder=e.imageBorder||0,t.borderColor=e.borderColor||"#000000",t.borderSize=e.borderSize||1,t.captionColor=e.captionColor||"#555555",t.captionSize=e.captionSize||"12px",t.captionItalics=e.captionItalics||"italic",t}},{key:"createDividerComponent",value:function(e,t){return t.color=e.color||"999999",t.thickness=e.thickness||1,t.width=e.width||95,t}},{key:"createSplitComponent",value:function(e,t){return t.direction=e.direction||"v",t.c1size=e.c1size||49,t.c1=e.c1||null,t.c2=e.c2||null,t}},{key:"createHTMLComponent",value:function(e,t){return t.html=e.html||"",t}}])&&s(t.prototype,n),l&&s(t,l),e}();t.a=new l},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),o=n(0);function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=["English"],c=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.toggleOptions=function(){$(".st-options-hidden").is(":visible")?$(".st-options-hidden").css("height","41px").animate({height:0},250,"swing",(function(e){$(".st-options-hidden").hide()})):$(".st-options-hidden").css("height",0).show().animate({height:"41px"},250)},this.openRandomLink=function(){var e=$(".super-table tr:visible a"),t=Math.floor(Math.random()*e.length);window.open(e[t].href,"_blank")},this.filterAndSearchRows=function(){$(".st-none-found").hide();var e=$(".st-sel-filter-value").val(),t=$(".st-search-table").val().split(" ").filter((function(e){return e.length>0})),n=$(".super-table-container .super-table tr:not(:first-child)");if("all"!=e||0!=t.length){if(null==e||"all"==e)if(1==t.length){var a=t[0].toLowerCase();for(r=0;r<n.length;r++)n[r].hidden=!n[r].textContent.toLowerCase().includes(a)}else for(a=new RegExp(t.map((function(e){return"(?=.*"+e+")"})).join(""),"gi"),r=0;r<n.length;r++)n[r].hidden=!a.test(n[r].textContent);else if(0==t.length)for(r=0;r<n.length;r++)n[r].hidden=n[r].dataset[i.selectedProp]!=e;else for(a=new RegExp(t.map((function(e){return"(?=.*"+e+")"})).join(""),"gi"),r=0;r<n.length;r++)n[r].hidden=!(n[r].dataset[i.selectedProp]==e&&a.test(n[r].textContent));var o=$(".super-table tr:visible").length-1;$(".st-row-count").html(o),0==o&&$(".st-none-found").show()}else{for(var r=0;r<n.length;r++)n[r].hidden=!1;$(".st-row-count").html(n.length)}},this.selectProp=function(){var e=i.selectedProp;if(i.selectedProp=$(".st-sel-filter").val(),"none"==i.selectedProp||null==i.propValues[i.selectedProp])return $(".st-sel-filter-value").html(""),$(".st-sel-filter-value").prop("disabled","disabled"),$(".super-table-container .super-table tr").prop("hidden",""),$(".st-row-count").html($(".super-table tr").length-1),void i.filterAndSearchRows();var t,n=[],s={},c=r(i.propValues[i.selectedProp]);try{for(c.s();!(t=c.n()).done;){var u=t.value,d=l.includes(u)?u:o.a.translate(u);n.includes(d)||(n.push(d),s[d]=u)}}catch(e){c.e(e)}finally{c.f()}n[0].match(/[0-9]/)?n.sort((function(e,t){return parseFloat(e.replace(/^([0-9.])[^0-9.]/,"$1"))>parseFloat(t.replace(/^([0-9.])[^0-9.]/,"$1"))?1:-1})):n.sort((function(e,t){return a.a.normalizeWords(e)>a.a.normalizeWords(t)?1:-1}));for(var h=["<option select value='all'>"+o.a.translate("All")+"</option>"],p=0,g=n;p<g.length;p++){u=g[p];h.push('<option value="'+s[u]+'">'+u+"</option>")}$(".st-sel-filter-value").prop("disabled",""),$(".st-sel-filter-value").html(h.join("")),e!=i.selectedProp&&i.filterAndSearchRows()},this.sortRows=function(e){var t=$(e.target).closest("th").data("i");$(".super-table th i.fa-chevron-up, .super-table th i.fa-chevron-down").remove(),i.sortCol!=t?(i.sortCol=t,i.sortDir=-1):i.sortDir*=-1;var n=$(".super-table tr:not(:first-child)").remove();n.sort((function(e,n){var o=e.children[i.sortCol],r=o.textContent,s=n.children[i.sortCol],l=s.textContent;return 2==i.colTypes[t]?(i.europeanNumbers&&(r=r.replace(/[\. ]/g,"").replace(/,/g,"."),l=l.replace(/[\. ]/g,"").replace(/,/g,".")),r=parseFloat(r.replace(/,/g,"")),l=parseFloat(l.replace(/,/g,"")),isNaN(r)&&(r=1e4*i.sortDir+o.textContent.length),isNaN(l)&&(l=1e4*i.sortDir+s.textContent.length)):3==i.colTypes[t]?(r=new Date($(e).data("date")),l=new Date($(n).data("date"))):4==i.colTypes[t]?(r=a.a.timeToSeconds(r),l=a.a.timeToSeconds(l)):(r=a.a.normalizeWords(r),l=a.a.normalizeWords(l)),r==l?e.rowIndex<n.rowIndex?-1:1:null==r?1:null==l?-1:r>l?i.sortDir:-1*i.sortDir})),$(".super-table").append(n),i.sortCarets()},this.page=t,this.data=n,this.colTypes=n.colTypes,this.sortCol=n.initCol,this.sortDir=n.initDir,this.props=n.props,this.propValues=n.propValues,this.selectedProp="all",this.europeanNumbers=null==t.language||!["arabic","croatian","english","other","japanese"].includes(t.language),$(".super-table-container").on("click",".st-options-button",this.toggleOptions),$(".super-table-container").on("click",".st-random-button",this.openRandomLink),$(".super-table-container").on("input",".st-search-table",this.filterAndSearchRows),$(".super-table-container").on("change",".st-sel-filter",this.selectProp),$(".super-table-container").on("change",".st-sel-filter-value",this.filterAndSearchRows),$(".super-table-container").on("click","th",this.sortRows)}var t,n,i;return t=e,(n=[{key:"sortCarets",value:function(){var e=$(".super-table th:eq(".concat(this.sortCol,")"));-1==this.sortDir?$(e).append('<i class="fa fa-chevron-down"></i>'):$(e).append('<i class="fa fa-chevron-up"></i>')}}])&&s(t.prototype,n),i&&s(t,i),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n(0),o=n(1),r=n(3),i=n(2);function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var u=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.openReportModal=function(e){if(null!=n.page.user){n.reportedId=n.getCommentId(e);var t="\n      <p>".concat(a.a.translate("Report insults, vulgar language, and spam."),"</p>\n      <p>").concat(a.a.translate("This is not a disagree button."),"</p>"),r='<button id="submit-comment-report" class="red">'.concat(a.a.translate("Report"),"</button>");o.a.alert(a.a.translate("Report Comment"),t,null,{customFooter:r})}else n.page.showAskCreate()},this.openBlockModal=function(e){if(null!=n.page.user){n.blockedId=n.getCommentId(e);var t=$(e.target).closest(".comment").find(".sn").text();o.a.alert("Block "+t,"<p>Block this user from commenting on your quizzes or blogs?</p><p>This cannot be undone.</p>",null,{customFooter:'<button id="submit-comment-block" class="red">Block</button>'})}else n.page.showAskCreate()},this.openCommentsModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(null!=n.page.user){var r=i.a.getMaxUserLevel(n.page.user.pointsObj);if(r<15&&n.owner!==n.page.user.uid)o.a.alert("Sorry","You must be at <a href='/explain-points'>Level 15</a> to comment, except on your own quizzes");else{var s=a.a.translate("Post Your Comment"),l=a.a.translate("Insults, vulgar language, and spam are strictly forbidden"),c=n.text,u="";if(-1!==t){var d=$("#comment"+t),h=n.getMinuteDifference(d);if($(d).hasClass("sticky")&&(u="checked"),h>=60&&!i.a.isQuizmaster(n.page))return void o.a.alert("Expired","The time to edit this comment has expired");var p=i.a.isQuizmaster(n.page)?"∞":60-h;c=$(d).find(".text").html().replace(/<\/p><p>/gi,"\n").replace(/<p>/gi,"").replace(/<\/p>/gi,""),s=a.a.translate("Edit Your Comment"),l=a.a.translate("You can edit this comment for the next")+" "+p+" "+a.a.translate("minutes"),n.text=c}var g="",m="";n.showQm&&r>=30&&-1==t&&(g='\n      <div class="checkbox-holder">\n        <div class="checkbox">\n          <input type="checkbox" id="chkForQuizmaster"/>\n          <label for="chkForQuizmaster"></label>\n        </div>\n        <div class="checkbox-text">'.concat(a.a.translate("This comment contains a correction or suggestion for the Quizmaster"),"</div>\n      </div>")),!i.a.isQuizmaster(n.page)&&n.owner!==n.page.user.uid||-1!=e||(m='\n      <div class="checkbox-holder">\n        <div class="checkbox">\n          <input type="checkbox" id="chkSticky" '.concat(u,'/>\n          <label for="chkSticky"></label>\n        </div>\n        <div class="checkbox-text">Sticky</div>\n      </div>')),n.replyTo=e,n.editComment=t;var f='\n      <div class="blurb">'.concat(l,'</div>\n      <textarea class="form-control txt-comment auto-focus">').concat(c,'</textarea>\n      <div><span class="char-remaining">1000</span> ').concat(a.a.translate("characters remaining"),"</div>\n      ").concat(g,"\n      ").concat(m),v='<button id="submit-comment" class="blue">'.concat(a.a.translate("Submit Comment"),"</button>");o.a.alert(s,f,null,{customFooter:v,customClass:"comments-modal"})}}else n.page.showAskCreate()},this.clickReply=function(e){var t=n.getCommentId(e);if($("#comment"+t).hasClass("d2")){var a,o="comment"+t,r=null,i=s($("#comments-container .comment"));try{for(i.s();!(a=i.n()).done;){var l=a.value;if($(l).hasClass("d1"))r=l;else if(l.id==o&&null!==r)return t=parseInt(r.id.replace("comment","")),void n.openCommentsModal(t)}}catch(e){i.e(e)}finally{i.f()}}n.openCommentsModal(t)},this.clickEdit=function(e){var t=n.getCommentId(e),a=$("#comment"+t).hasClass("d1")||$("#comment"+t).hasClass("d2")?-2:-1;n.openCommentsModal(a,t)},this.drawCharRemaining=function(){n.text=$(".txt-comment").val(),n.text.length>1e3&&(n.text=n.text.substring(0,1e3),$(".txt-comment").val(n.text)),$(".char-remaining").html(1e3-n.text.length)},this.submitComment=function(){if(""!=n.text){var e=$("#chkForQuizmaster").prop("checked")?1:0,t=$("#chkSticky").prop("checked")?1:0;r.a.go({url:"/api/post-comment.php",data:{text:n.text,quiz:n.quizId,reply:n.replyTo,pageUrl:n.pageUrl,forQuizmaster:e,sticky:t,editComment:n.editComment,owner:n.owner,language:n.page.language},loading:"Posting comment",callback:function(e){if(n.text="",o.a.close(),e.allowed){var t=$(".comments-outer").parent();$(".comments-outer").remove(),$(t).append(e.html)}$(".comments").show(),$(".txt-comment").val(""),n.init(),e.allowed||o.a.alert("Comment submitted","It will appear pending moderation")}})}else o.a.alert("Error","Please enter a comment")},this.openDeleteModal=function(e){var t=n.getCommentId(e),r=a.a.translate("Are you sure you want to delete this comment?"),i='<button data-id="'.concat(t,'" id="submit-comment-delete" class="red">').concat(a.a.translate("Delete"),"</button>");o.a.alert("Delete Comment",r,null,{customFooter:i})},this.deleteComment=function(e){var t=$(e.target).data("id");r.a.go({url:"/api/delete-comment.php",data:{id:t},loading:"Deleting comment",callback:function(e){o.a.close(),$(".comments-outer").html(e),$(".comments").show(),n.init()}})},this.submitReport=function(){r.a.go({url:"/api/report-comment.php",data:{id:n.reportedId},loading:"Reporting comment",callback:function(e){o.a.close(),o.a.alert("Thank you","Your report has been submitted")}})},this.submitBlock=function(){r.a.go({url:"/api/block-user.php",data:{id:n.blockedId},loading:"Blocking user",callback:function(e){o.a.close(),o.a.alert("User Blocked","<p>This user has been blocked.</p><p>It may take up to 24 hours for this change to fully take effect.</p>"),$(".comments-outer").html(e),$(".comments").show(),n.init()}})},this.clickHeart=function(e){var t=n.page.user;if(null!=t){var a=n.getCommentId(e);if($("#comment"+a).find(".sn").text()!=t.screenname){var l=parseInt($("#comment"+a).find(".pts").html().replace("+",""));if(a in t.commentLikes)$("#comment"+a).find(".fa-heart").removeClass("fa").addClass("far"),delete t.commentLikes[a],l-=1;else{var c,u=-1,d=s(i.a.getPointsLanguages());try{for(d.s();!(c=d.n()).done;){var h=c.value,p=t.pointsObj[h].level;p>u&&(u=p)}}catch(e){d.e(e)}finally{d.f()}if(u<5)return void o.a.alert("Sorry","<p>You must reach Level 5 to like comments.</p><p>Take a few more quizzes!</p>");$("#comment"+a).find(".fa-heart").removeClass("far").addClass("fa"),t.commentLikes[a]=1,l+=1}$("#comment"+a).find(".pts").html("+"+l),r.a.go({url:"/api/like-comment.php",data:{comment:a},loading:"DONOTLOAD",success:function(e){},errCallback:function(e){$("#comment"+a).find(".pts").html("+"+(l-1)),$("#comment"+a).find(".fa-heart").removeClass("fa").addClass("far"),o.a.alert("Error",e,(function(){return location.reload()}))}})}else o.a.alert("Can't Unlike","Don't like your own comment? Maybe you should delete it.")}else n.page.showAskCreate()},this.loadAll=function(){r.a.go({url:"/api/load-all-comments.php",data:{quiz:n.quizId,pageUrl:n.pageUrl},loading:"Loading all comments",callback:function(e){$(".comments-outer").html(e),$(".comments").show(),n.init()}})},this.page=t,this.quiz=t.data.quiz||null,this.pageUrl=location.pathname.toLowerCase().replace(/\/$/,""),this.quizId=-1,this.quiz?(this.owner=this.quiz.user,this.quizId=this.quiz.id,this.showQm=1==this.quiz.searchlevel):this.page.data.blogOwner?(this.owner=this.page.data.blogOwner,this.showQm=1==this.owner):this.page.data.group?(this.owner=this.page.data.group.owner,this.showQm=!1):(this.owner=176412,this.showQm=!0),this.text="",this.init(),$("body").on("click",".add-comment",(function(){return n.openCommentsModal()})),$("body").on("input",".txt-comment",this.drawCharRemaining),$("body").on("click","#submit-comment",this.submitComment),$("body").on("click","#submit-comment-report",this.submitReport),$("body").on("click","#submit-comment-block",this.submitBlock),$("body").on("click","#submit-comment-delete",this.deleteComment),$("body").on("click",".comments-outer .show-comments",(function(){return $(".comments").toggle()})),$("body").on("click",".comments-outer .reply",this.clickReply),$("body").on("click",".comments-outer .edit",this.clickEdit),$("body").on("click",".comments-outer .del",this.openDeleteModal),$("body").on("click",".comments-outer .report",this.openReportModal),$("body").on("click",".comments-outer .block",this.openBlockModal),$("body").on("click",".comments-outer .comment .th",this.clickHeart),$("body").on("click",".comments-outer .load-all-comments",this.loadAll)}var t,n,l;return t=e,(n=[{key:"getMinuteDifference",value:function(e){var t=(new Date).getTime(),n=1e3*parseInt($(e).data("utc"));return Math.floor((t-n)/6e4)}},{key:"init",value:function(){var e=this.page.user;null==e&&(e={screenname:"",uid:-1,commentLikes:[]});var t,n=s(Object.assign([],$(".comments .comment")));try{for(n.s();!(t=n.n()).done;){var o=t.value,r=this.getMinuteDifference(o),l=[],c=$(o).find(".sn").text(),u=i.a.isQuizmaster(this.page)?1e9:60;(c==e.screenname||i.a.isQuizmaster(this.page)||-1==this.quizId&&this.owner==e.uid)&&l.push('<span class="del">'+a.a.translate("delete")+"</span>"),c!=e.screenname&&l.push('<span class="report">'+a.a.translate("report")+"</span>"),c!=e.screenname&&this.owner==e.uid&&l.push('<span class="block">'+a.a.translate("block")+"</span>"),c==e.screenname&&r<u&&l.push('<span class="edit">'+a.a.translate("edit")+"</span>"),$(o).hasClass("d2")&&$("#"+o.id+"+.d2").length>0||$(o).hasClass("sticky")||l.push('<span class="reply">'+a.a.translate("reply")+"</span>");var d=parseInt(o.id.replace("comment",""))in e.commentLikes||c==e.screenname?"fa":"far";$(o).find(".th").html('<i class="'.concat(d,' fa-heart"></i>')),$(o).find(".bottom-line").html(l.join(""))}}catch(e){n.e(e)}finally{n.f()}}},{key:"getCommentId",value:function(e){var t=$(e.target).closest(".comment")[0].id;return t=parseInt(t.replace("comment",""))}}])&&c(t.prototype,n),l&&c(t,l),e}();function d(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var g=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.launchLogin=function(){$(".modal").hide(),$("#overlay-mask-new").show(),$("#login-modal").length?$("#login-modal").show():$("#overlay-new").append(n.drawLogin())},this.login=function(){var e=$("#login-modal .txt-email").val().replace(/[ ]/g,""),t=$("#login-modal .txt-password").val().trim();r.a.go({url:"/api/login.php",data:{username:e,password:t,quiz:n.page.data.quizId,creator:n.page.data.subscribeUser,pageurl:window.location.pathname},loading:"Logging In",callback:function(e){n.page.setUser(e),n.close(),o.a.close(),o.a.alert("".concat(a.a.translate("Welcome")," ").concat(e.screenname),"".concat(a.a.translate("You are now logged in.")))},errCallback:function(e){o.a.alert("Error Logging In",e,n.launchLogin)}})},this.launchCreate=function(){$(".modal").hide(),$("#overlay-mask-new").show(),$("#create-account").length?$("#create-account").show():$("#overlay-new").append(n.drawCreate())},this.drawCreate=function(){var e=Object.assign([],i.a.getTranslatedAndEnglishObjects());e.sort((function(e,t){return e.native.localeCompare(t.native)}));var t,o=[],r=d(e);try{for(r.s();!(t=r.n()).done;){var s=t.value,l=s.name==n.page.language?"selected":"",c=i.a.capFirstLetter(s.native);o.push("<option ".concat(l,' value="').concat(s.name,'">').concat(c,"</option>"))}}catch(e){r.e(e)}finally{r.f()}o=o.join("");var u="";return"english"==n.page.language&&(u='\n      <div class="row">\n        <div class="checkbox-row">\n          <div class="checkbox">\n            <input type="checkbox" id="chk-quiz-mail" />\n            <label for="chk-quiz-mail"></label>\n          </div>\n          <div>Weekly e-mails about new quizzes?</div>\n        </div>\n      </div>'),'\n      <div id="create-account" class="modal login-modal modal-350">\n        <div class="modal-content">\n          <div class="modal-header">\n            <div class="modal-title">'.concat(a.a.translate("Create Account"),'</div>\n            <div class="close close-x" aria-label="Close">\n              <span aria-hidden="true">×</span>\n            </div>\n          </div>\n          <div class="modal-body">\n            <div class="row">\n              <label>').concat(a.a.translate("Email Address"),':</label>\n              <input type="text" class="email full auto-focus" name="email">\n              <div class="create-error email-error"></div>\n            </div>\n            <div class="row">\n              <label>').concat(a.a.translate("Screen Name"),':</label>\n              <input type="text" class="screenname full" name="screenname">\n              <div class="create-error screenname-error"></div>\n            </div>\n            <div class="row">\n              <div class="password-row">\n                <div>\n                  <label>').concat(a.a.translate("Password"),':</label>\n                  <input type="password" class="password full" name="password">\n                </div>\n                <div>\n                  <label>').concat(a.a.translate("Confirm Password"),':</label>\n                  <input type="password" class="confirm full" name="confirm">\n                </div>\n              </div>\n              <div class="create-error password-error"></div>\n            </div>\n            <div class="row">\n              <label>').concat(a.a.translate("Language"),':</label>\n              <select class="lang full">').concat(o,"</select>\n            </div>\n            ").concat(u,'\n            <div class="row commit-button-row">\n              <button class="blue full btn-create">').concat(a.a.translate("Create Account"),'</button>\n            </div>\n            <div class="row two-button-row">\n              <button class="login-link">').concat(a.a.translate("Login"),'</button>\n              <button class="forgot-password-link">').concat(a.a.translate("Forgot Password"),"</button>\n            </div>\n          </div>\n        </div>\n      </div>")},this.getEmailError=function(e){if(0===e.length)return"E-mail can't be blank";if(e.length>64)return"E-mail can't be longer than 64 characters";return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)?null:"Invalid e-mail address"},this.getUsernameError=function(e){return 0===e.length?"Screen name can't be blank":e.length>16?"Screen name can't be longer than 16 characters":e.match(/[^a-zA-Z0-9]/)?"Screen name may only contain letters and numbers":null},this.getPasswordError=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.trim()!=e?"Password can't start or end with a space":e.length<5?"Password must be at least 5 characters in length":(t.length>0||n)&&e!=t?"Your passwords don't match":null},this.typeCreate=function(e){var t=e.target.name;if("email"!=t)if("screenname"!=t){if("password"==t||"confirm"==t){var a=$("#create-account .password").val(),o=$("#create-account .confirm").val();n.drawCreateError(".password-error",n.getPasswordError(a,o,!1))}}else{var r=$("#create-account .screenname").val();n.drawCreateError(".screenname-error",n.getUsernameError(r))}else{var i=$("#create-account .email").val();n.drawCreateError(".email-error",n.getEmailError(i))}},this.createAccount=function(){var e=$("#create-account .email").val(),t=$("#create-account .screenname").val(),i=$("#create-account .password").val(),s=$("#create-account .confirm").val(),l=$("#create-account .lang").val(),c=$("#chk-quiz-mail").prop("checked")?1:0,u=n.getEmailError(e),d=n.getUsernameError(t),h=n.getPasswordError(i,s);n.drawCreateError(".email-error",u),n.drawCreateError(".screenname-error",d),n.drawCreateError(".password-error",h),null===u&&null===d&&null===h?r.a.go({url:"/api/create-user.php",data:{email:e,username:t,password:i,quizmail:c,language:l,quizId:n.page.data.quizId},loading:"Creating account",callback:function(e){n.page.setUser(e),n.close(),o.a.close(),o.a.alert(a.a.translate("Welcome")+" "+e.screenname,a.a.translate("Your account has been created."))},errCallback:function(e){o.a.alert("Error",e,n.launchCreate)}}):o.a.alert("Error","Please fix the errors marked in red",n.launchCreate)},this.launchForgot=function(){$(".modal").hide(),$("#overlay-mask-new").show(),$("#forgot-modal").length?$("#forgot-modal").show():$("#overlay-new").append(n.drawForgot())},this.sendForgot=function(){var e=$("#forgot-modal .email").val().trim();""!=e?r.a.go({url:"/api/send-forgot-password.php",data:{email:e},type:"POST",loading:"Sending e-mail...",callback:function(e){n.close(),o.a.alert("E-mail sent","We sent you an e-mail with a link to reset your password")},errCallback:function(e){o.a.alert("Error",e,n.launchForgot)}}):o.a.alert("Error","Please enter the e-mail address associated with your account",n.launchForgot)},this.page=t,$("body").on("click",".login-link",this.launchLogin),$("body").on("click","#login-modal .login-button",this.login),$("body").on("keydown","#login-modal .txt-password",(function(e){13==e.which&&n.login()})),$("body").on("click",".login-modal .close",this.close),$("body").on("click",".create-account-link",this.launchCreate),$("body").on("click","#create-account .btn-create",this.createAccount),$("body").on("input","#create-account input",this.typeCreate),$("body").on("click",".forgot-password-link",this.launchForgot),$("body").on("click","#forgot-modal .send-forgot",this.sendForgot)}var t,n,s;return t=e,(n=[{key:"close",value:function(){$(".login-modal").hide(),o.a.draw()}},{key:"drawLogin",value:function(){return'\n    <div id="login-modal" class="modal login-modal modal-300">\n      <div class="modal-content">\n        <div class="modal-header">\n          <div class="modal-title">'.concat(a.a.translate("Login to Your Account"),'</div>\n          <div class="close close-x" aria-label="Close">\n            <span aria-hidden="true">×</span>\n          </div>\n        </div>\n        <div class="modal-body">\n          <div class="row">\n            <label>').concat(a.a.translate("Screen name or Email"),':</label>\n            <input type="text" class="txt-email full auto-focus">\n          </div>\n          <div class="row">\n            <label>').concat(a.a.translate("Password"),':</label>\n            <input type="password" class="txt-password full">\n          </div>\n          <div class="row commit-button-row">\n            <button class="blue full login-button">Login</button>\n          </div>\n          <div class="row two-button-row">\n            <button class="create-account-link">').concat(a.a.translate("Create Account"),'</button>\n            <button class="forgot-password-link">').concat(a.a.translate("Forgot Password"),"</button>\n          </div>\n        </div>\n      </div>\n    </div>")}},{key:"drawCreateError",value:function(e,t){$("#create-account "+e).text(a.a.translate(t)).toggle(null!=t)}},{key:"drawForgot",value:function(){return'\n    <div id="forgot-modal" class="modal login-modal modal-300">\n      <div class="modal-content">\n        <div class="modal-header">\n          <div class="modal-title">'.concat(a.a.translate("Forgot Password"),'</div>\n          <div class="close close-x" aria-label="Close">\n            <span aria-hidden="true">×</span>\n          </div>\n        </div>\n        <div class="modal-body">\n          <div class="row">\n            ').concat(a.a.translate("We will send you an e-mail with a link to reset your password."),'\n          </div>\n          <div class="row">\n            <label>').concat(a.a.translate("Email Address"),':</label>\n            <input type="text" class="email full auto-focus">\n          </div>\n          <div class="row commit-button-row">\n            <button class="blue full send-forgot">').concat(a.a.translate("Send E-mail"),'</button>\n          </div>\n          <div class="row two-button-row">\n            <button class="login-link">').concat(a.a.translate("Login"),'</button>\n            <button class="create-account-link">').concat(a.a.translate("Create Account"),"</button>\n          </div>\n        </div>\n      </div>\n    </div>")}}])&&p(t.prototype,n),s&&p(t,s),e}();var m=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.openMobUserOptions=function(){var e=n.page.user,t=e.notifications,r=e.friendNotifications,s=e.screenname,l=e.url,c=e.numquizzes,u=e.uid,d=e.numblogs,h=i.a.isPointsLanguage(n.page.language)?n.page.language:"english",p=n.page.user.pointsObj[h].level,g=i.a.getLangProp(n.page.language,"code"),m="en"==g?"/user-stats":"/"+g+"/user-stats",f=n.page.data.liveLink,v=n.page.data.quiz,b=!1;["map-game","photo-game","text-game","mc-game","tile-game"].includes(n.page.pageType)&&(v.user==u||i.a.isQuizmaster(n.page))&&(b=!0);var y=!1;i.a.isQuizmaster(n.page)&&(b||f)&&(y=!0);var w=0==t?"":"(".concat(t,")"),k=0==t?"":'<i class="fa fa-bell"></i>',I=0==r?"":"(".concat(r,")"),S=0==r?"":'<i class="fa fa-bell"></i>',T='\n      <div class="item"><a href="/create-quiz">'.concat(a.a.translate("Create / Edit Quiz"),'</a></div>\n      <div class="item"><a href="/user-notifications">').concat(k," ").concat(a.a.translate("New Comments")," ").concat(w,'</a></div>\n      <div class="item"><a href="/friends">').concat(S," ").concat(a.a.translate("Friends and Groups")," ").concat(I,"</a></div>\n    ");c>0&&(T+='\n        <div class="item"><a href="/user-quizzes/'.concat(u,'">').concat(a.a.translate("Your Live Quizzes"),'</a></div>\n        <div class="item"><a href="/user-analytics">').concat(a.a.translate("Your Quiz Analytics"),"</a></div>\n      "));var E="";b&&(E='\n        <div class="item"><a href="/create-quiz/'.concat(v.id,'">').concat(a.a.translate("Edit This Quiz"),'</a></div>\n        <div class="item"><a href="/user-analytics?quiz=').concat(v.id,'">').concat(a.a.translate("Analyze This Quiz"),"</a></div>\n      ")),y&&(E+='<div class="item"><a href="/admin/update-quiz.php?id='.concat(v.id,'">Update This Quiz</a></div>')),f&&(E+='\n        <div class="item"><a href="'.concat(f,'">').concat(a.a.translate("Live Version of This Quiz"),"</a></div>\n      ")),null!=n.page.data.blogId&&null!=n.page.data.blogOwner&&(n.page.data.blogOwner==u||i.a.isQuizmaster(n.page))&&(E+='<div class="item"><a href="/create-blog/'.concat(n.page.data.blogId,'">').concat(a.a.translate("Edit This Blog"),"</a></div>")),""!=E&&(E+='<div class="spacer"></div>');var x=0==d?"":'<div class="item"><a href="/users/'.concat(l,'/blog">').concat(a.a.translate("Your Blog"),"</a></div>"),$='\n      <div class="item"><a href="/your-account">'.concat(a.a.translate("Your Account"),'</a></div>\n      <div class="item"><a href="').concat(m,'">').concat(a.a.translate("Your Stats"),'</a></div>\n      <div class="item"><a href="/users/').concat(l,'">').concat(a.a.translate("Your Public Profile"),'</a></div>\n      <div class="item"><a href="/your-favorite-quizzes">').concat(a.a.translate("Your Favorite Quizzes"),'</a></div>\n      <div class="item"><a href="/user-subscriptions">').concat(a.a.translate("Your Subscriptions"),'</a></div>\n      <div class="spacer"></div>\n      <div class="item"><a href="/create-blog">').concat(a.a.translate("Create / Edit Blog"),'</a></div>\n      <div class="item"><a href="/blog-feed">').concat(a.a.translate("Your Blog Feed"),"</a></div>\n      ").concat(x,'\n      <div class="spacer"></div>\n      ').concat(T,'\n      <div class="spacer"></div>\n      ').concat(E,'\n      <div class="item"><a class="logout-link link-like">').concat(a.a.translate("Logout"),'</a></div>\n      <div class="badge-item item">\n        <div class="badge-left">').concat(a.a.translate("Your Level"),':</div>\n        <div class="badge-right">\n          <div class="badge"><img src="/img/large-badge.svg" height="50"></div>\n          <div class="level"><a href="').concat(m,'">').concat(p,"</a></div>\n        </div>\n      </div\n    ");o.a.alert(s,$,null,{customClass:"mob-links-modal",hideFooter:!0})},this.openMobNav=function(){var e=n.page.language,t="",r="",s="";"english"==n.page.language&&(t='\n        <div class="item"><a href="/tags/highest-rated">Highest-Rated Quizzes</a></div>\n        <div class="item"><a href="/nominated-quizzes">Nominated Quizzes</a></div>\n        <div class="item"><a href="/tags/index">Quizzes by Tag</a></div>\n      ',r='\n        <div class="item"><a href="/blog">JetPunk Blog</a></div>\n        <div class="item"><a href="/blog-tags">Blogs by Tag</a></div>\n        <div class="spacer"></div>\n        <div class="item"><a href="/badges">JetPunk Badges</a></div>\n      ',s='\n        <div class="item"><a href="/charts">Charts</a></div>\n        <div class="item"><a href="/info">Info Pages</a></div>\n        <div class="item"><a href="/interesting-facts">Interesting Facts</a></div>\n        <div class="item"><a href="/interesting-quotes">Interesting Quotes</a></div>\n        <div class="spacer"></div>\n      '),"french"==n.page.language&&(t='\n        <div class="item"><a href="https://www.jetpunk.com/fr/tags/tous">Quiz par tag</a></div>\n      ');var l="/new-and-reset-quizzes",c="/tags/all",u="/user-quizzes",d="/tags/recent-user",h="";if("english"!=(e=i.a.isPointsLanguage(n.page.language)?n.page.language:"english")){var p=i.a.getLangProp(e,"code");l="/"+p+"/new-and-reset-quizzes",c="/"+p+"/"+i.a.getLangProp(e,"all"),u="/"+p+"/all",d="/"+p+"/"+i.a.getLangProp(e,"recent"),h="/"+p}var g='\n      <div class="item"><a href="'.concat(c,'">').concat(a.a.translate("All Featured Quizzes"),'</a></div>\n      <div class="item"><a href="/quizzes/random?language=').concat(e,'">').concat(a.a.translate("Random"),'</a></div>\n      <div class="item"><a href="').concat(l,'">').concat(a.a.translate("New and Reset Quizzes"),'</a></div>\n      <div class="spacer"></div>\n      <div class="item"><a href="/create-quiz">').concat(a.a.translate("Create / Edit Quiz"),'</a></div>\n      <div class="spacer"></div>\n      <div class="item"><a href="').concat(d,'">').concat(a.a.translate("Recent User-Created"),'</a></div>\n      <div class="item"><a href="').concat(u,'">').concat(a.a.translate("All User-Created"),"</a></div>\n      ").concat(t,'\n      <div class="spacer"></div>\n      <div class="item"><a href="').concat(h,'/user-blogs">').concat(a.a.translate("User Blogs"),'</a></div>\n      <div class="item"><a href="').concat(h,'/recent-blogs">').concat(a.a.translate("Recent User Blogs"),"</a></div>\n      ").concat(r,'\n      <div class="item"><a href="/minigames">').concat(a.a.translate("JetPunk Minigames"),'</a></div>\n      <div class="spacer"></div>\n      ').concat(s,'\n      <div class="item"><a href="/about">').concat(a.a.translate("About Us"),'</a></div>\n      <div class="item"><a href="/contact">').concat(a.a.translate("Contact Us"),'</a></div>\n      <div class="item"><a href="/jetpunk-premium">').concat(a.a.translate("JetPunk Premium"),'</a></div>\n      <div class="item"><a href="/svg-guide">').concat(a.a.translate("JetPunk SVG Guide"),"</a></div>\n    ");o.a.alert(a.a.translate("Navigation"),g,null,{customClass:"mob-links-modal",hideFooter:!0})},this.page=t,$("#mob-nav").on("click",this.openMobNav),$("#mob-user-button").on("click",this.openMobUserOptions)},f=n(6);function v(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var w=n(12),k=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyDown=function(e){switch(e.which){case 9:e.shiftKey?n.moveCursor(-1):n.moveCursor(1);break;case 13:n.select();break;case 27:f.a.close();break;case 38:n.moveCursor(-1);break;case 40:n.moveCursor(1);break;default:return}e.preventDefault()},this.changeSearchLang=function(){var e,t=$("#sel-search-lang").val();e="all"==t?"*":i.a.getLangProp(t,"code"),$(".search-language").html(e),n.searchLanguage=t,$(".search-box").val("").focus(),"desktop"==n.page.device?o.a.close():$("#mob-search-results").hide()},this.openChooseLang=function(){var e=n.getSearchLangSelector();o.a.alert("Choose Search Language",e,null,{hideFooter:!0,customClass:"choose-search-lang"})},this.typeSearch=function(e){n.searchText=e.target.value;var t=n.getSearchTerm(n.searchText);t!=n.term&&(n.term=t,""==t?("desktop"==n.page.device&&f.a.close(),n.setLoading(!1)):(n.setLoading(!0),n.search(t))),""==t||n.loading||n.processResults()},this.search=function(e){$.ajax({type:"POST",url:"/api/search.php",data:{term:e,language:n.searchLanguage},success:function(t){var a;try{a=JSON.parse(t)}catch(e){return}e==n.term&&(n.setLoading(!1),n.results=a,n.processResults())}})},this.clickMobSearch=function(){var e=n.getSearchLangSelector(),t='\n      <div class="top-line">\n        <div class="search-holder">\n          <input type="text" class="search-box" placeholder="'.concat(a.a.translate("Search"),'">\n          <div class="search-loading"><i class="fa fa-circle-notch fa-spin"></i></div>\n        </div>\n        <div class="select-holder">\n          ').concat(e,'\n        </div>\n      </div>\n      <div id="mob-search-results"></div>\n    ');o.a.alert("Search",t,null,{hideFooter:!0,customClass:"mob-search-modal"})},this.page=t,this.searchText="",this.loading=!1,this.results=null,this.selectedIdx=-1,this.term="",this.dropdownItems=[],this.searchLanguage=i.a.isPointsLanguage(this.page.language)?this.page.language:"all",$("body").on("input",".search-box",this.typeSearch),$("body").on("click",".search-box",this.typeSearch),$("#mob-search").on("click",this.clickMobSearch),$(".search-language").on("click",this.openChooseLang),$("body").on("change","#sel-search-lang",this.changeSearchLang)}var t,n,r;return t=e,(n=[{key:"select",value:function(){if(-1!=this.selectedIdx){var e=$("#search-row-".concat(this.selectedIdx)).data("url");window.location=e}}},{key:"moveCursor",value:function(e){$(".search-row").removeClass("selected");for(var t=this.selectedIdx,n=0;n<this.dropdownItems.length;n++)if((t+=e)>=this.dropdownItems.length&&(t=0),t<0&&(t=this.dropdownItems.length-1),this.dropdownItems[t].canSelect)return $("#search-row-"+t).addClass("selected"),void(this.selectedIdx=t)}},{key:"getSearchLangSelector",value:function(){var e=i.a.getPointsLanguageObjects();e.sort((function(e,t){return e.native>t.native?1:-1})),e.unshift({name:"all",native:"all"});var t,n=[],a=v(e);try{for(a.s();!(t=a.n()).done;){var o=t.value,r=o.name==this.searchLanguage?"selected":"";n.push("<option ".concat(r,' value="').concat(o.name,'">').concat(i.a.capFirstLetter(o.native),"</option>"))}}catch(e){a.e(e)}finally{a.f()}return'\n      <select id="sel-search-lang">\n        '.concat(n.join(""),"\n      </select>")}},{key:"setLoading",value:function(e){this.loading=e,$(".search-loading").toggle(e)}},{key:"getSearchTerm",value:function(e){"french"==this.searchLanguage&&(e=e.replace("'"," "));var t=(e=i.a.normalizeWords(e)).indexOf(" ");return 1==t?e[0]:2==t?e.substring(0,2):e.length>=3?e.substring(0,3):""}},{key:"getSearchWords",value:function(e){return"french"==this.searchLanguage&&(e=e.replace("'"," ")),(e=i.a.normalizeWords(e)).split(" ")}},{key:"addDropdownItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.dropdownItems.length,r='<div data-url="'.concat(t,'" id="search-row-').concat(o,'" class="search-row ').concat(n,'">').concat(e,"</div>");""!=t&&(r='<a href="'.concat(t,'">').concat(r,"</a>")),this.dropdownItems.push({html:r,canSelect:a})}},{key:"processResults",value:function(){this.dropdownItems=[];var e=[],t=this.getSearchWords(this.searchText);t=this.processIgnoredWords(t);for(var n=0;n<this.results.quizzes.length;n++){var o=this.results.quizzes[n];this.wordsMatch(t,this.getSearchWords(o.t))&&e.push(o)}for(this.addDropdownItem(a.a.translate("Quizzes"),"","search-result-header"),n=0;n<e.length&&n<12;n++){var r=(o=e[n]).t;1==o.sl&&(r='<i class="fa fa-star"></i> '.concat(r)),this.addDropdownItem(r,i.a.getQuizUrl(o.u,o.f),"",!0)}0==e.length&&this.addDropdownItem(a.a.translate("None found")),e.length>12&&this.addDropdownItem(a.a.translate("More results ..."),"/search?term="+encodeURIComponent(this.searchText)+"&language="+this.searchLanguage,"",!0),this.addDropdownItem(a.a.translate("Search with Google ..."),"https://cse.google.com/cse?cx=013202234982266782837:zgxwxio0ici&ie=UTF-8&q="+encodeURIComponent(this.searchText)+"&sa=Search","",!0);var s=[];for(n=0;n<this.results.users.length;n++){var l=this.results.users[n];1==t.length&&0==i.a.normalizeString(l.screenname).indexOf(t[0])&&s.push(l)}if(s.length>0)for(this.addDropdownItem(a.a.translate("Users"),"","search-result-header"),n=0;n<s.length&&n<3;n++){l=s[n];var c=parseInt(l.timestaken).toLocaleString();r="\n          <div>".concat(l.screenname,"</div>\n          <div>").concat(c,"</div>"),this.addDropdownItem(r,"/user-quizzes/".concat(l.uid),"user-row",!0)}var u=[];for(n=0;n<this.results.tags.length;n++){var d=this.results.tags[n];this.wordsMatch(t,this.getSearchWords(d.dirname))&&u.push(d)}if(u.length>0)for(this.addDropdownItem("Tags","","search-result-header"),n=0;n<u.length&&n<5;n++){d=u[n];var h="french"==this.searchLanguage?"/fr":"";this.addDropdownItem(d.dirname,"".concat(h,"/tags/").concat(d.urlname),"",!0)}if(this.drawDropdown(),"desktop"==this.page.device&&!f.a.openId){var p=$(".search-holder").position().left-$(".brand").position().left+25;f.a.open("search-dropdown",p,this.onClose),$(document).on("keydown",this.keyDown),this.selectedIdx=-1}}},{key:"drawDropdown",value:function(){var e=this.dropdownItems.map((function(e){return e.html}));"desktop"==this.page.device?$("#search-dropdown .search-content").html(e.join("")):$("#mob-search-results").html(e.join("")).show()}},{key:"onClose",value:function(){$(document).off("keydown",this.keyDown)}},{key:"processIgnoredWords",value:function(e){var t,n=[],a=["THE","OF","AND","QUIZ"],o=v(e);try{for(o.s();!(t=o.n()).done;){var r=t.value;a.indexOf(r)<0&&n.push(r)}}catch(e){o.e(e)}finally{o.f()}return 0==n.length&&n.push(e[0]),n}},{key:"wordsMatch",value:function(e,t){t=Object.assign([],t);for(var n=0;n<e.length;n++){for(var a=e[n],o=!1,r=0;r<t.length;r++){var i=t[r],s="";if(i in w&&(s=w[i]),0==i.indexOf(a)||0==s.indexOf(a)){o=!0,t.splice(r,1);break}}if(!o)return!1}return!0}},{key:"drawOneMobResult",value:function(e){var t=e.className||"",n=e.text;return e.rightText&&(n+=' <span class="right-text">'.concat(e.rightText,"</span>")),e.url?'<a href="'.concat(e.url,'"><div class="').concat(t,'">').concat(n,"</div></a>"):'<div class="'.concat(t,'">').concat(n,"</div>")}},{key:"drawMobSearchResults",value:function(e){var t=e.map(this.drawOneMobResult);$("#mob-search-results").html(t.join("")).show()}}])&&y(t.prototype,n),r&&y(t,r),e}(),I=n(8);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,o=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==s.return||s.return()}finally{if(o)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var x=n(13),C=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.revealImageSource=function(e){var t=$(e.target).data("source");$(e.target).closest(".photo-modal").find(".attribution").html('<a href="'.concat(t,'" target="_blank">')+a.a.translate("Image Source")+"</a>")},this.preventBackspace=function(e){if(8===e.keyCode){var t=e.srcElement||e.target,n=!1;"INPUT"===t.tagName.toUpperCase()&&["TEXT","PASSWORD","FILE","SEARCH","EMAIL","NUMBER","DATE"].includes(t.type.toUpperCase())&&(n=!0),"TEXTAREA"==t.tagName.toUpperCase()&&(n=!0),"DIV"==t.tagName.toUpperCase()&&t.contentEditable&&(n=!0),n?(t.readOnly||t.disabled)&&e.preventDefault():e.preventDefault()}if(9===e.keyCode){var a=e.srcElement||e.target;if("TEXTAREA"==a.tagName.toUpperCase()&&!a.readOnly&&!a.disabled){var o=a.value,r=a.selectionStart;o=o.substr(0,a.selectionStart)+"\t"+o.substr(a.selectionEnd),$(a).val(o).prop("selectionStart",r+1).prop("selectionEnd",r+1),e.preventDefault()}}},this.drawUserDropdown=function(){var e=n.data.quiz;null==e&&null!=n.data.create&&(e=n.data.create.quiz);var t=n.data.liveLink,a=n.user,o=!1;"game"==n.pageGroup&&(e.user==a.uid||i.a.isQuizmaster(n)||i.a.isTrustedUser(n))&&(o=!0);var r=!1;i.a.isQuizmaster(n)&&(o||t)&&(r=!0);var s=i.a.getLangProp(n.language,"code"),l="en"==s?"/user-stats":"/"+s+"/user-stats",c=[n.drawUserItem("/your-account","Your Account"),n.drawUserItem(l,"Your Stats"),n.drawUserItem("/users/"+a.url,"Your Public Profile"),n.drawUserItem("/your-favorite-quizzes","Your Favorite Quizzes"),n.drawUserItem("/user-subscriptions","Your Subscriptions")],u=[n.drawUserItem("/create-blog","Create / Edit Blog"),n.drawUserItem("/blog-feed","Your Blog Feed")];a.numblogs>0&&u.push(n.drawUserItem("/users/"+a.url+"/blog","Your Blog"));var d=[n.drawUserItem("/create-quiz","Create / Edit Quiz")];a.numquizzes>0&&d.push(n.drawUserItem("/user-quizzes/"+a.uid,"Your Live Quizzes"),n.drawUserItem("/user-analytics","Your Quiz Analytics"));var h=[];o&&(h.push(n.drawUserItem("/create-quiz/"+e.id,"Edit This Quiz")),h.push(n.drawUserItem("/user-analytics?quiz="+e.id,"Analyze This Quiz"))),r&&h.push(n.drawUserItem("/admin/update-quiz.php?id="+e.id,"Update This Quiz")),t&&h.push(n.drawUserItem(t,"Live Version of this Quiz")),null!=n.data.blogId&&null!=n.data.blogOwner&&(n.data.blogOwner==a.uid||i.a.isQuizmaster(n))&&h.push(n.drawUserItem("/create-blog/"+n.data.blogId,"Edit This Blog"));var p=[n.drawUserItem(null,"Logout","logout-link")],g='\n      <div class="screenname">'.concat(a.screenname,"</div>\n      ").concat(n.drawUserSection(c),"\n      ").concat(n.drawUserSection(u),"\n      ").concat(n.drawUserSection(d),"\n      ").concat(n.drawUserSection(h),"\n      ").concat(n.drawUserSection(p));$("#user-dropdown .dropdown-content").html(g)},this.logoutEx=function(){$(".login-modal .txt-email").val(""),$(".login-modal .txt-password").val(""),r.a.go({url:"/api/logout.php",type:"GET",loading:"Logging Out",callback:function(){n.setUser(null),o.a.alert("Success","You are now logged out")}})},this.logout=function(){o.a.close(),n.create?n.create.state.logout():n.logoutEx()},this.changeHotLanguage=function(){var e=$("#sel-hot-language").val();$.ajax({type:"GET",url:"/api/get-hot-quizzes.php",data:{language:e},success:function(e){$("#hot-quizzes .body").html(e)}})},this.subscribe=function(){if(null!=n.user){var e="german"==n.language?"Möchten Sie ".concat(n.data.subscribeScreen," abonnieren?"):"".concat(a.a.translate("Would you like to subscribe to")," ").concat(n.data.subscribeScreen,"?"),t="\n      <p>".concat(e,'</p>\n      <p class="txt-sm"><a href="/manage-subscriptions#what-are-subs" target="_blank">').concat(a.a.translate("What are Subscriptions?"),"</a>\n    ");o.a.choice("Subscribe?",t,[a.a.translate("No"),a.a.translate("Yes")],[null,n.subscribeEx])}else n.showAskCreate()},this.subscribeEx=function(){r.a.go({url:"/api/subscribe-user.php",data:{user:n.data.subscribeUser,action:"subscribe",type:n.data.subscribeQorB},callback:function(){"german"==n.language?o.a.alert("Thank You","Sie haben "+n.data.subscribeScreen+" nun abonniert"):o.a.alert("Thank You",a.a.translate("You are now subscribed to")+" "+n.data.subscribeScreen),$(".page").removeClass("unsubscribed").addClass("subscribed")}})},this.unsubscribe=function(){var e="german"==n.language?"Abo von "+n.data.subscribeScreen+" beenden?":a.a.translate("Unsubscribe from")+" "+n.data.subscribeScreen+"?";o.a.choice("Unsubscribe?",e,["No","Yes"],[null,n.unsubscribeEx])},this.unsubscribeEx=function(){r.a.go({url:"/api/subscribe-user.php",data:{user:n.data.subscribeUser,action:"unsubscribe",type:n.data.subscribeQorB},callback:function(){o.a.alert("Success","You are now unsubscribed"),$(".page").removeClass("subscribed").addClass("unsubscribed")}})},this.stripQueryString(),this.isTablet=this.adjustForIpadOS(t.isTablet),this.language=t.language,this.user=t.user,this.pageType=t.pageType,this.pageGroup=t.pageGroup,this.reloadOnLogin=t.reloadOnLogin,this.device=t.device,this.data=t.data,this.country=t.country,this.create=null,this.login=new g(this),this.searchBox=new k(this),this.comments=new u(this),"phone"==this.device&&(this.mobileButtons=new m(this)),this.data.superTable&&new I.a(this,this.data.superTable),this.showHateAds(),this.detectAdBlock(),this.isTablet&&this.sortTabletViewport(),$("body").on("click",".logout-link",this.logout),$("#sel-hot-language").on("change",this.changeHotLanguage),$(".subscribe").on("click",this.subscribe),$(".unsubscribe").on("click",this.unsubscribe),$("html").on("keydown",this.preventBackspace),$("body").on("click",".reveal-image-source",this.revealImageSource),$(".page").on("click",".help-question-mark",this.getHelpQuestionMark),$("#show-most-popular").on("click",(function(){$(".other-languages").hide(),$(".browse-box").hide(),$(".most-popular-box").toggle()})),$("#show-other-languages").on("click",(function(){$(".most-popular-box").hide(),$(".browse-box").hide(),$(".other-languages").toggle(),$(".other-languages").is(":visible")&&$(".other-languages").css("display","flex")})),$("#show-browse-box").on("click",(function(){$(".most-popular-box").hide(),$(".other-languages").hide(),$(".browse-box").toggle()})),$(".close-spotlight").on("click",this.closeSpotlight),this.user&&this.drawUserDropdown()}var t,n,s;return t=e,(n=[{key:"closeSpotlight",value:function(){$.ajax({type:"GET",url:"/api/close-spotlight.php"}),$(".spotlight-notification").hide()}},{key:"adjustForIpadOS",value:function(e){return window.screen.height/window.screen.width==1024/768||window.screen.height/window.screen.width==1112/834||window.screen.height/window.screen.width==1366/1024||e}},{key:"getHelpQuestionMark",value:function(e){var t=$(e.target).closest(".link-like").prop("id"),n=x[t];if(n){var a=S(n,2),r=a[0],i=a[1];o.a.alert(r,i)}}},{key:"sortTabletViewport",value:function(){var e=document.documentElement.clientWidth,t=document.documentElement.scrollWidth;t>e&&document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale="+e/t)}},{key:"showImageAttribution",value:function(e,t){var n="";"pixa"==t.src?n=a.a.translate("Public domain image from Pixabay.com"):"wiki"==t.src?("File"==t.url.substr(0,4)&&(t.url="https://commons.wikimedia.org/wiki/"+t.url),n="<p>".concat(a.a.translate("Image from Wikimedia Commons."),'</p><p><span data-source="').concat(t.url,'" class="link-like reveal-image-source">').concat(a.a.translate("Click</span> to reveal authorship and copyright (may contain spoilers)"),"</span></p>")):n="phone"==e.device?a.a.translate("Custom image"):"";var r='\n      <div><img src="/img/user-photo-library/'.concat(t.fn.substr(0,2),"/").concat(t.fn,"-450.").concat(t.ext,'"/></div>\n      <div class="attribution">').concat(n,"</div>\n    ");o.a.alert("Photo Information",r,null,{customClass:"photo-modal"})}},{key:"stripQueryString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=window.location.href;if(e||-1!=t.indexOf("?switchDevice")||-1!=t.indexOf("/quizzes")||-1!=t.indexOf("/friends")||-1!=t.indexOf("/blog/")||-1!=t.indexOf("/user-quizzes")||-1!=t.indexOf("/user-stats")||-1!=t.indexOf("/minigames")){var n=t.replace(/\?.*/,"");t!=n&&history.replaceState(null,"",n)}}},{key:"showHateAds",value:function(){var e;this.user&&this.user.isPremium||(e=this.user?'<div>Hate Ads?</div><div><a href="/jetpunk-premium"><button class="red">Get JetPunk Premium</button></a></div>':"<div>"+a.a.translate("Save Your Progress")+'</div><button class="green create-account-link">'+a.a.translate("Create Account")+"</button>",$("#random-beg-box").html(e).addClass("show"))}},{key:"detectAdBlock",value:function(){var e=this;this.adblock=!1;var t=document.createElement("div");t.innerHTML="&nbsp;",t.className="adsbox",document.body.appendChild(t),window.setTimeout((function(){0===t.offsetHeight&&(e.adblock=!0),t.remove(),e.handleAdblock()}),100)}},{key:"handleAdblock",value:function(){if("-1"==location.href.indexOf("jetpunk-premium")&&this.adblock&&(!this.user||!this.user.isPremium)){var e=!1;if(null!==this.user&&this.user.numquizzes>0&&this.user.timestaken/this.user.numquizzes>1e3&&(e=!0),!e){var t={daily:[],total:0},n=localStorage.getItem("pageHistory");null!=n&&(t=JSON.parse(n));var a=Date.now(),o=a-864e5;t.daily=t.daily.filter((function(e){return e>o}));var r=!1,i=Math.max(100-t.total,20-t.daily.length);if(i<=0){var s='\n          <p>You have used all your AdBlock page views per 24 hour period. Please disable your AdBlocker for JetPunk or come back later.</p>\n          <p>Or, better yet, try <a href="/jetpunk-premium">JetPunk Premium.</p>';$(".adblock-user").html(s).show(),$(".hide-adblock .content").html(""),r=!0}else i<=5&&(s="\n          <p>It looks like you're using an AdBlocker.  Unfortunately, due to declining revenue, we are now limiting the daily page views for AdBlock users.<p>\n          <p>".concat(1==i?"This is your last AdBlock page view for today.":"You have "+i+" page views left today with AdBlock.",'</p>\n          <p>Don\'t want to see ads? Try <a href="/jetpunk-premium">JetPunk Premium.'),$(".adblock-user").html(s).show());t.total+=1,r||t.daily.push(a),localStorage.setItem("pageHistory",JSON.stringify(t))}}}},{key:"setUser",value:function(e){if(this.reloadOnLogin)location.reload();else{if(this.user=e,$(".page").removeClass("logged-in logged-out has-notifications has-friend-notifications subscribed unsubscribed nominated unnominated color-blind"),e){$(".page").addClass("logged-in"),e.notifications>0&&($(".page").addClass("has-notifications"),$(".num-bell").text(e.notifications>999?999:e.notifications)),e.friendNotifications>0&&($(".page").addClass("has-friend-notifications"),$(".num-friend").text(e.friendNotifications>999?999:e.friendNotifications)),1==e.colorblind&&$(".page").addClass("color-blind"),e.subscribedTo?$(".page").addClass("subscribed"):$(".page").addClass("unsubscribed"),e.quizNomination?$(".page").addClass("nominated"):$(".page").addClass("unnominated");var t=i.a.isPointsLanguage(this.language)?this.language:"english";$(".badge-level").text(e.pointsObj[t].level),$(".screenname").text(e.screenname),this.drawUserDropdown()}else $(".page").addClass("logged-out unsubscribed unnominated");this.comments.init(),this.rateQuiz&&this.rateQuiz.drawRating()}}},{key:"drawUserSection",value:function(e){return 0==e.length?"":'\n      <div class="section">\n        '.concat(e.join(""),"\n      </div>")}},{key:"drawUserItem",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t='<div class="item '.concat(n,'">').concat(a.a.translate(t),"</div>"),null!=e&&(t='<a href="'.concat(e,'">').concat(t,"</a>")),t}},{key:"showAskCreate",value:function(){var e="\n      <p>You must be logged in to use this feature</p>\n      <div class='two-button-row'>\n        <button class=\"blue close login-link\">".concat(a.a.translate("Login"),'</button>\n        <button class="green close create-account-link">').concat(a.a.translate("Create Account"),"</button>\n      </div>");o.a.alert(a.a.translate("Must be Logged In"),e,null,{hideFooter:!0,customClass:"ask-create-modal"})}},{key:"facebookLike",value:function(){var e=[location.protocol,"//",location.host,location.pathname].join("")+"?lx=fb";"phone"==this.device?(e="http://m.facebook.com/sharer.php?u="+encodeURIComponent(e),window.open(e,"facebook-share-dialog","width="+screen.width+",height="+screen.height)):(e="http://www.facebook.com/sharer.php?u="+encodeURIComponent(e),window.open(e,"facebook-share-dialog","width=626,height=436"))}}])&&E(t.prototype,n),s&&E(t,s),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(5),o=n(2);function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mapStart=[],this.mapMiddle=[],this.mapEnd=[],this.mapWholeLast=[],this.mapWholeNotLast=[];var t,n=r(c.split("\n"));try{for(n.s();!(t=n.n()).done;)for(var a=t.value.split(" "),o=a[0],i=a[a.length-1],s=1;s<a.length-1;s++){var l=a[s];"1"==o[2]&&(this.mapEnd[l]=i),"1"==o[3]&&(this.mapWholeLast[l]=i),"1"==o[4]&&(this.mapWholeNotLast[l]=i);var u=l.length;"1"==o[0]&&(this.mapStart[u]||(this.mapStart[u]=[]),this.mapStart[u][l]=i),"1"==o[1]&&(this.mapMiddle[u]||(this.mapMiddle[u]=[]),this.mapMiddle[u][l]=i)}}catch(e){n.e(e)}finally{n.f()}}var t,n,i;return t=e,(n=[{key:"getMiddleReplacement",value:function(e,t){var n,a=t?this.mapStart:this.mapMiddle,o=e.length-1;o>5&&(o=5);for(var r=o;r>=1;r--)if(a[r]){n=e.substr(0,r);var i=a[r][n]||null;if(null!==i)return{match:n,replacement:i}}return{match:n=e.substr(0,1),replacement:n}}},{key:"getSoundexWord",value:function(e,t){var n=t?this.mapWholeLast:this.mapWholeNotLast;if(n[e])return n[e];for(var a=[];""!=e;){if(this.mapEnd[e]&&a.length>0){a.push(this.mapEnd[e]);break}var o=this.getMiddleReplacement(e,0==a.length);a.push(o.replacement),e=e.substr(o.match.length)}return a.join("")}},{key:"create",value:function(e,t){e=o.a.getStrippedBracketedText(e);for(var n,r=a.a.normalizeWordsUnicode(e).split(" "),i=[],s=0;s<r.length;s++)i.push(this.getSoundexWord(r[s],s==r.length-1));if(r.length>1&&!t){"THE"==i[0]&&(i[0]="(THE)?"),"A"==i[0]&&(i[0]="(A)?"),"AN"==i[0]&&(i[0]="(AN)?");for(var l=1;l<r.length-1;l++)"AND"==i[l]&&(i[l]="(AND)?")}if(t)if(r.length>1){a.a.isNameSuffix(r[r.length-1])&&i.splice(-1),n=[];for(var c=0;c<i.length-1;c++)n.push("("+i[c]+")");n.push(i[i.length-1]),n=n.join("?")}else n=i[0];else n=i.join("");var u=n==a.a.normalizeUnicode(n)?"s":"r";return[{mode:u,val:"s"==u?n:"^"+n}]}}])&&s(t.prototype,n),i&&s(t,i),e}(),c="\n00011 QUEEN QUEEN\n00011 NIGHT NIGHT\n00001 SAINT ST STE SAINTE (SAINTE?|STE?)\n00001 PORT PT (PORT|PT)\n00001 FORT FT (FORT|FT)\n00001 DOCTOR (DOCT[EO]R|DR)\n00011 JOHN JON (JOHN|JON)\n00100 MENT MANT M[AE]NT\n00111 SHAUN SEAN SHAWN S[AEUWH]+N\n00100 IE EY Y (EE|EY|IE|Y)\n00100 IAN IEN I[AE]N\n00100 EE (EE|IE)\n00100 TION (SH|T)[AEIOU]+N\n00100 AA AH A[AH]\n11000 AA AH A[AH]?\n01100 AY EY [AE]Y\n00100 OUS EOUS [AEIOU]+[OU]S\n00100 EN IN [AEI]N\n00100 EAU ([EA]+U|OW|OUGH)\n01000 EAU [EAOU]+\n11000 CR KR CHR KHR [CK]H?R\n01000 BB B+\n01000 CK KK [CK]+\n01000 CC C+H?\n00100 K CK C?K\n11000 KA [CK]A\n01000 DD D+\n01000 DG D?G\n11000 EA EA?\n01000 EE E[AE]\n10000 EE EE\n01000 EU UE (U|EU|UE)\n01000 FF F+\n01000 II I+\n01000 LL L+\n01000 MM M+\n01000 NN N+\n01000 PP P+\n01000 RR R+\n01000 SS S+\n01000 TT T+\n01000 VV V+\n01000 WW W+\n01000 ZZ Z+\n10000 MC MAC MA?C+\n11111 ING ING\n01100 EMING EMMING EM+ING\n11000 SCH S[CH]+\n00100 SCH [SC]+H\n11000 GH GH?\n11000 DH DH?\n11000 RH RH?\n11000 WH WH?\n01100 OUIS (OIS|OUIS|OOIS|UOIS)\n01000 OU (OU|UO)\n01100 IA [EI]A\n01100 IZE ISE I[SZ]E\n11000 OE O?E\n00100 US [AEOU]+S\n11100 PH (PH|F+)\n01000 UI IU (UI|IU)\n00100 EL AL (AL|EL|LE)\n00100 ANE AIN A(IN|NE)\n00100 POLIS P+[AEIOUL]+S\n01100 AUK A[UL]K\n01100 BERG BURG BOURG B[OUE]+RG\n10011 LAS LOS L[AO]S\n01100 ERG URG [EU]RG\n01100 EARDT ARDT E?ARD?T\n01000 ARDT ARD?T\n11100 MOH MAH MUH M[AOU]H\n00011 VAN VON V[AO]N\n00011 1 (ONE|1)\n00011 2 (TWO|2)\n00011 3 (THREE|3)\n00011 4 (FOUR|4)\n00011 5 (FIVE|5)\n00011 6 (SIX|6)\n00011 7 (SEVEN|7)\n00011 8 (EIGHT|8)\n00011 9 (NINE|9)\n00011 10 (TEN|10)\n00011 11 (ELEVEN|11)\n00011 12 (TWELVE|12)\n00011 13 (THIRTEEN|13)\n00011 14 (FOURTEEN|14)\n00011 15 (FIFTEEN|15)\n00011 16 (SIXTEEN|16)\n00011 17 (SEVENTEEN|17)\n00011 18 (EIGHTEEN|18)\n00011 19 (NINETEEN|19)\n00011 20 (TWENTY|20)\n00011 21 (TWENTYONE|21)\n00011 22 (TWENTYTWO|22)\n00011 23 (TWENTYTHREE|23)\n00011 24 (TWENTYFOUR|24)\n00011 25 (TWENTYFIVE|25)\n00011 26 (TWENTYSIX|26)\n00011 27 (TWENTYSEVEN|27)\n00011 28 (TWENTYEIGHT|28)\n00011 29 (TWENTYNINE|29)\n00011 30 (THIRTY|30)\n00011 31 (THIRTYONE|31)\n00011 32 (THIRTYTWO|32)\n00011 33 (THIRTYTHREE|33)\n00011 34 (THIRTYFOUR|34)\n00011 35 (THIRTYFIVE|35)\n00011 36 (THIRTYSIX|36)\n00011 37 (THIRTYSEVEN|37)\n00011 38 (THIRTYEIGHT|38)\n00011 39 (THIRTYNINE|39)\n00011 40 (FORTY|40)\n00011 41 (FORTYONE|41)\n00011 42 (FORTYTWO|42)\n00011 43 (FORTYTHREE|43)\n00011 44 (FORTYFOUR|44)\n00011 45 (FORTYFIVE|45)\n00011 46 (FORTYSIX|46)\n00011 47 (FORTYSEVEN|47)\n00011 48 (FORTYEIGHT|48)\n00011 49 (FORTYNINE|49)\n00011 50 (FIFTY|50)\n00011 51 (FIFTYONE|51)\n00011 52 (FIFTYTWO|52)\n00011 53 (FIFTYTHREE|53)\n00011 54 (FIFTYFOUR|54)\n00011 55 (FIFTYFIVE|55)\n00011 56 (FIFTYSIX|56)\n00011 57 (FIFTYSEVEN|57)\n00011 58 (FIFTYEIGHT|58)\n00011 59 (FIFTYNINE|59)\n00011 60 (SIXTY|60)\n00011 61 (SIXTYONE|61)\n00011 62 (SIXTYTWO|62)\n00011 63 (SIXTYTHREE|63)\n00011 64 (SIXTYFOUR|64)\n00011 65 (SIXTYFIVE|65)\n00011 66 (SIXTYSIX|66)\n00011 67 (SIXTYSEVEN|67)\n00011 68 (SIXTYEIGHT|68)\n00011 69 (SIXTYNINE|69)\n00011 70 (SEVENTY|70)\n00011 71 (SEVENTYONE|71)\n00011 72 (SEVENTYTWO|72)\n00011 73 (SEVENTYTHREE|73)\n00011 74 (SEVENTYFOUR|74)\n00011 75 (SEVENTYFIVE|75)\n00011 76 (SEVENTYSIX|76)\n00011 77 (SEVENTYSEVEN|77)\n00011 78 (SEVENTYEIGHT|78)\n00011 79 (SEVENTYNINE|79)\n00011 80 (EIGHTY|80)\n00011 81 (EIGHTYONE|81)\n00011 82 (EIGHTYTWO|82)\n00011 83 (EIGHTYTHREE|83)\n00011 84 (EIGHTYFOUR|84)\n00011 85 (EIGHTYFIVE|85)\n00011 86 (EIGHTYSIX|86)\n00011 87 (EIGHTYSEVEN|87)\n00011 88 (EIGHTYEIGHT|88)\n00011 89 (EIGHTYNINE|89)\n00011 90 (NINETY|90)\n00011 91 (NINETYONE|91)\n00011 92 (NINETYTWO|92)\n00011 93 (NINETYTHREE|93)\n00011 94 (NINETYFOUR|94)\n00011 95 (NINETYFIVE|95)\n00011 96 (NINETYSIX|96)\n00011 97 (NINETYSEVEN|97)\n00011 98 (NINETYEIGHT|98)\n00011 99 (NINETYNINE|99)\n00011 100 ((A|ONE)?HUNDRED|100)\n00011 200 (TWOHUNDRED|200)\n"},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return o}));var o=function e(t){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a(this,e),this.toggle=function(){$("#".concat(n.id)).toggleClass("expanded"),n.callback&&n.callback()},this.hide=function(){$("#".concat(n.id)).hide()},this.show=function(){$("#".concat(n.id)).show()},this.id=t,this.callback=o,$("body").on("click","#".concat(this.id," .expandable-head"),this.toggle)}},function(e){e.exports=JSON.parse('{"1":"ONE","2":"TWO","3":"THREE","4":"FOUR","5":"FIVE","6":"SIX","7":"SEVEN","8":"EIGHT","9":"NINE","10":"TEN","20":"TWENTY","50":"FIFTY","100":"HUNDRED","PHOTO":"PICTURE","PICTURE":"PHOTO","START":"BEGIN","BEGIN":"START","ISLAMIC":"MUSLIMS","MUSLIM":"ISLAM","MUSLIMS":"ISLAM","ISLAM":"MUSLIMS","CANADA":"CANADIAN","CANADIAN":"CANADA","TRADE":"TRADING","TRADING":"TRADE","ANDES":"ANDEAN","ANDEAN":"ANDES","FURTHEST":"FARTHEST","FARTHEST":"FURTHEST","CITIES":"CITY","CITY":"CITIES","COUNTRIES":"COUNTRY","COUNTRY":"COUNTRIES","CLOSEST":"NEAREST","NEAREST":"CLOSEST","POPULOUS":"POPULATION","POPULATION":"POPULOUS","TV":"TELEVISION","TELEVISION":"TV","ENGLISH":"ENGLAND","ENGLAND":"ENGLISH","MOVIE":"FILM","FILM":"MOVIE","EUROPE":"EUROPEAN","ASIA":"ASIAN","AFRICA":"AFRICAN","BIGGEST":"LARGEST","LARGEST":"BIGGEST","QUARTERBACKS":"QBS","QBS":"QUARTERBACKS","BEST":"GREATEST","GREATEST":"BEST","FEWEST":"LOWEST","LEAST":"LOWEST","LOWEST":"FEWEST","HIGHEST":"MOST","MOST":"HIGHEST","ONE":"1","TWO":"2","THREE":"3","FOUR":"4","FIVE":"5","SIX":"6","SEVEN":"7","EIGHT":"8","NINE":"9","TEN":"10","TWENTY":"20","FIFTY":"50","HUNDRED":"100","FRANCE":"FRENCH","FRENCH":"FRANCE","SPANISH":"SPAIN","SPAIN":"SPANISH","GREEK":"GREECE","GREECE":"GREEK","CHINA":"CHINESE","CHINESE":"CHINA","DENMARK":"DANISH","DANISH":"DENMARK","ALL":"EVERY","EVERY":"ALL","AVERAGE":"MEDIAN","MEDIAN":"AVERAGE","ROME":"ROMAN","ROMAN":"ROME","RICHEST":"WEALTHIEST","US":"UNITEDSTATES","STATES":"US","UNITEDSTATES":"US","UK":"UNITEDKINGDOM","KINGDOM":"UK","UNITEDKINGDOM":"UK","COUNTY":"COUNTIES","COUNTIES":"COUNTY"}')},function(e){e.exports=JSON.parse('{"hqm-sort-type":["Sort Type","<b>Alphabetical</b> - Sort answers alphabetically<p><b>Numerical - US/UK</b> - Sort answers numerically according to standard English format (e.g. 1,234.56)</p><p><b>Numerical - Europe</b> - Sort answers numerically according to typical European format (e.g. 1.234,56 or 1 234,56)</p>"],"hqm-selector-height":["Selector Height","<p>The selector height specified is only a maximum, if there are few answers then the height will shrink accordingly.</p><p><b>Recommended</b> - Set to \\"Auto\\" to make the selector have a maximum height in line with the bottom of the SVG map.</p><p><b>Custom</b> - Set the height to a custom amount, useful if you have a short SVG and the \\"Auto\\" setting results in a short answer box.</p>"],"hqm-random-choices":["Randomize Choices","If set to \\"Yes\\", the choices within every question will be randomly shuffled every time the user takes the quiz."],"hqm-use-explanations":["Post-Game Explanations","With this enabled, you can add explanations for each question that will appear to the user after the quiz is finished."],"hqm-copy-choices":["Copy Choices","This will copy the choices of the selected question to every other question."],"hqm-mobile-design":["Mobile Design Options","<p>This determines how your quiz will be displayed on a mobile phone.</p><p><b>Default</b> - The content will be condensed to fit onto the width of a mobile screen.</p><p><b>Scroll</b> - The content will display the same as on desktop browsers. The user will be able to scroll horizontally to see all the content. (Recommended for SVG quizzes.)</p>"],"hqm-design-mode":["Design Mode","<b>Recommended</b> - Auto mode automatically arranges the answers on the grid.<p><b>Advanced</b> - Manual mode allows you to add rows, columns and blocks in order to put answers, hints or text wherever you want on the grid</p>"],"hqm-random-tiles":["Randomize Tiles","If set to \\"Yes\\", the tiles within every question will be randomly shuffled every time the user takes the quiz."],"hqm-copy-tiles":["Copy Tiles","This will copy the tiles of the selected question to every other question."],"hqm-switch-input":["Switch Input Mode","In Tile Select quizzes, there are two modes of input required to create the quiz:<table style=\'font-size:15px;margin: 5px 0;\'><tr><td style=\'width:100px;display: block;\'><b>Typing Mode:</b></td><td>This mode is the default starting mode and allows you to type inside the tiles</td></tr><tr><td style=\'width:100px;display: block;\'><b>Select Mode:</b></td><td>This mode allows you to select the tiles for each question which should be selected during gameplay</td></tr><br></table>The currently selected mode is shown above the first question."],"hqm-photo-layout":["Picture Layout","<b>Fixed Width</b> - All the images are the same width. Each row has the same number of pictures.<p><b>Variable</b> - The images can be resized, and can be different widths. We put as many on a row as will fit.</p>"],"hqm-yellow-box":["Yellow Box Mode","Normally, the user can answer questions in any order. If you set Yellow Box to \\"Yes\\", then the user can only answer the highlighted question. Use with caution."],"hqm-visibility":["Visibility","Quizzes marked \\"Private\\" will not be displayed except to your friends or people with whom you share a link. They will still be moderated."],"hqm-svg-missing-dots":["Show Missing Dots","<p>We recommend setting this to <b>No</b><p>\\"Missing Dots\\" is a feature on the <a href=\'https://www.jetpunk.com/quizzes/how-many-countries-can-you-name\' target=\'_blank\'>Countries of the World Quiz</a>.</p><p>It shows a small dot on the SVG where an answer has yet to be guessed. The dots need to be programmed using columns 2 and 3 of Step 2, measured in pixels from the top-left.<p><p>You can change the text shown under the \\"SVG Map\\" options to the right.</p>"],"hqm-svg-hidden-paths":["Hidden Paths","<p>If set to \\"Yes\\", all paths associated with the ids / classes of the answers in Step 2 will be hidden until guessed.</p><p>For Random quizzes, only the paths associated with the answers selected will be hidden.</p>"],"hqm-add-caveat":["Add / Remove Caveats","<p>Caveats are the \\"fine print\\", often used to explain nit-picky details or to list sources.</p><p>We recommend keeping them short and sweet."],"hqm-blog-blurb":["Blog Blurb","The blurb is a short summary of the blog article that will appear on your main blog page. HTML is heavily limited in this section."],"hqm-blog-visibility":["Visibility","<p>Blogs marked \\"Unlisted\\" will be available publicly, but only on your blog page, and will not appear on any other pages.</p><p>Marking as \\"Private\\" means your blog will not be displayed except to people with whom you share a link.</p><p>All blogs will still be moderated.</p>"],"hqm-blog-tags":["Blog Tags","With blog tags you have the option to attach a tag to your blog to help interested users find it more easily. Each blog can only have one tag, so choose the most appropriate."],"hqm-blog-ql":["Quick Links","All Headings of your blog (not in Split components) will be used to create a contents list at the top of your blog to make it easier to navigate"]}')},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(1),o=n(2),r=n(0);function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw r}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyDown=function(e){if(a.open){switch(e.which){case 9:e.shiftKey?a.moveCursor(-1):a.moveCursor(1);break;case 13:a.select();break;case 38:a.moveCursor(-1);break;case 40:a.moveCursor(1);break;default:return}e.preventDefault()}},this.closed=function(){a.open=!1},this.clickSearchUser=function(e){var t,n=$(e.target).data("id"),o=i(a.results);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(r.uid==n)return void a.chooseUser(r)}}catch(e){o.e(e)}finally{o.f()}},this.typing=function(e){var t=a.getSearchTerm(e.target.value);t!=a.term?(a.term=t,""==t||a.cache[t]?a.drawResults():(a.setLoading(!0),a.search(t))):a.drawResults()},this.search=function(e){$.ajax({type:"POST",url:"/api/search-users.php",data:{term:e},success:function(t){var n;try{n=JSON.parse(t)}catch(e){return}a.cache[e]=n,e==a.term&&a.drawResults()}})},this.page=t,this.callback=n,this.cache={},this.term="",this.loading=!1,this.open=!1,this.results=[],this.selectedIdx=-1,$("body").on("input",".friend-search-modal .txt-friend-search",this.typing),$("body").on("click",".friend-search-modal .search-results .result",this.clickSearchUser),$(document).on("keydown",this.keyDown)}var t,n,s;return t=e,(n=[{key:"moveCursor",value:function(e){$(".friend-search-modal .result").removeClass("selected");var t=this.selectedIdx;(t+=e)>=this.results.length&&(t=0),t<0&&(t=this.results.length-1),$("#friend-row-"+t).addClass("selected"),this.selectedIdx=t}},{key:"launch",value:function(){this.open=!0;var e="\n      ".concat(r.a.translate("Enter screen name here:"),'\n      <div class="mt-1 search-holder">\n        <div><input type="text" class="txt-friend-search" /></div>\n        <div class="loading"><i class="fa fa-circle-notch fa-spin"></i></div>\n      </div>\n      <div class="search-results"></div>\n    ');a.a.alert("Search Users",e,this.closed,{hideFooter:!0,customClass:"friend-search-modal"})}},{key:"select",value:function(){-1!=this.selectedIdx&&this.chooseUser(this.results[this.selectedIdx])}},{key:"chooseUser",value:function(e){a.a.close(),this.callback(e)}},{key:"getSearchTerm",value:function(e){return(e=o.a.normalizeString(e)).length>3?e.substring(0,3):e.length>=1?e:""}},{key:"setLoading",value:function(e){this.loading=e,$(".friend-search-modal .loading").toggle(e)}},{key:"filterResults",value:function(e){for(var t=o.a.normalizeString($(".txt-friend-search").val()),n=[],a=0;a<e.length;a++){var r=e[a],i=r.screenname.toUpperCase();0==i.indexOf(t)&&(i==t?n.unshift(r):n.length<8&&n.push(r))}return n.slice(0,8)}},{key:"drawResults",value:function(){if(this.selectedIdx=-1,this.results=[],""!=this.term){if(!this.cache[this.term])return;this.results=this.cache[this.term],this.results=this.filterResults(this.results)}var e;this.setLoading(!1),e=0==this.results.length&&""!=this.term?"<div>No results found</div>":(e=this.results.map((function(e,t){return'<div data-id="'.concat(e.uid,'" id="friend-row-').concat(t,'" class="result">').concat(e.screenname,"</div>")}))).join(""),$(".friend-search-modal .search-results").html(e)}}])&&l(t.prototype,n),s&&l(t,s),e}()},,function(e,t){function n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function o(e){return 120*e.imageWidth/e.imageHeight}function r(e){var t=1040-5*(e.images.length-1),n=Math.floor(120*t/e.width);return n>180&&(n=180),e.images.map((function(e){return function(e,t){return{id:e.id,height:t,width:Math.floor(t*e.imageWidth/e.imageHeight),previewURL:e.previewURL}}(e,n)})).sort((function(e,t){return e.previewURL.localeCompare(t.previewURL)}))}e.exports={arrangePhotos:function(e){for(var t=function(e){var t,a=0,r=n(e);try{for(r.s();!(t=r.n()).done;){a+=o(t.value)+5}}catch(e){r.e(e)}finally{r.f()}var i=Math.round(a/1040);return i>0?i:1}(e),a=[],i=0;i<t;i++)a.push({width:0,images:[]});var s,l=n(e=e.slice().sort((function(e,t){return o(t)-o(e)})));try{for(l.s();!(s=l.n()).done;){var c=s.value;a.sort((function(e,t){return e.width-t.width}));var u=a[0];u.images.push(c),u.width+=o(c)}}catch(e){l.e(e)}finally{l.f()}return a.map(r)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n(2),o=n(1),r=n(3),i=n(11),s=n(18);function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var d=function(){function e(t,n,a){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.acquireLock=function(){r.a.go({url:"/api/create/collaborate-api.php",data:{json:JSON.stringify({id:i.obj.id,command:"acquire",quizorblog:i.quizorblog})},loading:"Locking",callback:function(e){i.lockedby=i.page.user.uid,$("#collaborate-warning").html(e.msg).show(),i.parent.rightColTop=$(".create-right").offset().top}})},this.releaseLock=function(){r.a.go({url:"/api/create/collaborate-api.php",data:{json:JSON.stringify({id:i.obj.id,command:"release",quizorblog:i.quizorblog})},loading:"Releasing lock",callback:function(e){i.lockedby=-1,$("#collaborate-warning").html(e.msg).show(),i.parent.rightColTop=$(".create-right").offset().top}})},this.forceUnlock=function(){o.a.choice("Confirm","Are you sure you want to forcibly unlock this ".concat(i.type,"?"),["Cancel","Yes"],[null,i.forceUnlockEx])},this.forceUnlockEx=function(){r.a.go({url:"/api/create/collaborate-api.php",data:{json:JSON.stringify({id:i.obj.id,command:"force",quizorblog:i.quizorblog})},loading:"Unlocking",callback:function(e){i.lockedby=-1,$("#collaborate-warning").html(e.msg).show(),i.parent.rightColTop=$(".create-right").offset().top}})},this.change=function(){var e=i.selected.map((function(e){return e.screenname}));i.pushChanges(e)},this.removeAll=function(){i.selected=[],i.drawUsers()},this.pushChanges=function(e){r.a.go({url:"/api/create/collaborate-api.php",data:{json:JSON.stringify({inputs:e,id:i.obj.id,command:"change",quizorblog:i.quizorblog})},loading:"Updating",callback:function(e){var t;i.collabs=e.collabs,i.lockedby=-1,0==i.collabs.length?(t="This ".concat(i.type," is no longer shared"),$("#collaborate-warning").hide()):(t="<p>This ".concat(i.type," is now shared with the following users:</p>")+i.collabs.map((function(e){return"<p>"+e.screenname+"</p>"})).join(""),$("#collaborate-warning").html(e.msg).show()),i.parent.rightColTop=$(".create-right").offset().top,o.a.close(),o.a.alert("Collaboration Updated",t)}})},this.removeSelected=function(e){var t=$(e.target).closest(".selected-user").data("id");i.selected=i.selected.filter((function(e){return e.uid!=t})),i.drawUsers()},this.addUser=function(){i.friendSearch.launch(),$(".txt-friend-search").focus()},this.drawUser=function(e){return'<div class="selected-user" data-id='.concat(e.uid,">").concat(e.screenname,' <i class="far fa-times-circle"></i></div>')},this.searchCallback=function(e){var t,n=l(i.selected);try{for(n.s();!(t=n.n()).done;){if(t.value.uid==e.uid)return}}catch(e){n.e(e)}finally{n.f()}i.selected.push(e),i.drawUsers()},this.drawModal=function(){if(i.isReadOnly())o.a.alert("Error","Can't edit collaboration because this ".concat(i.type," is currently locked by someone else"));else if(-1!=i.obj.id){i.selected=Object.assign([],i.collabs);var e='\n      <div class="instructions">\n        Share this '.concat(i.type,' with up to three other users. Click Add User to search for their name.\n        <br>\n        <sub><a href="/info/collaboration-on-quizzes" target="blank">Collaboration on JetPunk</a></sub>\n      </div>\n      <div class="mt-4">\n        <div><b>Selected Users:</b></div>\n        <div class="selected-users-holder">\n\n        </div>\n      </div>\n      <div class="mt-4">\n        <button class=\'green\' id=\'btn-add-collab\'>Add User</button>\n        <button class="red" id="btn-remove-all-collab">Remove All</button>\n      </div>');o.a.alert("Collaborate With Others",e,null,{customFooter:'<button class="blue" id="btn-change-collaborate">Submit</button>',customClass:"collaborate-modal"}),i.drawUsers()}else o.a.alert("Error","Please save this quiz before collaborating")},this.parent=a,this.create=t,this.page=t.page,this.friendSearch=new s.a(this.page,this.searchCallback),this.type=this.page.data.create.type,this.obj=n,this.quizorblog="blog"==this.type?1:0,this.lockedby=this.page.data.create[this.type].lockedby,this.collabs=this.page.data.create[this.type].collabs,$("body").on("click","#btn-launch-collaborate",(function(){return i.drawModal()})),$("body").on("click","#btn-change-collaborate",this.change),$("body").on("click","#btn-remove-all-collab",this.removeAll),$("body").on("click","#btn-force-unlock",this.forceUnlock),$("body").on("click","#btn-acquire-lock",this.acquireLock),$("body").on("click","#btn-release-lock",this.releaseLock),$("body").on("click","#btn-add-collab",this.addUser),$("body").on("click",".selected-user",this.removeSelected),0==this.collabs.length&&$("#collaborate-warning").hide()}var t,n,a;return t=e,(n=[{key:"isReadOnly",value:function(){return this.lockedby>0&&this.lockedby!=this.page.user.uid}},{key:"drawUsers",value:function(){var e=this.selected.map(this.drawUser);e=0==e.length?"<div class='none'>None</div>":e.join(""),$(".selected-users-holder").html(e),$("#btn-remove-all-collab").toggle(this.selected.length>0),$("#btn-add-collab").prop("disabled",3==this.selected)}}])&&u(t.prototype,n),a&&u(t,a),e}(),h=n(20),p=n(4);function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var m=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uploadPaste=function(e){if($(".add-photo-pane").hasClass("selected-pane")){for(var t=(e.clipboardData||e.originalEvent.clipboardData).items,a=null,o=0;o<t.length;o++)0===t[o].type.indexOf("image")&&(a=t[o].getAsFile());if(null!==a){var r=new FileReader;r.onload=n.uploadPasteEx,r.readAsDataURL(a)}}},this.uploadPasteEx=function(e){var t=new FormData;t.append("file",e.target.result),t.append("submission-type","paste"),r.a.go({url:"/api/photo-library/upload-from-paste.php",data:t,loading:"Uploading...",fileUpload:!0,callback:function(e){n.library.photoAdded(p.a.createImage({raw:e.id,ext:e.ext,src:"jet",url:e.url}))}})},this.downloadDirect=function(){var e=$("#txt-download-direct").val().trim();r.a.go({url:"/api/photo-library/download-direct-image.php",loading:"Adding image to your library ...",data:{url:e},callback:function(t){n.library.photoAdded(p.a.createImage({raw:t.id,ext:t.ext,src:"jet",url:e}))}})},this.directUpload=function(){var e=new FormData;e.append("file-upload-picture",$("#file-upload-picture").prop("files")[0]),r.a.go({url:"/api/photo-library/upload-picture.php",data:e,loading:"Uploading...",fileUpload:!0,callback:function(e){n.library.photoAdded(p.a.createImage({raw:e.id,ext:e.ext,src:"jet",url:e.url})),$("#file-upload-picture").val("")},errCallback:function(){$("#file-upload-picture").val("")}})},this.show=function(){n.library.showPane(".add-photo-pane"),$("#txt-search-pixa").focus()},this.changePixaPage=function(){n.searchPixa(parseInt($(".sel-pixa-page").val()))},this.keydownSearchPixa=function(e){13==e.which&&n.searchPixa(1)},this.downloadPixa=function(e){var t=$(e.target).data("id"),a=n.pixaResults.hits.find((function(e){return e.id==t}));void 0!==a&&r.a.go({url:"/api/photo-library/download-pixa-image.php",data:{pixaId:a.id,imageUrl:a.largeImageURL,pageUrl:a.pageURL},loading:"Adding image to your library ...",callback:function(e){n.library.photoAdded(p.a.createImage({raw:e.id,ext:e.ext,src:"pixa",url:e.url}))}})},this.downloadWiki=function(){var e=$("#txt-search-wiki").val().trim();r.a.go({url:"/api/photo-library/download-wiki-image.php",loading:"Adding image to your library ...",data:{url:e},callback:function(t){n.library.photoAdded(p.a.createImage({raw:t.id,ext:t.ext,src:"wiki",url:e}))}})},this.keydownDownloadWiki=function(e){13==e.which&&n.downloadWiki()},this.drawPixaImage=function(e){var t=e.width<150?e.previewURL:e.previewURL.replace("_150","__180");return'\n      <div class="pixa-result-cell">\n        <img src="'.concat(t,'" width="').concat(e.width,'" height="').concat(e.height,'" data-id="').concat(e.id,'"/>\n      </div>')},this.drawPixaRow=function(e){return e=e.map(n.drawPixaImage).join(""),'\n      <div class="pixa-result-row">\n        '.concat(e,"\n      </div>")},this.drawPixaResults=function(e){if(0!=e.totalHits){var t=n.getPixaPageSelect(n.pixaPage,e.totalHits),a=Object(h.arrangePhotos)(e.hits),o=a.length>1?"pixa-results-table space-between":"pixa-results-table";a=a.map(n.drawPixaRow).join("");var r='\n      <div class="pixa-controls">\n        <span class="pixa-num-results">'.concat(e.totalHits," Results Found</span> ").concat(t,'\n      </div>\n      <div class="').concat(o,'">\n        ').concat(a,"\n      </div>");$(".pixa-results").html(r)}else $(".pixa-results").html('<div class="pixa-no-results">No Results Found</div>')},this.library=t,this.page=t.page,this.pixaTerm="",this.pixaPage=1,this.pixaResults={},$("#btn-search-pixa").on("click",(function(){return n.searchPixa(1)})),$("#txt-search-pixa").on("keydown",this.keydownSearchPixa),$("#btn-search-wiki").on("click",this.downloadWiki),$("#txt-search-wiki").on("keydown",this.keydownDownloadWiki),$(".add-photo-pane .return-link").on("click",(function(){return n.library.showPane(".photo-library-pane")})),$(".add-photo-pane").on("change",".sel-pixa-page",this.changePixaPage),$(".add-photo-pane").on("click",".pixa-result-cell img",this.downloadPixa),$(".add-photo-pane").on("change","#file-upload-picture",this.directUpload),$(".add-photo-pane").on("click","#btn-download-direct",this.downloadDirect),a.a.isQuizmaster(this.page)&&(document.onpaste=this.uploadPaste)}var t,n,o;return t=e,(n=[{key:"searchPixa",value:function(e){var t=this,n=$("#txt-search-pixa").val().trim();r.a.go({url:"/api/photo-library/search-pixa.php",data:{term:n,page:e},loading:"Searching Pixabay...",callback:function(a){t.pixaResults=a,t.pixaTerm=n,t.pixaPage=e,t.drawPixaResults(a)}})}},{key:"getPixaPageSelect",value:function(e,t){var n=[];n.push('<select class="sel-pixa-page">');for(var a=0,o=1;a<t;a+=20,o+=1){var r=e==o?"selected":"";n.push("<option ".concat(r,' value="').concat(o,'">Page ').concat(o,"</option>"))}return n.push("</select>"),n}}])&&g(t.prototype,n),o&&g(t,o),e}();function f(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var v=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.choose=function(e){var t=parseInt($(e.target).data("id")),a=$(e.target).data("title");n.library.chooseCollection(t,a)},this.drawItem=function(e){return'<div class="collection-item link-like" data-title="'.concat(e.title,'" data-id="').concat(e.id,'">').concat(e.title,"</div>")},this.drawList=function(e){return e.sort((function(e,t){return a.a.normalizeWords(e.title)<a.a.normalizeWords(t.title)?-1:1})),(e=e.map(n.drawItem)).join("\n")},this.library=t,this.page=t.page,this.collections=null,$(".choose-collection-pane").on("click",".collection-item",this.choose),$(".choose-collection-pane").on("click",".return-link",(function(){return n.library.showPane(".photo-library-pane")}))}var t,n,o;return t=e,(n=[{key:"show",value:function(){null!=this.collections?this.library.showPane(".choose-collection-pane"):this.loadCollectionList()}},{key:"loadCollectionList",value:function(){var e=this,t=this.library.create.quiz?this.library.create.quiz.id:-1;r.a.go({url:"/api/photo-library/load-collection-list.php",loading:"Loading collections ...",data:{quiz:t},callback:function(t){e.collections=t,e.draw()}})}},{key:"draw",value:function(){var e=this.library.create.blog?"This Blog":"This Quiz";$("#blog-or-quiz-collection").html('<div class="big collection-item link-like" data-id="-1" data-title="'.concat(e,'">').concat(e,"</div>")),$("#user-collections").html(this.drawList(this.collections.user)),$("#featured-collections").html(this.drawList(this.collections.featured)),this.library.showPane(".choose-collection-pane")}}])&&f(t.prototype,n),o&&f(t,o),e}();function b(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var y=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.saveEditedPhoto=function(){r.a.go({url:"/api/photo-library/save-edited-photo.php",data:{rawId:n.image.raw,editedId:n.image.fn,transformation:JSON.stringify(n.image.transformation)},loading:"Saving photo ...",callback:function(e){var t=n.image.transformation,a=t.top,o=t.left,r=t.bottom,i=t.right;n.image.h=r-a,n.image.w=i-o,n.image.fn=e,n.library.editDone(n.image)}})},this.imageFailed=function(){o.a.close(),o.a.alert("Error","Image failed to load",n.library.editBack)},this.imageLoaded=function(){clearTimeout(n.loadFailTimeout),o.a.close(),""==n.image.fn&&(n.image.transformation={top:0,left:0,bottom:n.jsImage.height,right:n.jsImage.width,brightness:0,contrast:0}),n.draw(),"phone"==n.page.device&&($(".drag-handles-text").html("Sorry, but editing photos is not possible on mobile for now."),window.scrollTo(0,0))},this.mousedownHandle=function(e){var t=n.image.transformation,a=t.top,o=t.left,r=t.bottom,i=t.right;n.dragHandle={id:$(e.target).attr("id"),x:e.clientX,y:e.clientY,top:a,left:o,bottom:r,right:i},$("body").bind("mousemove",n.mouseMove),$("body").bind("mouseup",n.mouseUp)},this.mouseUp=function(){null!=n.dragHandle&&($("body").unbind("mousemove",n.mouseMove),$("body").bind("mouseup",n.mouseUp),n.dragHandle=null)},this.mouseMove=function(e){var t=n.dragHandle,o=t.x,r=t.y,i=t.id,s=t.top,l=t.left,c=t.bottom,u=t.right,d=n.image.transformation,h=e.clientX-o,p=e.clientY-r,g=235,m=235;"cropped-image"==i&&(g=c-s,m=u-l),"handle-top-left"!=i&&"handle-top-right"!=i&&"handle-top"!=i&&"cropped-image"!=i||(d.top=a.a.constrainRange(s+p,0,d.bottom-g)),"handle-top-left"!=i&&"handle-bottom-left"!=i&&"handle-left"!=i&&"cropped-image"!=i||(d.left=a.a.constrainRange(l+h,0,d.right-m)),"handle-bottom-left"!=i&&"handle-bottom-right"!=i&&"handle-bottom"!=i&&"cropped-image"!=i||(d.bottom=a.a.constrainRange(c+p,d.top+g,n.jsImage.height)),"handle-top-right"!=i&&"handle-bottom-right"!=i&&"handle-right"!=i&&"cropped-image"!=i||(d.right=a.a.constrainRange(u+h,d.left+m,n.jsImage.width)),n.positionBoxes()},this.adjustContrast=function(e){n.image.transformation.contrast=parseInt(e.target.value),n.drawBrightnessContrast()},this.adjustBrightness=function(e){n.image.transformation.brightness=parseInt(e.target.value),n.drawBrightnessContrast()},this.draw=function(){$(".edit-photo-pane .photo").html('<img src="'.concat(n.jsImage.src,'"/>')),n.positionBoxes(),n.drawBrightnessContrast()},this.library=t,this.page=t.page,this.jsImage=null,this.dragHandle=null,this.loadFailTimeout=null,$(".edit-photo-pane").on("click",".return-link",this.library.editBack),$(".edit-photo-pane").on("mousedown",".handle, #cropped-image",this.mousedownHandle),$("#slider-brightness").on("input",this.adjustBrightness),$("#slider-contrast").on("input",this.adjustContrast),$("#btn-save-edited-photo").on("click",this.saveEditedPhoto)}var t,n,i;return t=e,(n=[{key:"show",value:function(e){this.image=new p.a.createImage(e),o.a.loading("Loading image"),this.jsImage=new Image,this.jsImage.onload=this.imageLoaded,this.jsImage.src="/img/user-raw-img/".concat(Math.floor(this.image.raw/1e3),"/").concat(this.image.raw,".").concat(this.image.ext),this.loadFailTimeout=setTimeout(this.imageFailed,3e3)}},{key:"drawBrightnessContrast",value:function(){var e=this.image.transformation,t=e.brightness,n=e.contrast,a=n>=0?"+":"";$(".edit-photo-pane .contrast").text(a+n),a=t>=0?"+":"",$(".edit-photo-pane .brightness").text(a+t);var o="contrast(".concat((100+n)/100,") brightness(").concat((100+t)/100,")");$(".photo img").css({filter:o,"-webkit-filter":o})}},{key:"positionBoxes",value:function(){var e=this.image.transformation,t=e.top,n=e.bottom,a=e.left,o=e.right,r=this.jsImage,i=r.width,s=r.height;$("#cropped-image").css({left:a,top:t,width:o-a,height:n-t}),$("#translucent-box-left").css({height:s,width:a}),$("#translucent-box-top").css({left:a,width:o-a,height:t}),$("#translucent-box-right").css({left:o,height:s,width:i-o}),$("#translucent-box-bottom").css({left:a,top:n,width:o-a,height:s-n}),$("#handle-top-left").css({top:t,left:a}),$("#handle-top-right").css({top:t,left:o}),$("#handle-bottom-left").css({top:n,left:a}),$("#handle-bottom-right").css({top:n,left:o}),$("#handle-top").css({top:t,left:Math.round((a+o-17)/2)}),$("#handle-bottom").css({top:n,left:Math.round((a+o-17)/2)}),$("#handle-left").css({top:Math.round((t+n-17)/2),left:a}),$("#handle-right").css({top:Math.round((t+n-17)/2),left:o}),$("#handle-line-left").css({top:t,left:a,height:n-t}),$("#handle-line-right").css({top:t,left:o,height:n-t}),$("#handle-line-top").css({top:t,left:a,width:o-a}),$("#handle-line-bottom").css({top:n,left:a,width:o-a})}}])&&b(t.prototype,n),i&&b(t,i),e}();function w(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function I(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var S=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keydownSearchCollections=function(e){13==e.which&&n.searchCollections()},this.searchCollections=function(){var e=$("#txt-search-collections").val().trim(),t=null==n.page.create.quiz?"blog":"quiz",a=null!=n.page.create.quiz?n.page.create.quiz.id:n.page.create.blog.id;r.a.go({url:"/api/photo-library/search-collections.php",timeout:1e4,data:{type:t,id:a,term:e},loading:"Searching Collections...",callback:function(t){n.searchResults={};var a,o=w(t.results);try{for(o.s();!(a=o.n()).done;){var r=a.value;n.searchResults[r.fn]=r}}catch(e){o.e(e)}finally{o.f()}n.searchTerm=e,n.drawSearchResults(t.results)}})},this.addImage=function(e){var t=$(e.target).closest("img").data("id"),a=n.searchResults[t];n.library.photoAdded(a)},this.drawImage=function(e){var t=a.a.getImageUrl(e,235);return'\n      <div class="pixa-result-cell">\n        <img src="'.concat(t,'" height="120" data-id="').concat(e.fn,'"/>\n      </div>')},this.drawSearchResults=function(e){if(0!=Object.keys(e).length){var t=e.map(n.drawImage).join("");$(".collection-results").html(t)}else $(".collection-results").html('<div class="search-collections-no-results">No Results Found</div>')},this.library=t,this.page=t.page,this.searchTerm="",this.searchResults={},$("#btn-search-collections").on("click",this.searchCollections),$("#txt-search-collections").on("keydown",this.keydownSearchCollections),$(".search-collections-pane").on("click",".pixa-result-cell img",this.addImage),$(".search-collections-pane").on("click",".return-link",(function(){return n.library.showPane(".photo-library-pane")}))}var t,n,o;return t=e,(n=[{key:"show",value:function(){this.library.showPane(".search-collections-pane"),$("#txt-search-collections").focus()}}])&&I(t.prototype,n),o&&I(t,o),e}(),T=n(7);function E(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var O=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.showPane=function(e){var t=$(".selected-pane");if(t.length>=1){var a,o=E(t=t[0].classList);try{for(o.s();!(a=o.n()).done;){var r=a.value;"selected-pane"!=r&&"create-pane"!=r&&(n.previousPane=r)}}catch(e){o.e(e)}finally{o.f()}}$(".selected-pane").removeClass("selected-pane"),$(e).addClass("selected-pane")},this.clickPhoto=function(e){var t=parseInt($(e.target).closest(".picture").data("idx"));n.callback(n.collection[t].image)},this.clickEditPhoto=function(e){var t=parseInt($(e.target).data("idx"));n.editPhoto.show(n.collection[t].image),n.showPane(".edit-photo-pane"),n.editBackPane=".photo-library-pane"},this.editDone=function(e){n.callback(e)},this.editBack=function(){""==n.previousPane&&(n.previousPane="add-photo-pane"),n.showPane("."+n.previousPane)},this.photoAdded=function(e){n.editPhoto.show(e),n.showPane(".edit-photo-pane")},this.page=t.page,this.create=t.create,this.activeCollection={id:-1,title:"This "+a.a.capFirstLetter(t.type)},this.previousPane="",this.collection=[],this.addPhoto=new m(this),this.editPhoto=new y(this),this.collectionChooser=new v(this),this.searchCollections=new S(this),$("#btn-add-photo").on("click",this.addPhoto.show),$(".photo-library-pane .return-link").on("click",(function(){return n.callback(null)})),$(".photo-library-pane").on("click",".edit",this.clickEditPhoto),$(".photo-library-pane").on("click",".picture",this.clickPhoto),$(".photo-library-pane").on("click","#choose-collection",(function(){return n.collectionChooser.show()})),$(".photo-library-pane").on("click","#search-inside-collections",(function(){return n.searchCollections.show()}))}var t,n,o;return t=e,(n=[{key:"show",value:function(e){this.callback=e,-1==this.activeCollection.id&&this.initCollectionForQuizOrBlog(),this.draw(),this.showPane(".photo-library-pane"),window.scrollTo(0,0)}},{key:"chooseCollection",value:function(e,t){var n=this;this.activeCollection={id:e,title:t},-1==e?(this.initCollectionForQuizOrBlog(),this.draw(),this.showPane(".photo-library-pane")):r.a.go({url:"/api/photo-library/load-collection.php",data:{quiz:e},loading:"Loading collection...",callback:function(e){n.collection=e,n.draw(),n.showPane(".photo-library-pane")}})}},{key:"initCollectionForQuizOrBlog",value:function(){var e=this.create,t=e[e.state.type];if(this.collection=[],t.thumb&&this.collection.push({display:"thumbnail",image:t.thumb}),"blog"==e.state.type)for(var n in t.components){var a=t.components[n];if(a.image){var o=a.caption==T.a.DEFAULTS[T.a.TYPE_IMAGE]?"<i>(blank)</i>":a.caption;this.collection.push({display:o,image:a.image})}}else{var r,i=E(t.answerOrder);try{for(i.s();!(r=i.n()).done;){n=r.value;var s=t.answers[n];if(s.image&&this.collection.push({display:s.display,image:s.image}),s.choices){var l,c=E(s.choiceOrder);try{for(c.s();!(l=c.n()).done;){var u=l.value;if(s.choices[u].image){var d=t.answerOrder.indexOf(n)+1,h=s.choiceOrder.indexOf(u)+1;this.collection.push({display:"Q"+d+": Choice "+h,image:s.choices[u].image})}}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){i.e(e)}finally{i.f()}}}},{key:"getImageHtml",value:function(e,t){var n=e.display,o=e.image,r=a.a.getImageUrl(o,"pl");return'\n      <div class="picture-holder">\n        <div class="picture" data-idx="'.concat(t,'">\n          <div class="picture-title">').concat(n,'</div>\n          <img height="120" src="').concat(r,'" data-idx="').concat(t,'"/>\n        </div>\n        <div class="controls">\n          <span class="edit" data-idx="').concat(t,'">edit</span>\n        </div>\n      </div>')}},{key:"draw",value:function(){var e;$("#active-collection").text(this.activeCollection.title),e=0==this.collection.length?'<div class="no-images">This collection has no images</div>':this.collection.map(this.getImageHtml).join(""),$(".photo-library-pane .pictures").html(e)}}])&&C(t.prototype,n),o&&C(t,o),e}();function A(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var z=function(){function e(t){var n=this;for(var a in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.toggleMobile=function(){$(".create-right div:not(:first-child)").toggleClass("mobile-controller")},this.logout=function(){n.isSaved()?n.page.logoutEx():o.a.choice("Warning","<p>Your ".concat(n.type," has unsaved changes which will be lost on logout.<p>Are you sure?</p>"),["Cancel","Yes"],[null,function(){$(window).unbind("beforeunload"),n.page.logoutEx()}])},this.handleScrolling=function(){if("phone"!=n.page.device)if($(window).scrollTop()>n.rightColTop){var e=$(".page"),t=$("#inner-page"),a=$(".create-left"),o=e.width()>=t.width()?a.width()+20:e.width()-290;$(".create-right").css("margin-left",o),$(".create-right").addClass("create-right-fix")}else $(".create-right").removeClass("create-right-fix"),$(".create-right").css("margin-left",10)},this.beforeUnload=function(){if(!n.isSaved())return"You have unsaved changes!"},this.keyboardShortcuts=function(e){var t=e.ctrlKey||e.metaKey,a=e.which;if(!$(".search-box").is(":focus")&&t){if(83==a)return $("#btn-save").focus(),n.save(),void e.preventDefault();if(90==a){if(e.shiftKey)return n.historyIdx<n.history.length-1&&($("#btn-redo").focus(),n.redo()),void e.preventDefault();if(!e.shiftKey)return n.historyIdx>0&&($("#btn-undo").focus(),n.undo()),void e.preventDefault()}}},this.undo=function(){n.historyIdx-=1,n.restoreFromHistory(),n.toggleHistory(),n.draw()},this.redo=function(){n.historyIdx+=1,n.restoreFromHistory(),n.toggleHistory(),n.draw()},this.save=function(e){var t;null!==n.page.user?n.collaborate.isReadOnly()?o.a.alert("Unable to save "+n.type,"You are in read-only mode"):r.a.go({url:"/api/create/"+n.type+"/save-"+n.type+".php",data:(t={},N(t,n.type,JSON.stringify(n.create[n.type])),N(t,"power",e),t),loading:"Saving ".concat(n.type,"..."),timeout:15e3,callback:function(e){n.saveSuccess(e)}}):n.page.showAskCreate()},this.saveSuccess=function(e){n.savedIdx=n.historyIdx,n.revertSavedDisplay();var t=null;-1==n.create[n.type].id||null!=n.page.data.create[n.type].content?t=function(){window.location="/create-".concat(n.type,"/").concat(e[n.type].id)}:"blog"==n.type?t=function(){n.create[n.type]=e[n.type],n.draw()}:"quiz"==n.type&&(t=function(){n.create.updateSubmit()}),o.a.alert("Success","Your "+n.type+" has been saved",t)},this.clickStep=function(e){var t=$(e.target).data("id");n.changeStep(t),"phone"==n.page.device&&n.toggleMobile()},this.copyThumb=function(){var e=parseInt($("#txt-copy-thumb").val());r.a.go({url:"/api/create/quiz/get-thumb-for-quiz.php",data:{id:e},callback:function(e){n.action({thumb:e}),n.draw()}})},this.chooseThumb=function(){var e=$(window).scrollTop();n.photoLibrary.show((function(t){return n.setThumb(t,e)}))},this.setThumb=function(e,t){if(null!==e){var a=!0,r=n.create[n.type].thumb;if(r&&r.fn==e.fn&&(a=!1),a){var i=e.w/e.h;if(i>260/170)return void o.a.alert("Error","This image is the wrong shape for a thumbnail (too wide)");if(i<100/120)return void o.a.alert("Error","This image is the wrong shape for a thumbnail (too tall)");var s={};s.thumb=e,n.action(s),n.drawThumb()}}n.photoLibrary.showPane("."+n.type+"-pane"),window.scrollTo(0,t)},this.deleteThumb=function(){var e={thumb:null};n.action(e),n.drawThumb()},this.create=t,this.page=t.page,this.createData=this.page.data.create,this.type=this.createData.type,this.step="1",this.photoLibrary=new O(this),this.collaborate=new d(t,t[this.type],this),this.rightColTop=$(".create-right").offset().top,this.expandables={},this.createData.expandables){this.expandables[a]=[];var s,l=A(this.createData.expandables[a]);try{for(l.s();!(s=l.n()).done;){var c=s.value;this.expandables[a].push(new i.a(c))}}catch(e){l.e(e)}finally{l.f()}}this.create.displayState={},"phone"==this.page.device&&($(".create-right").parent().prepend($(".create-right")),$(".action-buttons").parent().prepend($(".action-buttons")),$(".create-right div:not(:first-child)").addClass("mobile-controller"),$("#mobile-options").on("click",this.toggleMobile),$(".step-1 .thumb").append("<div class='thumb-phone'>Note: Thumbnails only appear on desktop</div>")),$("body").on("click","#btn-undo",this.undo),$("body").on("click","#btn-redo",this.redo),$("body").on("click","#btn-save",(function(){return n.save(0)})),$("body").on("click","#btn-power",(function(){return n.save(1)})),$(".create-editor").on("click",".add-thumb",this.chooseThumb),$(".create-editor").on("click",".delete-thumb",this.deleteThumb),$(".create-editor").on("click","#btn-copy-thumb",this.copyThumb),$(".step-selector .step-button").on("click",this.clickStep),$("body").on("keydown",this.keyboardShortcuts),$(window).bind("beforeunload",this.beforeUnload),$(window).scroll(this.handleScrolling),this.initHistory(),this.toggleHistory()}var t,n,s;return t=e,(n=[{key:"canEdit",value:function(){return this.createData[this.type].owner.uid==this.page.user.uid||a.a.isQuizmaster(this.page)}},{key:"isSaved",value:function(){return this.savedIdx==this.historyIdx}},{key:"revertSavedDisplay",value:function(){var e=-1!=this.create[this.type].id&&this.isSaved();this.setSavedDisplay(e)}},{key:"setSavedDisplay",value:function(e){$("#btn-save").prop("disabled",e)}},{key:"toggleHistory",value:function(){this.revertSavedDisplay(),$("#btn-undo").prop("disabled",0==this.historyIdx),$("#btn-redo").prop("disabled",this.historyIdx==this.history.length-1)}},{key:"initHistory",value:function(){this.history=[],this.history.push(N({},this.type,this.create[this.type])),this.historyIdx=0,this.savedIdx=0}},{key:"restoreFromHistory",value:function(){var e=this.history[this.historyIdx];for(var t in e)["step","scroll"].includes(t)||(this.create[t]=e[t]);null!=e.step&&(this.step=e.step),null!=e.scroll&&$(window).scrollTop(e.scroll)}},{key:"action",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},this.create[this.type]);for(var a in e)n[a]=e[a];this.history.splice(this.historyIdx+1),this.savedIdx>this.history.length&&(this.savedIdx=-1);var o=this.history[this.history.length-1];o.step=this.step,o.displayState=this.create.displayState,o.scroll=$(window).scrollTop();var r=[];for(var a in r[this.type]=n,r.step=this.step,r.scroll=$(window).scrollTop(),r.displayState=$.extend(!0,{},this.create.displayState),t)r.displayState[a]=t[a];this.history.push(r),this.historyIdx=this.history.length-1,this.create.displayState=r.displayState,this.create[this.type]=n,this.toggleHistory()}},{key:"drawStep",value:function(){$(".step-button.selected, .create-step.selected").removeClass("selected"),$(".step-"+this.step).addClass("selected")}},{key:"changeStep",value:function(e){isNaN(e)||e!=parseInt(e)||parseInt(e)>this.createData.numSteps||e!=this.step&&(this.step=e,this.draw(),$(window).scrollTop(0),"quiz"==this.type&&this.create.changeStep())}},{key:"drawThumb",value:function(){var e=this.create[this.type].thumb;if(e){var t=a.a.getImageUrl(e,"235");$(".thumb-controls").html('<button class="delete-thumb btn-sm red">Delete</button><button class="add-thumb btn-sm green">Change</button>'),$(".thumb-image").html('<img src="'.concat(t,'" width="130">'))}else{var n="phone"==this.page.device?"Add":"Add Thumbnail";$(".thumb-controls").html('<button class="add-thumb btn-sm green">'+n+"</button>"),$(".thumb-image").html('<div class="dummy-thumb"></div>')}}},{key:"draw",value:function(){for(var e in this.expandables){var t,n=A(this.expandables[e]);try{for(n.s();!(t=n.n()).done;)t.value.hide()}catch(e){n.e(e)}finally{n.f()}}var a,o=A(this.expandables[this.step]);try{for(o.s();!(a=o.n()).done;)a.value.show()}catch(e){o.e(e)}finally{o.f()}"1"==this.step?$("#btn-launch-collaborate").show():$("#btn-launch-collaborate").hide(),this.drawStep(),this.create.draw()}}])&&U(t.prototype,n),s&&U(t,s),e}()},,,,,,,,,,,,,,,,function(e,t,n){},,,,,function(e,t,n){"use strict";n.r(t);var a=n(9),o=n(2),r=n(0),i=n(3),s=n(1);function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var d=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.moderateBlog=function(e){var t=$(e.target).data("command");i.a.go({url:"/admin/api/moderation/new-blog.php",type:"GET",data:{blog:n.page.data.blogId,command:t},loading:"Moderating",callback:function(e){["deny","hide-user","ban-user"].includes(t)?window.location="/admin/moderate":window.location="/admin/update-blog?id="+n.page.data.blogId}})},this.logPageView=function(e){n.page.data.isPreview||i.a.go({url:"/api/blogs/log-blog-view.php",data:{id:n.page.data.blogId},loading:"DONOTLOAD",errCallback:function(){},callback:function(){}})},this.focusSearch=function(e){""==$("#txt-search-blogs").val().trim()?$("#blog-search-results").html('<i class="fa fa-spinner fa-spin fa-2x"></i>'):n.drawResults(),$("#blog-search-results").show()},this.blurSearch=function(e){""==$("#txt-search-blogs").val().trim()&&$("#blog-search-results").hide()},this.typeSearch=function(e){null==n.blogs?n.blogs=n.getBlogs(!0):n.drawResults()},this.toggleBlurb=function(e){var t=$(e.target).closest(".blog").data("id");$("#blog-"+t+" .blog-blurb").toggle(),$("#blog-"+t+" .blog-blurb").is(":visible")?$("#blog-"+t+" .blurb-dropdown i").removeClass("fa-chevron-down").addClass("fa-chevron-up"):$("#blog-"+t+" .blurb-dropdown i").removeClass("fa-chevron-up").addClass("fa-chevron-down")},this.clickImage=function(e){var t=$(e.target).closest(".popup-image").data("id"),a=n.images[t];null!=a&&n.page.showImageAttribution(n.page,a)},this.openReportModal=function(e){if(null!=n.page.user){var t="\n      <p>".concat(r.a.translate("Report insults, vulgar language, and spam. This is not a disagree button."),"</p>\n      <p>").concat(r.a.translate("Please choose a reason for your report:"),'\n      <p>\n        <select id="sel-blog-report">\n          <option value="inappropriate">').concat(r.a.translate("Inappropriate content"),'</option>\n          <option value="language">').concat(r.a.translate("Filed under incorrect language"),'</option>\n          <option value="copy">').concat(r.a.translate("Exact copy of another blog"),'</option>\n          <option value="spam">').concat(r.a.translate("Spam"),'</option>\n          <option value="username">').concat(r.a.translate("Inappropriate user name"),'</option>\n          <option value="other">').concat(r.a.translate("Other"),"</option>\n        </select>\n      </p>"),a='<button class="red" id="submit-blog-report">'.concat(r.a.translate("Submit Report"),"</button>");s.a.alert("Report Blog Post",t,null,{customFooter:a})}else n.page.showAskCreate()},this.submitBlogReport=function(){var e=$("#sel-blog-report").val();i.a.go({url:"/api/blogs/report-blog.php",data:{id:n.page.data.blogId,reason:e},loading:"Submitting report",callback:function(){s.a.close(),s.a.alert("Thank You","Your report has been submitted.")}})},this.deleteEntry=function(e){var t=$(e.target).data("id");s.a.choice("Delete Blog","<p>This blog will be <b>permanently</b> deleted.</p><p>Are you sure?</p>",["Yes","Cancel"],[function(){return n.deleteEntryEx(t)},null])},this.deleteEntryEx=function(e){i.a.go({url:"/api/blogs/delete-blog.php",data:{id:e},loading:"Deleting...",callback:function(){s.a.alert("Success","Blog deleted",(function(){return location.reload()}))}})},this.copyEntry=function(e){var t=$(e.target).data("id");i.a.go({url:"/api/blogs/copy-blog.php",data:{id:t},loading:"Copying...",callback:function(e){s.a.alert("Success","Blog copied",(function(){return window.open("/create-blog/"+e.id,"_self")}))}})},this.removeCollab=function(e){var t=$(e.target).closest("button").data("id");s.a.choice("Uncollaborate?","Are you sure you wish to remove yourself from this blog?",["Cancel","Yes"],[null,function(){return n.removeCollabEx(t)}])},this.removeCollabEx=function(e){i.a.go({url:"/api/create/collaborate-api.php",data:{json:JSON.stringify({id:e,command:"uncollab",quizorblog:1})},loading:"Uncollaborating...",callback:function(){s.a.alert("Success","You have removed yourself from this blog"),location.reload()}})},this.clickHeart=function(e){var t=n.page.user;if(null!=t){var a=n.page.data.blogId,r=n.page.data.isliked;if(t.uid!=n.page.data.blogOwner){if($(".blog-like i").removeClass("fa far"),r)n.page.data.isliked=!1,$(".blog-like i").addClass("far");else{var i,c=-1,u=l(o.a.getPointsLanguages());try{for(u.s();!(i=u.n()).done;){var d=i.value,h=t.pointsObj[d].level;h>c&&(c=h)}}catch(e){u.e(e)}finally{u.f()}if(c<5)return void s.a.alert("Sorry","<p>You must reach Level 5 to like blogs.</p><p>Take a few more quizzes!</p>");n.page.data.isliked=!0,$(".blog-like i").addClass("fa")}$.ajax({type:"POST",url:"/api/blogs/like-blog.php",data:{id:a},success:function(e){var t;try{t=JSON.parse(e)}catch(e){return}$(".heart-num").html("+"+parseInt(t.obj))}})}else s.a.alert("Can't Unlike","Don't like your own blog? Maybe you should make it private or delete it.")}else n.page.showAskCreate()},this.page=t,this.images=t.data.images||{},this.reportedId=-1,"user-blogs"==t.pageType&&this.getBlogs(!1),"blog-page"==t.pageType&&setTimeout(this.logPageView,2e4),$("body").on("click",".delete-blog-entry",this.deleteEntry),$("body").on("click",".copy-blog-entry",this.copyEntry),$("body").on("click",".report-blog-entry",this.openReportModal),$("body").on("click","#submit-blog-report",this.submitBlogReport),$("body").on("click",".popup-image",this.clickImage),$("body").on("click",".blurb-dropdown",this.toggleBlurb),$("body").on("click",".unshare",this.removeCollab),$("body").on("click",".blog-like",this.clickHeart),$("body").on("focus","#txt-search-blogs",this.focusSearch),$("body").on("blur","#txt-search-blogs",this.blurSearch),$("body").on("input","#txt-search-blogs",this.typeSearch),this.page.data.moderate&&o.a.isQuizmaster(this.page)&&$(".btn-mod-blog").on("click",this.moderateBlog)}var t,n,a;return t=e,(n=[{key:"filterBlogs",value:function(){var e,t=o.a.normalizeWords($("#txt-search-blogs").val()).split(" ").filter((function(e){return e.length>0})),n=new RegExp(t.map((function(e){return"(?=.*"+e+")"})).join(""),"gi"),a=[],r=l(this.blogs);try{for(r.s();!(e=r.n()).done;){var i=e.value,s=o.a.normalizeWords(i.title);n.test(s)&&a.push(i)}}catch(e){r.e(e)}finally{r.f()}return a}},{key:"drawResults",value:function(){if($("#txt-search-blogs").val().trim().length<3)$("#blog-search-results").html('<i class="fa fa-spinner fa-spin fa-2x"></i>');else{var e,t=[],n=l(this.filterBlogs());try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push("<a href='/users/"+a.userurl+"/blog/"+a.url+"'><div class='blog'>"+a.title+"</div></a>")}}catch(e){n.e(e)}finally{n.f()}0==t.length&&t.push("<div class='placeholder'>"+r.a.translate("No results found")+"</a>"),$("#blog-search-results").html(t.join("")),$("#blog-search-results").show()}}},{key:"getBlogs",value:function(e){var t=this;$.ajax({type:"POST",url:"/api/blogs/search-blogs.php",data:{language:this.page.language},success:function(n){var a;try{a=JSON.parse(n)}catch(e){return}t.blogs=a,e&&t.drawResults()}})}}])&&u(t.prototype,n),a&&u(t,a),e}(),h=n(7);function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var g=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.applyToAll=function(){var e=$("#heading-bold-".concat(a.componentId)).is(":checked"),t=parseInt($("#heading-size-".concat(a.componentId)).val()),n=$("#heading-color-".concat(a.componentId)).val(),o=Object.assign({},a.create.blog.components),r=[];for(var i in o)o[i].type==h.a.TYPE_HEADING&&r.push(Object.assign({},o[i]));for(var s=0,l=r;s<l.length;s++){var c=l[s],u=Object.assign({},c.textStyles);u.color="#"+n,u["font-size"]=t+"px",u["font-weight"]=e?"bold":"normal",c.textStyles=u,c.styles=Object.assign({},a.create.blog.components[a.componentId].styles),o[c.id]=c}a.create.action({components:o}),a.create.draw()},this.updateSlider=function(){var e=$("#heading-bold-".concat(a.componentId)).is(":checked"),t=parseInt($("#heading-size-".concat(a.componentId)).val());$("#size-value").html(t+"px");var n=a.create.blog.components[a.componentId],o=Object.assign({},n),r=Object.assign({},o.textStyles);r["font-size"]=t+"px",r["font-weight"]=e?"bold":"normal",o.textStyles=r;var i={};i.components=Object.assign({},a.create.blog.components),i.components[o.id]=o,a.create.action(i),a.create.draw()},this.colorChanged=function(e){var t=$(e.target).val(),n=a.create.blog.components[a.componentId],o=Object.assign({},n),r=Object.assign({},o.textStyles);r.color="#"+t,o.textStyles=r;var i={};i.components=Object.assign({},a.create.blog.components),i.components[o.id]=o,a.create.action(i),a.create.draw()},this.preventEnter=function(e){13==e.keyCode&&e.preventDefault()},this.focus=function(e){var t=$("#".concat(a.componentId," .txt-heading-component")).html();(t=o.a.stripTags(t).trim())==a.default&&($("#".concat(a.componentId," .txt-heading-component")).html(""),setTimeout(a.reselect,50))},this.reselect=function(e){var t=new Range,n=$("#".concat(a.componentId," .txt-heading-component"))[0];t.selectNode(n),t.setStart(n,0),t.setEnd(n,0),document.getSelection().removeAllRanges(),document.getSelection().addRange(t)},this.blur=function(e){var t=$("#".concat(a.componentId," .txt-heading-component")).html().trim(),n=a.create.blog.components[a.componentId];n.text==t||n.text==a.default&&""==t||a.typed(e),t!=a.default&&""!=t||$("#".concat(a.componentId," .txt-heading-component")).html("<span style='opacity:0.4'>"+a.default+"</span>")},this.typed=function(e){a.create.quicklinks.draw(a.create.blog.quicklinks,a.componentId,$("#".concat(a.componentId," .txt-heading-component")).html().trim());var t=a.create.blog.components[a.componentId],n=o.a.stripTags($("#".concat(a.componentId," .txt-heading-component")).html());if(n.length>200)return $("#".concat(a.componentId," .txt-heading-component")).html(t.text),void s.a.alert("Error","Headings have a maximum of 200 characters");if(null==e.originalEvent.data||h.a.ACTION_TRIGGERS.includes(e.originalEvent.data)){var r=Object.assign({},t);r.text=n;var i={};i.components=Object.assign({},a.create.blog.components),i.components[r.id]=r,t.text!=r.text&&r.text!=a.default&&a.create.action(i)}else a.create.state.setSavedDisplay(!1)},this.manager=t,this.create=t.create,this.page=t.create.page,this.componentId=n.id,this.default=h.a.DEFAULTS[n.type],this.draw(),0==n.splitState.level&&this.initEvents()}var t,n,a;return t=e,(n=[{key:"getOptions",value:function(){var e=this.create.blog.components[this.componentId],t="bold"==e.textStyles["font-weight"]?"checked":"";return'\n      <table>\n        <tr>\n          <td>Color:</td>\n          <td><input type="text" class="jscolor style-attribute" id="heading-color-'.concat(this.componentId,'" autocomplete="off" maxlength="6" value="').concat(e.textStyles.color.substr(1,7),'"></td>\n        </tr>\n        <tr>\n          <td>Font Size:</td>\n          <td><div class="flexbox">\n            <input type="range" class="slider" min="14" max="40" step="2" value="').concat(parseInt(e.textStyles["font-size"]),'" id="heading-size-').concat(this.componentId,'">\n            <div id="size-value">').concat(e.textStyles["font-size"],'</div>\n          </div></td>\n        </tr>\n        <tr>\n          <td>Is Bold:</td>\n          <td>\n            <input type="checkbox" ').concat(t,' id="heading-bold-').concat(this.componentId,'">\n          </td>\n        </tr>\n      </table>\n      <button class="blue" id="heading-apply-all-').concat(this.componentId,'">Apply to All Headings</button>\n    ')}},{key:"afterOptions",value:function(){var e=this.create.blog.components[this.componentId];$("#heading-color-".concat(this.componentId))[0].jscolor.fromString(e.textStyles.color),$("#heading-color-".concat(this.componentId)).on("change",this.colorChanged),$("#heading-size-".concat(this.componentId)).on("input",this.updateSlider),$("#heading-bold-".concat(this.componentId)).on("input",this.updateSlider),$("#heading-apply-all-".concat(this.componentId)).on("click",this.applyToAll)}},{key:"initEvents",value:function(){$("#".concat(this.componentId," .txt-heading-component")).on("input",this.typed),$("#".concat(this.componentId," .txt-heading-component")).on("focus",this.focus),$("#".concat(this.componentId," .txt-heading-component")).on("blur",this.blur),$("#".concat(this.componentId," .txt-heading-component")).on("keydown",this.preventEnter)}},{key:"draw",value:function(){var e=this.create.blog.components[this.componentId],t=this.manager.compileStyles(e.textStyles),n=e.text==this.default||""==e.text?"<span style='opacity:0.4'>"+this.default+"</span>":e.text,a='\n      <div contenteditable=true class="txt-heading-component" style="'.concat(t,'">').concat(n,"</div>\n    ");return this.manager.drawGenericComponent(e,a)}}])&&p(t.prototype,n),a&&p(t,a),e}();function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var f=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clickStyleBar=function(e){a.logRange(),a.hideStyles=!1;var t=$(e.target).closest(".icon");if(null!=t){var n=$(t).data("type");"link"==n?a.addLink():document.execCommand(n,!1,null),e.preventDefault()}},this.enterURL=function(){var e=o.a.stripTags($("#txt-url").val()),t=o.a.stripTags($("#txt-display").val());""==t&&(t=e);var n=$(a.linkComp)[0],r=n.data;null==r&&(r=n.textContent);var i=r.substr(0,a.linkOffset);null==n.data?n.textContent=i:n.data=i;var l=document.createElement("a");l.href=e,l.text=t,$(n).hasClass("txt-text-component")?$(n).append(l):$(n).after(l);var c=document.createElement(n.nodeName.replace("#",""));c.textContent=r.substr(a.linkOffset),$(l).after(c),a.typed({originalEvent:{data:null}}),s.a.close(),a.linkComp=null,a.linkOffset=null},this.focus=function(e){var t=$("#".concat(a.componentId," .txt-text-component")).html();(t=o.a.stripTags(t).trim())==a.default&&($("#".concat(a.componentId," .txt-text-component")).html(""),setTimeout((function(){return a.reselect(0,0)}),50)),$("#style-bar-".concat(a.componentId)).show(),setTimeout((function(){document.execCommand("formatBlock",!1,"p"),document.execCommand("insertBrOnReturn",!1,!1)}),1)},this.blur=function(e){var t=$("#".concat(a.componentId," .txt-text-component")).html().trim(),n=a.create.blog.components[a.componentId];n.text==t||n==a.default&&""==t||a.typed(e),t!=a.default&&""!=t||$("#".concat(a.componentId," .txt-text-component")).html("<span style='opacity:0.4'>"+a.default+"</span>"),a.hideStyles=!0,setTimeout((function(){a.hideStyles&&$("#style-bar-".concat(a.componentId)).hide()}),100)},this.typed=function(e){if(null==e.originalEvent.data||h.a.ACTION_TRIGGERS.includes(e.originalEvent.data)){var t=a.create.blog.components[a.componentId],n=$("#".concat(a.componentId," .txt-text-component")).html(),r=Object.assign({},t);r.text=n,""==o.a.stripTags(n)&&(r.text="");var i={};i.components=Object.assign({},a.create.blog.components),i.components[r.id]=r,t.text!=r.text&&r.text!=a.default&&a.create.action(i)}else a.create.state.setSavedDisplay(!1)},this.manager=t,this.create=t.create,this.page=t.create.page,this.componentId=n.id,this.default=h.a.DEFAULTS[n.type],this.draw(),0==n.splitState.level&&this.initEvents()}var t,n,a;return t=e,(n=[{key:"getOptions",value:function(){return""}},{key:"afterOptions",value:function(){}},{key:"initEvents",value:function(){$("#".concat(this.componentId," .txt-text-component")).on("input",this.typed),$("#".concat(this.componentId," .txt-text-component")).on("focus",this.focus),$("#".concat(this.componentId," .txt-text-component")).on("blur",this.blur),$("#style-bar-".concat(this.componentId)).on("mousedown",this.clickStyleBar)}},{key:"addLink",value:function(){null!=this.linkComp&&(s.a.alert("Add Hyperlink","\n        <p>Add a link to your text. If you have a region selected, the link will be inserted at the start. Enter the URL and text display text.</p>\n        <p><input type='text' id='txt-url' class=\"wide\" placeholder=\"Enter URL...\"></p>\n        <input type='text' id='txt-display' placeholder=\"Text to display\">\n      ",null,{customFooter:"<button class='blue' id='btn-add-url'>Add</button>"}),$("#btn-add-url").on("click",this.enterURL))}},{key:"reselect",value:function(e,t){e=new Range;var n=$("#".concat(this.componentId," .txt-text-component"))[0];e.selectNode(n),e.setStart(n,e),e.setEnd(n,t),document.getSelection().removeAllRanges(),document.getSelection().addRange(e)}},{key:"logRange",value:function(){var e=document.getSelection().rangeCount>0?document.getSelection().getRangeAt($("#".concat(this.componentId," .txt-text-component"))[0]):null;null!=e&&(this.linkComp=e.startContainer,this.linkOffset=e.startOffset)}},{key:"draw",value:function(){this.isSetup=!1;var e=this.create.blog.components[this.componentId],t=e.text==this.default||""==e.text?"<span style='opacity:0.5'>"+this.default+"</span>":e.text,n='\n      <div class="style-bar" id="style-bar-'.concat(this.componentId,'" style="display:none">\n        <div class="icon" unselectable="on" data-type="bold" id="bold-').concat(this.componentId,'" title="Bold"><b>B</b></div>\n        <div class="icon" unselectable="on" data-type="italic" id="italic-').concat(this.componentId,'" title="Italics"><i>i</i></div>\n        <div class="icon" unselectable="on" data-type="underline" id="underline-').concat(this.componentId,'" title="Underline"><u>u</u></div>\n        <div class="icon" unselectable="on" data-type="strikethrough" id="strike-').concat(this.componentId,'" title="Strikethrough"><s>S</s></div>\n        <div class="icon" unselectable="on" data-type="superscript" id="super-').concat(this.componentId,'" title="Superscript">x<small><sup>2</sup></small></div>\n        <div class="icon" unselectable="on" data-type="subscript"  id="sub-').concat(this.componentId,'" title="Subscript">x<small><sub>2</sub></small></div>\n        <div class="icon" unselectable="on" data-type="link" id="link-').concat(this.componentId,'" title="Website Link"><i class="fas fa-link"></i></div>\n      </div>\n      <div contenteditable=true class="txt-text-component">').concat(t,"</div>\n    ");return this.manager.drawGenericComponent(e,n)}}])&&m(t.prototype,n),a&&m(t,a),e}();function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var b=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.applyToAll=function(){var e=$("#image-border-".concat(a.componentId)).is(":checked"),t=parseInt($("#image-size-".concat(a.componentId)).val()),n=$("#image-color-".concat(a.componentId)).val(),o=$("#image-border-color-".concat(a.componentId)).val(),r=parseInt($("#image-border-size-".concat(a.componentId)).val()),i=$("#image-italics-".concat(a.componentId)).is(":checked"),s=Object.assign({},a.create.blog.components),l=[];for(var c in s)s[c].type==h.a.TYPE_IMAGE&&l.push(Object.assign({},s[c]));for(var u=0,d=l;u<d.length;u++){var p=d[u];p.imageBorder=e?1:0,p.borderColor="#"+o,p.borderSize=r,p.captionColor="#"+n,p.captionSize=t+"px",p.captionItalics=i?"italic":"normal",p.styles=Object.assign({},a.create.blog.components[a.componentId].styles),s[p.id]=p}a.create.action({components:s}),a.create.draw()},this.updateStyles=function(){var e=$("#image-border-".concat(a.componentId)).is(":checked"),t=parseInt($("#image-size-".concat(a.componentId)).val()),n=parseInt($("#image-border-size-".concat(a.componentId)).val()),o=$("#image-italics-".concat(a.componentId)).is(":checked");$("#size-value").html(t+"px");var r=a.create.blog.components[a.componentId],i=Object.assign({},r);i.imageBorder=e?1:0,i.borderSize=n,i.captionSize=t+"px",i.captionItalics=o?"italic":"normal";var s={};s.components=Object.assign({},a.create.blog.components),s.components[i.id]=i,a.create.action(s),a.create.draw()},this.colorChanged=function(e){var t=$(e.target).val(),n=a.create.blog.components[a.componentId],o=Object.assign({},n);o.captionColor="#"+t;var r={};r.components=Object.assign({},a.create.blog.components),r.components[o.id]=o,a.create.action(r),a.create.draw()},this.borderColorChanged=function(e){var t=$(e.target).val(),n=a.create.blog.components[a.componentId],o=Object.assign({},n);o.borderColor="#"+t;var r={};r.components=Object.assign({},a.create.blog.components),r.components[o.id]=o,a.create.action(r),a.create.draw()},this.removeImage=function(){var e=a.create.blog.components[a.componentId],t=Object.assign({},e);t.image=null;var n={};n.components=Object.assign({},a.create.blog.components),n.components[t.id]=t,a.create.action(n),a.create.draw()},this.choosePhoto=function(){var e=$(window).scrollTop();a.create.state.photoLibrary.show((function(t){return a.setImage(t,e)}))},this.setImage=function(e,t){if(null!==e){var n=a.create.blog.components[a.componentId],o=!0;if(n.image&&n.image.fn==e.fn&&(o=!1),o){var r=Object.assign({},n);r.image=e;var i={};i.components=Object.assign({},a.create.blog.components),i.components[r.id]=r,a.create.action(i),a.create.state.photoLibrary.showPane(".blog-pane"),a.create.draw()}}a.create.state.photoLibrary.showPane(".blog-pane"),window.scrollTo(0,t)},this.focus=function(e){var t=$("#".concat(a.componentId," .txt-image-caption")).html();(t=o.a.stripTags(t).trim())==a.default&&($("#".concat(a.componentId," .txt-image-caption")).html(""),setTimeout(a.reselect,50))},this.reselect=function(e){var t=new Range,n=$("#".concat(a.componentId," .txt-image-caption"))[0];t.selectNode(n),t.setStart(n,0),t.setEnd(n,0),document.getSelection().removeAllRanges(),document.getSelection().addRange(t)},this.blur=function(e){var t=$("#".concat(a.componentId," .txt-image-caption")).html().trim(),n=a.create.blog.components[a.componentId];n.text==t||n.text==a.default&&""==t||a.typed(e),t!=a.default&&""!=t||$("#".concat(a.componentId," .txt-image-caption")).html("<span style='opacity:0.5'>"+a.default+"</span>")},this.typed=function(e){if(null==e.originalEvent.data||h.a.ACTION_TRIGGERS.includes(e.originalEvent.data)){var t=$("#".concat(a.componentId," .txt-image-caption")).html().trim(),n=o.a.stripTags(t).trim(),r=a.create.blog.components[a.componentId],i=Object.assign({},r);i.caption=n;var s={};s.components=Object.assign({},a.create.blog.components),s.components[i.id]=i,r.caption!=i.caption&&i.text!=a.default&&a.create.action(s),i.caption!=t&&$("#".concat(a.componentId," .txt-image-caption")).html(i.caption)}else a.create.state.setSavedDisplay(!1)},this.manager=t,this.create=t.create,this.page=t.create.page,this.componentId=n.id,this.default=h.a.DEFAULTS[n.type],this.draw(),0==n.splitState.level&&this.initEvents()}var t,n,a;return t=e,(n=[{key:"getOptions",value:function(){var e=this.create.blog.components[this.componentId],t=1==e.imageBorder?"checked":"",n="italic"==e.captionItalics?"checked":"";return'\n      <table>\n        <tr>\n          <td>Image Border</td>\n          <td>\n            <input type="checkbox" '.concat(t,' id="image-border-').concat(this.componentId,'">\n          </td>\n          <td>Color:</td>\n          <td><input type="text" class="jscolor style-attribute" id="image-border-color-').concat(this.componentId,'" autocomplete="off" maxlength="6" value="').concat(e.borderColor.substr(1,7),'"></td>\n          <td>Size:</td>\n          <td><input type="number" class="spinner" min="1" max="5" step="1" value="').concat(parseInt(e.borderSize),'" id="image-border-size-').concat(this.componentId,'"></td>\n        </tr>\n      </table>\n      <b>Caption</b>\n      <table>\n        <tr>\n          <td>Color:</td>\n          <td><input type="text" class="jscolor style-attribute" id="image-color-').concat(this.componentId,'" autocomplete="off" maxlength="6" value="').concat(e.captionColor.substr(1,7),'"></td>\n          <td>Size:</td>\n          <td><div class="flexbox">\n            <input type="range" class="slider" min="10" max="16" step="1" value="').concat(parseInt(e.captionSize),'" id="image-size-').concat(this.componentId,'">\n            <div id="size-value">').concat(e.captionSize,'</div>\n          </div></td>\n        </tr>\n        <tr>\n          <td>Is Italics?</td>\n          <td>\n            <input type="checkbox" ').concat(n,' id="image-italics-').concat(this.componentId,'">\n          </td>\n        </tr>\n      </table>\n      <button class="blue" id="image-apply-all-').concat(this.componentId,'">Apply to All Images</button>\n    ')}},{key:"afterOptions",value:function(){var e=this.create.blog.components[this.componentId];$("#image-color-".concat(this.componentId))[0].jscolor.fromString(e.captionColor),$("#image-border-color-".concat(this.componentId))[0].jscolor.fromString(e.borderColor),$("#image-color-".concat(this.componentId)).on("change",this.colorChanged),$("#image-border-color-".concat(this.componentId)).on("change",this.borderColorChanged),$("#image-border-".concat(this.componentId)).on("input",this.updateStyles),$("#image-border-size-".concat(this.componentId)).on("input",this.updateStyles),$("#image-size-".concat(this.componentId)).on("input",this.updateStyles),$("#image-italics-".concat(this.componentId)).on("input",this.updateStyles),$("#image-apply-all-".concat(this.componentId)).on("click",this.applyToAll)}},{key:"initEvents",value:function(){var e=this;$("#".concat(this.componentId," .txt-image-caption")).on("input",this.typed),$("#".concat(this.componentId," .txt-image-caption")).on("focus",this.focus),$("#".concat(this.componentId," .txt-image-caption")).on("blur",this.blur),$("#".concat(this.componentId)).on("click",".btn-choose-photo",this.choosePhoto),$("#".concat(this.componentId)).on("click",".btn-close-image",(function(){return setTimeout(e.removeImage,10)}))}},{key:"draw",value:function(){var e,t,n,a=this.create.blog.components[this.componentId],r=a.image;if(r){var i=o.a.getImageUrl(r,"450");n="",e="<img src='".concat(i,"' border=").concat(a.imageBorder*a.borderSize,' style="border-color:').concat(a.borderColor,'">'),t='<button class="btn-choose-photo btn-sm" tabindex="-1">Change</button> <button class="btn-close-image red btn-sm" tabindex="-1">X</button>'}else n=" dummy-image",e="",t='<button class="btn-choose-photo green btn-sm" tabindex="-1">Add</button>';var s=a.caption==this.default||""==a.caption.trim()?"<span style='opacity:0.5'>"+this.default+"</span>":a.caption,l='\n      <div class="image-content align-'.concat(a.styles["text-align"],'">\n        <div class="image-container').concat(n,'">\n          ').concat(e,'\n          <div class="image-buttons">\n            ').concat(t,'\n          </div>\n        </div>\n        <div class="txt-image-caption" contenteditable=true style=\'\n          color:').concat(a.captionColor,";\n          font-size:").concat(a.captionSize,";\n          font-style:").concat(a.captionItalics,";\n        '>\n          ").concat(s,"\n        </div>\n      </div>\n    ");return this.manager.drawGenericComponent(a,l)}}])&&v(t.prototype,n),a&&v(t,a),e}();function y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var w=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.applyToAll=function(){var e=parseInt($("#divider-thickness-".concat(a.componentId)).val()),t=parseInt($("#divider-width-".concat(a.componentId)).val()),n=$("#divider-color-".concat(a.componentId)).val(),o=Object.assign({},a.create.blog.components),r=[];for(var i in o)o[i].type==h.a.TYPE_DIVIDER&&r.push(Object.assign({},o[i]));for(var s=0,l=r;s<l.length;s++){var c=l[s];c.thickness=e,c.width=t,c.color=n,c.styles=Object.assign({},a.create.blog.components[a.componentId].styles),o[c.id]=c}a.create.action({components:o}),a.create.draw()},this.updateSlider=function(){var e=parseInt($("#divider-thickness-".concat(a.componentId)).val()),t=parseInt($("#divider-width-".concat(a.componentId)).val());$("#thickness-value").html(e+"px"),$("#width-value").html(t+"%");var n=a.create.blog.components[a.componentId],o=Object.assign({},n);o.thickness=e,o.width=t;var r={};r.components=Object.assign({},a.create.blog.components),r.components[o.id]=o,a.create.action(r),a.create.draw()},this.colorChanged=function(e){var t=$(e.target).val(),n=a.create.blog.components[a.componentId],o=Object.assign({},n);o.color=t;var r={};r.components=Object.assign({},a.create.blog.components),r.components[o.id]=o,a.create.action(r),a.create.draw()},this.manager=t,this.create=t.create,this.page=t.create.page,this.componentId=n.id,this.draw(),0==n.splitState.level&&this.initEvents()}var t,n,a;return t=e,(n=[{key:"getOptions",value:function(){var e=this.create.blog.components[this.componentId];return'\n      <table>\n        <tr>\n          <td>Color:</td>\n          <td><input type="text" class="jscolor style-attribute" id="divider-color-'.concat(this.componentId,'" autocomplete="off" maxlength="6" value="').concat(e.color,'"></td>\n        </tr>\n        <tr>\n          <td>Thickness:</td>\n          <td><div class="flexbox">\n            <input type="range" class="thickness slider" min="1" max="5" step="1" value="').concat(e.thickness,'" id="divider-thickness-').concat(this.componentId,'">\n            <div id="thickness-value">').concat(e.thickness,'px</div>\n          </div></td>\n        </tr>\n        <tr>\n          <td>Width:</td>\n          <td><div class="flexbox">\n            <input type="range" class="width slider" min="25" max="100" step="5" value="').concat(e.width,'" id="divider-width-').concat(this.componentId,'">\n            <div id="width-value">').concat(e.width,'%</div>\n          </div></td>\n        </tr>\n      </table>\n      <button class="blue" id="divider-apply-all-').concat(this.componentId,'">Apply to All Dividers</button>\n    ')}},{key:"afterOptions",value:function(){var e=this.create.blog.components[this.componentId];$("#divider-color-".concat(this.componentId))[0].jscolor.fromString(e.color),$("#divider-color-".concat(this.componentId)).on("change",this.colorChanged),$("#divider-thickness-".concat(this.componentId)).on("input",this.updateSlider),$("#divider-width-".concat(this.componentId)).on("input",this.updateSlider),$("#divider-apply-all-".concat(this.componentId)).on("click",this.applyToAll)}},{key:"initEvents",value:function(){}},{key:"draw",value:function(){var e=this.create.blog.components[this.componentId],t='\n      <div class="hr align-'.concat(e.styles["text-align"],'" style="\n        border-color:#').concat(e.color,";\n        border-width:").concat(e.thickness,"px;\n        width:").concat(e.width,'%;\n        "></div>\n    ');return this.manager.drawGenericComponent(this.create.blog.components[this.componentId],t)}}])&&y(t.prototype,n),a&&y(t,a),e}();function k(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e}var x=function(){function e(t,n){var a=this;S(this,e),this.mapOption1=function(e){var t=a.create.blog.components[a.componentId],n=e.level>0?"split":e.idx,r="";switch(e.level){case 3:r+="&nbsp;&nbsp;&nbsp;";case 2:r+="&nbsp;&nbsp;&nbsp;";case 1:r+="&nbsp;&nbsp;&nbsp;"}var i=t.c1==e.id?"selected":"",s=t.id==e.id?"disabled":"";return"<option value='".concat(e.id,"' ").concat(i).concat(s,">").concat(r).concat(o.a.capFirstLetter(e.type)," (").concat(n,")</option>")},this.mapOption2=function(e){var t=a.create.blog.components[a.componentId],n=e.level>0?"split":e.idx,r="";switch(e.level){case 3:r+="&nbsp;&nbsp;&nbsp;";case 2:r+="&nbsp;&nbsp;&nbsp;";case 1:r+="&nbsp;&nbsp;&nbsp;"}var i=t.c2==e.id?"selected":"",s=t.id==e.id?"disabled":"";return"<option value='".concat(e.id,"' ").concat(i).concat(s,">").concat(r).concat(o.a.capFirstLetter(e.type)," (").concat(n,")</option>")},this.updateSlider=function(){var e=parseInt($("#c1size-".concat(a.componentId)).val())-1;$("#size-value").html(e+1+"%");var t=a.create.blog.components[a.componentId],n=Object.assign({},t);e>84&&(e=84),e<14&&(e=14),n.c1size=e;var o={};o.components=Object.assign({},a.create.blog.components),o.components[n.id]=n,a.create.action(o),a.create.draw()},this.resetWidth=function(){var e=a.create.blog.components[a.componentId],t=Object.assign({},e);t.c1size=49,$("#size-value").html("50%"),$("#c1size-".concat(a.componentId)).val(50);var n={};n.components=Object.assign({},a.create.blog.components),n.components[t.id]=t,a.create.action(n),a.create.draw()},this.changeDir=function(){var e=$("#split-sel-dir-".concat(a.componentId)).val(),t=a.create.blog.components[a.componentId],n=Object.assign({},t);n.direction=e;var o={};o.components=Object.assign({},a.create.blog.components),o.components[n.id]=n,a.create.action(o),a.create.draw(),$("#split-reset-".concat(a.componentId)).prop("disabled","h"==n.direction),$("#c1size-".concat(a.componentId)).prop("disabled","h"==n.direction)},this.dropC1=function(){var e=a.create.blog.components[a.componentId];if(null!=e.c1){$("#create-blog-content").append("<div class='component fake' id='fake' data-id='fake'></div>"),a.manager.dragId=e.c1,a.manager.dragType=null;var t=new C($("#create-blog-content #fake")[0]);a.manager.doDrop(t)}var n=$("#split-sel-c1-".concat(a.componentId)).val();if(null!=n){a.manager.dragId=n,a.manager.dragType=null;t=new C($("#".concat(a.componentId," .c1-container"))[0]);a.manager.doDrop(t)}},this.dropC2=function(){var e=a.create.blog.components[a.componentId];if(null!=e.c2){$("#create-blog-content").append("<div class='component fake' id='fake' data-id='fake'></div>"),a.manager.dragId=e.c2,a.manager.dragType=null;var t=new C($("#create-blog-content #fake")[0]);a.manager.doDrop(t)}var n=$("#split-sel-c2-".concat(a.componentId)).val();if(null!=n){a.manager.dragId=n,a.manager.dragType=null;t=new C($("#".concat(a.componentId," .c2-container"))[0]);a.manager.doDrop(t)}},this.drag=function(e){if(null!=a.dragPos&&null!=a.size&&null!=a.offset){var t=Object.assign({},a.create.blog.components[a.componentId]),n="v"==t.direction?e.pageX:e.pageY,o=n-a.offset,r=Math.round(o/a.size*100);if(r!=t.c1size){r>84&&(r=84),r<14&&(r=14),t.c1size=r;var i=Object.assign({},a.create.blog.components);i[t.id]=t,a.create.action({components:i}),"v"==t.direction&&($("#".concat(a.componentId,">div>.split-container>.c1-container")).css("width",r+"%"),$("#".concat(a.componentId,">div>.split-container>.c2-container")).css("width",98-r+"%")),a.dragPos=n}}},this.manager=t,this.create=t.create,this.page=t.create.page,this.componentId=n.id,this.dragPos=null,this.size=null,this.offset=null,this.draw(),0==n.splitState.level&&this.initEvents()}return E(e,[{key:"addChildren",value:function(e,t){if(null!=t.c1){var n=this.create.blog.components[t.c1];e.push({id:n.id,type:n.type,level:n.splitState.level}),n.type==h.a.TYPE_SPLIT&&n.splitState.level<=2&&this.addChildren(e,n)}if(null!=t.c2){var a=this.create.blog.components[t.c2];e.push({id:a.id,type:a.type,level:a.splitState.level}),a.type==h.a.TYPE_SPLIT&&a.splitState.level<=2&&this.addChildren(e,a)}}},{key:"getOptions",value:function(){var e,t=this.create.blog.components[this.componentId],n="v"==t.direction?"":"selected",a="v"==t.direction?"selected":"",o=[],r=k(this.create.blog.componentOrder);try{for(r.s();!(e=r.n()).done;){var i=e.value,s=this.create.blog.components[i];o.push({id:s.id,type:s.type,level:s.splitState.level,idx:this.create.blog.componentOrder.indexOf(i)+1}),s.type==h.a.TYPE_SPLIT&&this.addChildren(o,s)}}catch(e){r.e(e)}finally{r.f()}var l=o.map(this.mapOption1),c=o.map(this.mapOption2);return'\n      <table>\n        <tr>\n          <td>Direction</td>\n          <td>\n            <select id="split-sel-dir-'.concat(this.componentId,'">\n              <option value="v" ').concat(a,'>Vertical</option>\n              <option value="h" ').concat(n,'>Horizontal</option>\n            </select>\n          </td>\n        </tr>\n        <tr><td colspan=2 style="height: 30px;line-height: 1.3em"><small>On Desktop you can drag and drop components, for mobile these compaitibility options are here:</small></td></tr>\n        <tr>\n          <td>Position:</td>\n          <td><div class="flexbox">\n            <input type="range" class="slider" min="15" max="85" step="1" value="').concat(t.c1size+1,'" id="c1size-').concat(this.componentId,'">\n            <div id="size-value">').concat(t.c1size+1,'%</div>\n          </div></td>\n        </tr>\n        <tr>\n          <td>Component 1:</td>\n          <td>\n            <select id="split-sel-c1-').concat(this.componentId,"\">\n              <option value='null'>None</option>\n              ").concat(l.join(""),'\n            </select>\n          </td>\n        </tr>\n        <tr>\n          <td>Component 2:</td>\n          <td>\n            <select id="split-sel-c2-').concat(this.componentId,"\">\n              <option value='null'>None</option>\n              ").concat(c.join(""),'\n            </select>\n          </td>\n        </tr>\n      </table>\n      <button class="green" id="split-reset-').concat(this.componentId,'">Reset to Middle</button>\n    ')}},{key:"afterOptions",value:function(){var e=this.create.blog.components[this.componentId];$("#split-sel-dir-".concat(this.componentId)).on("change",this.changeDir),$("#split-reset-".concat(this.componentId)).on("click",this.resetWidth),$("#split-reset-".concat(this.componentId)).prop("disabled","h"==e.direction),$("#c1size-".concat(this.componentId)).on("input",this.updateSlider),$("#c1size-".concat(this.componentId)).prop("disabled","h"==e.direction),$("#split-sel-c1-".concat(this.componentId)).on("change",this.dropC1),$("#split-sel-c2-".concat(this.componentId)).on("change",this.dropC2)}},{key:"setDraggable",value:function(e,t){t?"v"==this.create.blog.components[this.componentId].direction?(this.dragPos=e.pageX,this.size=$("#".concat(this.componentId,">div>.split-container")).width(),this.offset=$("#".concat(this.componentId,">div>.split-container")).offset().left):(this.dragPos=null,this.size=null,this.offset=null):(this.dragPos=null,this.size=null,this.offset=null)}},{key:"initEvents",value:function(){var e=this,t=this.create.blog.components[this.componentId];t.c1&&this.manager.components[t.c1].initEvents(),t.c2&&this.manager.components[t.c2].initEvents(),$("#".concat(this.componentId,">div>.split-container>.split-divider")).on("mousedown",(function(t){return e.setDraggable(t,!0)})),$("#".concat(this.componentId)).on("mouseup",(function(t){return e.setDraggable(t,!1)})),$("#".concat(this.componentId)).on("mousemove",this.drag),"h"==t.direction&&(t.c1size=49)}},{key:"draw",value:function(){var e,t,n=this.create.blog.components[this.componentId],a=n.c1?this.manager.createBlogComponent(this.create.blog.components[n.c1]).draw():"<div class='dummy-comp'></div>",o=n.c2?this.manager.createBlogComponent(this.create.blog.components[n.c2]).draw():"<div class='dummy-comp'></div>";"v"==n.direction?(e="width:".concat(n.c1size,"%;"),t="width:".concat(98-n.c1size,"%;")):(e="height:".concat(n.c1size,"%;"),t="height:".concat(98-n.c1size,"%;"));var r="v"==n.direction?"-vertical":"",i='\n      <div class="split-container dir-'.concat(n.direction,'">\n        <div class="c1-container split-droppable" style="').concat(e,'">\n          ').concat(a,'\n        </div>\n        <div class="split-divider">\n          <div class="grabber"><i class="fas fa-grip-lines').concat(r,'"></i></div>\n        </div>\n        <div class="c2-container split-droppable" style="').concat(t,'">\n          ').concat(o,"\n        </div>\n      </div>\n    ");return this.manager.drawGenericComponent(n,i)}}]),e}(),C=function(){function e(t){S(this,e),this.target=t}return E(e,[{key:"preventDefault",value:function(){}}]),e}();function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var A=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.blur=function(e){var t=$("#".concat(a.componentId," .txt-html-component")).html().trim();a.create.blog.components[a.componentId].text!=t&&a.typed(e)},this.typed=function(e){if(null==e.originalEvent.data||h.a.ACTION_TRIGGERS.includes(e.originalEvent.data)){var t=e.target.value,n=Object.assign({},a.create.blog.components[a.componentId]),o=n.html;n.html=t;var r={};r.components=Object.assign({},a.create.blog.components),r.components[n.id]=n,o!=n.html&&a.create.action(r)}else a.create.state.setSavedDisplay(!1)},this.manager=t,this.create=t.create,this.page=t.create.page,this.componentId=n.id,this.draw(),0==n.splitState.level&&this.initEvents()}var t,n,a;return t=e,(n=[{key:"getOptions",value:function(){return""}},{key:"afterOptions",value:function(){}},{key:"initEvents",value:function(){$("#".concat(this.componentId," .txt-html-component")).on("blur",this.blur),$("#".concat(this.componentId," .txt-html-component")).on("input",this.typed)}},{key:"draw",value:function(){var e=this.create.blog.components[this.componentId],t='\n      <textarea class="txt-html-component" maxlength="30000">'.concat(e.html,"</textarea>\n    ");return this.manager.drawGenericComponent(e,t)}}])&&O(t.prototype,n),a&&O(t,a),e}();function P(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var j=function(){function e(t){var n,a,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.copyComponent=function(e){var t=$(e.target).data("id"),n={},a=Object.assign({},o.create.blog.components),r=Object.assign([],o.create.blog.componentOrder);n.components=a,n.componentOrder=r;var i=o.copyIndividual(n,t,0,""),l=r.indexOf(t);-1!=l?r.splice(l+1,0,i):r.push(i),o.create.action(n),o.create.draw(),s.a.close()},this.removeComponent=function(e){s.a.close(),s.a.loading("Deleting Component");var t=$(e.target).data("id"),n={},a=Object.assign({},o.create.blog.components),r=Object.assign([],o.create.blog.componentOrder);n.components=a,n.componentOrder=r,n=o.removeComponentEx(t,n),o.create.action(n),o.create.draw(),s.a.close()},this.componentOptions=function(e){var t=$(e.target).closest(".component").data("id"),n=o.create.blog.components[t],a=o.names[n.type],r=n.splitState.level>0?n.splitState.isc1?"Left":"Right":o.create.blog.componentOrder.indexOf(t)+1,i=o.getMargins(t,n);n.splitState.level>0&&(i="");var l=o.getShiftBox(t),c='\n      <div class="flexbox">\n        <div class="left">\n          <table class="info-table"><tr>\n            <td>ID: <small><b>'.concat(t,"</b></small></td>\n            <td>Type: <b>").concat(a,"</b></td>\n            <td>Position: <b>").concat(r,"</b></td>\n          </tr>\n          </table>\n          ").concat(i,'\n          <button class="green btn-copy-component" data-id="').concat(t,'">Duplicate</button>\n          <button class="red btn-remove-component" data-id="').concat(t,'">Remove</button>\n        </div>\n        ').concat(l,'\n      </div>\n      <hr>\n      <div class="component-options">\n        ').concat(o.components[t].getOptions(),"\n      </div>\n    ");s.a.alert("Component Options",c,null,{hideFooter:!0,customClass:"component-modal"}),jscolor.installByClassName("jscolor"),o.components[t].afterOptions(),$("#style-margin-top").on("input",o.styleChanged),$("#style-margin-bottom").on("input",o.styleChanged),$("#style-text-align").on("change",o.styleChanged),$("#styles-apply-all").on("click",o.applyToAll),o.toggleShiftbuttons()},this.applyToAll=function(e){var t=$(e.target).data("id"),n=o.create.blog.components[t].styles,a=Object.assign({},o.create.blog.components);for(var r in a){var i=h.a.createBlogComponent(a[r]);i.styles=Object.assign({},n),a[i.id]=i}o.create.action({components:a}),o.create.draw()},this.styleChanged=function(e){var t=$(e.target).val(),n=$(e.target).data("id"),a=$(e.target).data("style"),r=o.create.blog.components[n],i=h.a.createBlogComponent(r);i.styles[a]=isNaN(t)?t:t+"px";var s={};s.components=Object.assign({},o.create.blog.components),s.components[i.id]=i,o.create.action(s),o.create.draw()},this.clickInfo=function(e){var t=$(e.target).closest(".comp-row").data("type");s.a.alert("Component Info",o.infos[t])},this.appendNewComp=function(e){var t=$(e.target).closest(".component"),n=$(t).data("type"),a=$(e.target).closest(".info");if(!(null==n||a.length>0)){var r=o.create.blog,i=h.a.createBlogComponent({type:n}),s=Object.assign({},r.components),l=Object.assign([],r.componentOrder),c=i.id;s[c]=i,l.push(c),o.create.action({components:s,componentOrder:l}),o.create.draw()}},this.setDraggable=function(e,t){$(e.target).closest(".component").attr("draggable",t)},this.startDrag=function(e){e.originalEvent.dataTransfer.setData("text",e.target.id);var t=$(e.target).closest(".component");o.dragId=$(t).data("id"),o.dragType=$(t).data("type"),$(t).addClass("drag-row"),$("#create-blog-content .component.fake").remove(),o.create.blog.componentOrder.length>0&&$("#create-blog-content").append("<div class='component fake' id='fake' data-id='fake'></div>")},this.dragOver=function(e){e.preventDefault();var t,n=$(e.target).closest(".split-droppable");t=null!=n&&n.length>0?n:$(e.target).closest(".component,.placeholder"),$(".drag-over").removeClass("drag-over"),$(t).addClass("drag-over")},this.dragLeave=function(e){$(".drag-over").removeClass("drag-over")},this.dragEnd=function(e){$(".drag-over").removeClass("drag-over"),$(".drag-row").removeClass("drag-row"),$(".component").attr("draggable",!1),$("#create-blog-content .component.fake").remove()},this.create=t,this.components=[],this.infos=(U(n={},h.a.TYPE_HEADING,"Headings are a good way to split your blog into sections. They are also used to create the quick links box if desired."),U(n,h.a.TYPE_TEXT,"A plain text box that you can type and edit the styles of directly. This will show on the blog almost exactly as it appears in the editor."),U(n,h.a.TYPE_IMAGE,"An image component allowing you to select a picture and add a caption to it as well"),U(n,h.a.TYPE_DIVIDER,"This horizontal divider line can be useful to distinguish between distinct sections of a blog."),U(n,h.a.TYPE_SPLIT,"This split view allows you to place two blog components next to each other horizontally or vertically."),U(n,h.a.TYPE_HTML,"<b>ADVANCED</b>. This allows pure html to be written, with limitations, for those who want a more customised look to their blog."),n),this.names=(U(a={},h.a.TYPE_HEADING,"Heading"),U(a,h.a.TYPE_TEXT,"Text"),U(a,h.a.TYPE_IMAGE,"Image"),U(a,h.a.TYPE_DIVIDER,"Divider"),U(a,h.a.TYPE_SPLIT,"Split View"),U(a,h.a.TYPE_HTML,"HTML"),a),$(".components-table").on("click",".info",this.clickInfo),this.initDragDrog(),$("#create-blog-content").on("click",".component .dragger",this.componentOptions),$(".create-blog-page").on("click",".btn-remove-component",this.removeComponent),$(".create-blog-page").on("click",".btn-copy-component",this.copyComponent),$(".create-blog-page").on("click",".btn-shift-up",(function(e){return o.shiftComp(e,1)})),$(".create-blog-page").on("click",".btn-shift-down",(function(e){return o.shiftComp(e,-1)}))}var t,n,a;return t=e,(n=[{key:"shiftComp",value:function(e,t){var n=$(e.target).closest("button").data("id"),a=Object.assign([],this.create.blog.componentOrder),o=a.indexOf(n);0!=o||1!=t?o!=a.length-1||-1!=t?(-1!=o&&a.splice(o,1),a.splice(o-t,0,n),this.create.action({componentOrder:a}),this.create.draw(),this.toggleShiftbuttons(),s.a.close(),this.componentOptions({target:$("#".concat(n))[0]})):s.a.alert("Error","This component is already at the bottom!"):s.a.alert("Error","This component is already at the top!")}},{key:"copyIndividual",value:function(e,t,n,a){var o=Object.assign({},e.components[t]);delete o.id,(o=h.a.createBlogComponent(o)).splitState.level=n,o.splitState.id=a;var r=o.id;return e.components[r]=o,o.type==h.a.TYPE_SPLIT&&(null!=o.c1&&(o.c1=this.copyIndividual(e,o.c1,n+1,r)),null!=o.c2&&(o.c2=this.copyIndividual(e,o.c2,n+1,r))),r}},{key:"removeComponentEx",value:function(e,t){var n=t.components,a=t.componentOrder;-1!=a.indexOf(e)&&a.splice(a.indexOf(e),1);var o=n[e];if(o&&delete n[e],this.components[e]&&delete n[e],null!=o&&(null!=o.c1&&this.removeComponentEx(o.c1.id,t),null!=o.c2&&this.removeComponentEx(o.c2.id,t),""!=o.splitState.id&&n[o.splitState.id])){var r=Object.assign({},n[o.splitState.id]);o.splitState.isc1?r.c1=null:r.c2=null,n[r.id]=r}return t}},{key:"getAlign",value:function(e){if(e.type==h.a.TYPE_SPLIT)return"";var t={auto:"",left:"",center:"",right:""};return t[e.styles["text-align"]]="selected",'\n      <td>Align</td>\n      <td>\n        <select id="style-text-align" data-id="'.concat(e.id,'" data-style="text-align">\n          <option value="auto" ').concat(t.auto,'>Auto</option>\n          <option value="left" ').concat(t.left,'>Left</option>\n          <option value="center" ').concat(t.center,'>Center</option>\n          <option value="right" ').concat(t.right,">Right</option>\n        </select>\n      </td>")}},{key:"getMargins",value:function(e,t){var n=this.getAlign(t);return'\n      <table>\n        <td>Margins:</td>\n        <td>\n          <div>\n            <div>\n              Above\n              <input type="number" class="spinner" min="0" max="20" step="2" value="'.concat(parseInt(t.styles["margin-top"]),'" id="style-margin-top" data-id="').concat(e,'" data-style="margin-top">\n            </div>\n            <div>\n              Below\n              <input type="number" class="spinner" min="0" max="20" step="2" value="').concat(parseInt(t.styles["margin-bottom"]),'" id="style-margin-bottom" data-id="').concat(e,'" data-style="margin-bottom">\n            </div>\n          </div>\n        </td>\n        ').concat(n,'\n      </tr>\n      </table>\n      <button class="blue" id="styles-apply-all" data-id="').concat(e,'">Apply Styles to All</button>\n    ')}},{key:"getShiftBox",value:function(e){return 1==this.create.blog.componentOrder.length||this.create.blog.components[e].splitState.level?"":'<div class="shiftbox"><b>Shift</b>\n      <button class="btn-shift-up" data-id="'.concat(e,'"><i class="fa fa-chevron-up"></i></button>\n      <button class="btn-shift-down" data-id="').concat(e,'"><i class="fa fa-chevron-down"></i></button>\n      </div>')}},{key:"toggleShiftbuttons",value:function(){if(0!=$(".btn-shift-up").length){var e=$(".btn-shift-up").data("id"),t=this.create.blog.componentOrder,n=this.create.blog.components[e].splitState.level;$(".btn-shift-up").prop("disabled",0==t.indexOf(e)||n>0),$(".btn-shift-down").prop("disabled",t.indexOf(e)==t.length-1||n>0)}}},{key:"disposeAll",value:function(){var e,t=P(this.components);try{for(t.s();!(e=t.n()).done;)e.value}catch(e){t.e(e)}finally{t.f()}this.components=[]}},{key:"createBlogComponent",value:function(e){var t;switch(e.type){case h.a.TYPE_HEADING:t=new g(this,e);break;case h.a.TYPE_TEXT:t=new f(this,e);break;case h.a.TYPE_IMAGE:t=new b(this,e);break;case h.a.TYPE_DIVIDER:t=new w(this,e);break;case h.a.TYPE_SPLIT:t=new x(this,e);break;case h.a.TYPE_HTML:t=new A(this,e)}return this.components[e.id]=t,t}},{key:"drawGenericComponent",value:function(e,t){var n=this.compileStyles(e.styles);e.splitState.level>0&&(n="");var a='\n      <div class="component '.concat(e.type,'" style="').concat(n,'" id="').concat(e.id,'" data-id="').concat(e.id,'">\n        <div class="left dragger">\n          <div class="dragger-div"><i class="fa fa-ellipsis-v"></i></div>\n        </div>\n        <div class="component-content">\n          ').concat(t,"\n        </div>\n      </div>\n    ");if(0!=e.splitState.level)return a;$("#create-blog-content").append(a)}},{key:"compileStyles",value:function(e){var t=[""];for(var n in e)t.push("".concat(n,":").concat(e[n],";"));return t.join("")}},{key:"initDragDrog",value:function(){var e=this;this.dragId=null,this.dragType=null,$(".blog-pane").on("click",".dragger",this.appendNewComp),$(".blog-pane").on("mousedown",".dragger",(function(t){return e.setDraggable(t,!0)})),$(".blog-pane").on("mouseup",".dragger",(function(t){return e.setDraggable(t,!1)})),$(".blog-pane").on("dragstart",".component",this.startDrag),$(".blog-pane").on("dragover",".component, .split-droppable, .placeholder",this.dragOver),$(".blog-pane").on("dragleave",".component, .split-droppable, .placeholder",this.dragLeave),$(".blog-pane").on("dragend",".component",this.dragEnd),$(".blog-pane").on("drop",".component, .split-droppable, .placeholder",(function(t){return e.doDrop(t)}))}},{key:"doDrop",value:function(e){if(null!=this.dragId||null!=this.dragType){var t=this.create.blog;e.preventDefault();var n=$(e.target).closest(".component"),a=$(e.target).closest(".split-droppable");if(null!=a&&a.length>0){var o=$(e.target).closest(".split").data("id");if(o==this.dragId)return this.dragId=null,void(this.dragType=null);var r,i=$(a).hasClass("c1-container"),l=Object.assign([],t.componentOrder),c=Object.assign({},t.components),u=h.a.createBlogComponent(c[o]);if(this.dragType==h.a.TYPE_SPLIT&&u.splitState.level>=2)return s.a.alert("Error","You can't place that many split components inside each other."),this.dragId=null,void(this.dragType=null);if(i&&null!=u.c1||!i&&null!=u.c2)return s.a.alert("Error","There is already a component here!"),this.dragId=null,void(this.dragType=null);if(null!=this.dragId){if((r=h.a.createBlogComponent(c[this.dragId])).id==u.splitState.id)return s.a.alert("Error","Can't place a split component inside itself!"),this.dragId=null,void(this.dragType=null);if(-1!=l.indexOf(this.dragId)&&l.splice(l.indexOf(this.dragId),1),delete c[this.dragId],""!=r.splitState.id)if(r.splitState.id==o)r.splitState.isc1?u.c1=null:u.c2=null;else{var d=h.a.createBlogComponent(c[r.splitState.id]);r.splitState.isc1?d.c1=null:d.c2=null,c[r.splitState.id]=d}}else null!=this.dragType&&(r=h.a.createBlogComponent({type:this.dragType}));return i?u.c1=r.id:u.c2=r.id,r.splitState.level=u.splitState.level+1,r.splitState.id=u.id,r.splitState.isc1=i,this.fixSplitLevel(r,c,r.splitState.level+1),this.checkSplitFail(r,c)?(s.a.alert("Error","You can't place that many split components inside each other."),this.dragId=null,void(this.dragType=null)):(c[o]=u,c[r.id]=r,(m={}).components=c,m.componentOrder=l,this.create.action(m),this.create.draw(),this.dragId=null,void(this.dragType=null))}0==n.length&&(n=$(e.target));var p=$(n).data("id");if(this.dragId==p)return this.dragId=null,void(this.dragType=null);$("#create-blog-content .component.fake").remove();var g,m={};if(null!=this.dragId){g=this.dragId,c=Object.assign({},t.components);var f=h.a.createBlogComponent(c[g]);""!=f.splitState.id&&(u=h.a.createBlogComponent(c[f.splitState.id]),f.splitState.isc1?u.c1=null:u.c2=null,f.splitState=h.a.createSplitState({}),c[g]=f,c[u.id]=u,m.components=c,this.fixSplitLevel(f,c,1))}else if(null!=this.dragType){var v=h.a.createBlogComponent({type:this.dragType});(c=Object.assign({},t.components))[g=v.id]=v,m.components=c}if(-1!=(l=Object.assign([],t.componentOrder)).indexOf(g)&&l.splice(l.indexOf(g),1),"fake"==p)l.push(g);else{var b=l.indexOf(p);l.splice(b,0,g)}m.componentOrder=l,this.create.action(m),this.create.draw(),this.dragId=null,this.dragType=null}}},{key:"fixSplitLevel",value:function(e,t,n){if(null!=e.c1){var a=h.a.createBlogComponent(t[e.c1]);a.splitState.level=n,t[a.id]=a,a.type==h.a.TYPE_SPLIT&&this.fixSplitLevel(a,t,n+1)}if(null!=e.c2){var o=h.a.createBlogComponent(t[e.c2]);o.splitState.level=n,t[o.id]=o,o.type==h.a.TYPE_SPLIT&&this.fixSplitLevel(o,t,n+1)}}},{key:"checkSplitFail",value:function(e,t){var n=!1;return e.splitState.level>2&&e.type==h.a.TYPE_SPLIT&&(n=!0),null!=e.c1&&(t[e.c1].splitState.level>2&&t[e.c1].type==h.a.TYPE_SPLIT?n=!0:t[e.c1].type==h.a.TYPE_SPLIT&&(n|=this.checkSplitFail(t[e.c1],t))),null!=e.c2&&(t[e.c2].splitState.level>2&&t[e.c2].type==h.a.TYPE_SPLIT?n=!0:t[e.c2].type==h.a.TYPE_SPLIT&&(n|=this.checkSplitFail(t[e.c2],t))),n}}])&&z(t.prototype,n),a&&z(t,a),e}();function L(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function D(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var Y=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,(n=[{key:"load",value:function(e,t){var n=[],a=[];return null!=e.data.create.blog.content?(n.push("This blog is of an old format, please save first!"),e.create.state.setSavedDisplay(!1),[n,a]):(n.push(this.getTitleError(t)),n.push(this.getBlurbError(t)),this.getComponentsErrors(t,n),a.push(this.getBlurbWarning(t)),a.push(this.getNoThumbnailWarning(t)),this.getLengthError(n,a,t),[n=n.filter((function(e){return null!=e})),a=a.filter((function(e){return null!=e}))])}},{key:"getTitleError",value:function(e){var t=e.title.trim();return t.length<3?"The blog title can't be that short.":t.length>75?"The blog title can't be that long.":t.match(/\s+copy$/i)?'The blog title ends with "Copy". Please change it to something better.':null}},{key:"getBlurbError",value:function(e){return e.blurb.trim().length>500?"The blurb can't be that long.":null}},{key:"getLength",value:function(e){var t=0;for(var n in e.components){var a=e.components[n];a.type==h.a.TYPE_TEXT?t+=o.a.stripTags(a.text).length:a.type==h.a.TYPE_HTML?t+=a.html.length:a.type==h.a.TYPE_HEADING&&(t+=o.a.stripTags(a.text).length)}return t}},{key:"getLengthError",value:function(e,t,n){var a=this.getLength(n);a>5e4?e.push("Maximum 50,000 characters allowed in a blog, you're at "+a.toLocaleString()+" characters. Please shorten or consider splitting into multiple blogs."):a>4e4?t.push("There is a maximum 50,000 character limit for blogs, you're at "+a.toLocaleString()+" now."):a<500&&e.push("Minimum 500 characters allowed in a blog, sorry, you're at "+a.toLocaleString()+" now. We recommend writing something more substantial")}},{key:"getComponentsErrors",value:function(e,t){var n,a=L(e.componentOrder);try{for(a.s();!(n=a.n()).done;){var o=n.value,r=e.components[o];this.getComponentErrors(e,r,t)}}catch(e){a.e(e)}finally{a.f()}}},{key:"getComponentErrors",value:function(e,t,n){var a=[];switch(t.type){case h.a.TYPE_HEADING:a=this.getHeadingErrors(e,t);break;case h.a.TYPE_TEXT:a=this.getTextErrors(e,t);break;case h.a.TYPE_IMAGE:a=this.getImageErrors(e,t);break;case h.a.TYPE_DIVIDER:a=this.getDividerErrors(e,t);break;case h.a.TYPE_SPLIT:a=this.getSplitErrors(e,t);break;case h.a.TYPE_HTML:a=this.getHTMLErrors(e,t)}a.length>0&&n.push(this.createGenericError(e,t,a))}},{key:"createGenericError",value:function(e,t,n){if(0==t.splitState.level){var a=e.componentOrder.indexOf(t.id)+1;return o.a.capFirstLetter(t.type)+" at position "+a+" has the following errors:<ul><li>"+n.join("</li><li>")+"</li></ul>"}var r=t.splitState.isc1?"(Left, ":"(Right, ";return o.a.capFirstLetter(t.type)+" in split-view "+r+t.splitState.level+") has the following errors:<ul><li>"+n.join("</li><li>")+"</li></ul>"}},{key:"getHeadingErrors",value:function(e,t){var n=[];return t.text==h.a.DEFAULTS[h.a.TYPE_HEADING]&&n.push("Please change from the default heading"),""==t.text&&n.push("Cannot have a blank heading"),n}},{key:"getTextErrors",value:function(e,t){var n=[];return t.text==h.a.DEFAULTS[h.a.TYPE_TEXT]&&n.push("Please change from the default text"),""==t.text&&n.push("Cannot have a blank paragraph"),n}},{key:"getImageErrors",value:function(e,t){var n=[];return null==t.image&&n.push("Must contain an image"),n}},{key:"getDividerErrors",value:function(e,t){var n=[];return t.width>100&&n.push("Width must be less than 100%"),t.width<10&&n.push("Width must be at least 10%"),n}},{key:"getSplitErrors",value:function(e,t){var n=[];return["v","h"].includes(t.direction)||n.push("Invalid split orientation, must be Vertical or Horizontal"),null==t.c1?n.push("No first component found"):this.getComponentErrors(e,e.components[t.c1],n),null==t.c2?n.push("No second component found"):this.getComponentErrors(e,e.components[t.c2],n),n}},{key:"getHTMLErrors",value:function(e,t){var n=[];return""==t.html&&n.push("HTML can't be blank"),n}},{key:"getBlurbWarning",value:function(e){var t=e.blurb.trim();return t.length<20?"The blurb is short. Perhaps try summarising your blog in a sentence or two.":t.length>500?"The blurb can't be that long.":null}},{key:"getNoThumbnailWarning",value:function(e){return null===e.thumb?"Your blog has no thumbnail, perhaps you should add one!":null}}])&&D(t.prototype,n),a&&D(t,a),e}());function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,o=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==s.return||s.return()}finally{if(o)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function B(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var H=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.submit=function(e){n.create.state.canEdit()?Y.getLength(n.create.blog)>5e4?s.a.alert("Error","You have more than 50,000 characters"):i.a.go({url:"/api/create/blog/submit-blog.php",type:"POST",data:{id:n.create.blog.id,command:e},loading:"Submitting blog",callback:function(e){n.status=e,n.draw()}}):s.a.alert("Error","You don't have permission to do that")},this.drawErr=function(e){$("#blog-submit").html("<p>".concat(e,"</p>"))},this.draw=function(){var e=n.drawBody();$("#blog-submit").html("\n      ".concat(e,"\n    "))},this.create=t,this.page=t.page,this.status=null,$(".create-blog-page").on("click","#btn-submit-blog",(function(e){return n.submit("submit")}))}var t,n,a;return t=e,(n=[{key:"load",value:function(){var e=this;$("#blog-submit").html("");var t=this.create.blog;-1!=t.id?i.a.go({url:"/api/create/blog/check-blog-status.php",data:{id:t.id},loading:"Loading submit step",timeoutMsg:"Timeout loading submit step",callback:function(t){e.status=t,e.draw()},errCallback:this.drawErr}):this.drawErr("You must save your blog before submitting!")}},{key:"drawBody",value:function(){var e=this.create.blog,t=this.status,n=(t.user,t.status),a=t.url,o=t.userUrl,r="";if(null!==a&&null!==o&&(a="/users/".concat(o,"/blog/").concat(a),r='<div class="submit-url">Live Blog: <a href="'.concat(a,'" target="_blank">https://www.jetpunk.com').concat(a,"</a></div>")),!this.create.state.isSaved())return'<div class="submit-blurb">Your blog has unsaved changes.  Please save before previewing or submitting.</div>';var i,s=M(Y.load(this.page,e),2),l=s[0],c=s[1],u=this.status,d=(u.user,[]);0==(n=u.status)&&(l.length>0?i="This blog has errors that must be corrected before the blog can be previewed or submitted.":this.create.state.canEdit()?(i="When your blog is ready to be seen by others, hit the submit button!",d.push('<a href="/create-blog/'+e.id+'/preview" target="_blank"><button class="green">Preview Blog</button></a>'),d.push('<button class="blue" id="btn-submit-blog">Submit Blog</button>')):(i="This blog has been collaborated with you, you can save and preview but you may not submit.",d.push('<a href="/create-blog/'+e.id+'/preview" target="_blank"><button class="green">Preview Blog</button></a>'))),[1,2,3].includes(n)&&(l.length>0?i="Your blog is live, but the current version has unsubmitted errors that must be corrected before resubmitting.":this.create.state.canEdit()?(i="When you've made your changes, hit the submit button to push them live.",d.push('<a href="/create-blog/'+e.id+'/preview" target="_blank"><button class="green">Preview Blog</button></a>'),d.push('<button class="blue" id="btn-submit-blog">Resubmit Blog</button>')):(i="This blog has been collaborated with you, you can save and preview but you may not submit.",d.push('<a href="/create-blog/'+e.id+'/preview" target="_blank"><button class="green">Preview Blog</button></a>'))),4==n&&(i="Your blog is now live! Click the link below to view your live blog."),-1==n&&(i="Your blog is awaiting approval, in the meantime you may continue to make changes.",r="",d.push('<a href="/create-blog/'+e.id+'/preview" target="_blank"><button class="green">Preview Blog</button></a>')),-2==n&&(i="Your blog is awaiting reapproval, in the meantime you may continue to make changes.",r="",d.push('<a href="/create-blog/'+e.id+'/preview" target="_blank"><button class="green">Preview Blog</button></a>'));var h="";l.length>0&&(l=l.map((function(e){return'<div class="error">'.concat(e,"</div>")})).join(""),h='\n        <div class="error-display">\n          <div class="error-blurb">'.concat(i,"</div>\n          ").concat(l,"\n        </div>"),i="");var p="";return c.length>0&&(c=c.map((function(e){return'<div class="error">'.concat(e,"</div>")})).join(""),p='\n        <div class="error-display">\n          <div class="warning-blurb">Warnings: These things should probably be fixed.</div>\n          '.concat(c,"\n        </div>")),i=""==i?i:'<div class="submit-blurb">'.concat(i,"</div>"),d="<div class='button-row'>"+d.join("\t\t")+"</div>",0==l.length&&0==c.length&&(i+="<div class='blurb'><b>Note:</b> You're currently at "+Y.getLength(e).toLocaleString()+" characters. 50k is the maximum.</div>"),"\n      ".concat(i,"\n      ").concat(r,"\n      ").concat(h,"\n      ").concat(p,"\n      ").concat(d,"\n    ")}}])&&B(t.prototype,n),a&&B(t,a),e}();function q(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var W=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.create=t,this.page=t.page}var t,n,a;return t=e,(n=[{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if($("#quicklinks-content").html(""),e){var a,o=this.create.blog.components,i=[],s=q(this.create.blog.componentOrder);try{for(s.s();!(a=s.n()).done;){var l=a.value;o[l].type==h.a.TYPE_HEADING&&o[l].text!=h.a.DEFAULTS[h.a.TYPE_HEADING]&&i.push(o[l])}}catch(e){s.e(e)}finally{s.f()}if(0==i.length)return;for(var c=["<big><b>"+r.a.translate("Quick Links")+"</b></big><ul>"],u=0,d=i;u<d.length;u++){var p=d[u],g=t==p.id?n:p.text;c.push("<li><a href='#"+p.id+"'>"+g+"</a></li>")}c.push("</ul>"),$("#quicklinks-content").html(c.join(""))}}}])&&_(t.prototype,n),a&&_(t,a),e}(),V=n(21);function Q(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var Z=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.changeCheckbox=function(e){var t=e.target,a=t.name,o=t.checked;o!=n.blog[a]&&(n.action(K({},a,o)),n.draw())},this.changeProperty=function(e){var t=e.target,a=t.name,o=t.value;if("title"==a){var r=o;o=r.substr(0,75),document.title="Edit: "+o,r!=o&&$(".dashed-input[name=title]").val(o)}if("blurb"==a){var i=(500-o.length).toLocaleString();if($("#char-remaining-blurb").html(i),null!=e.originalEvent.data&&!h.a.ACTION_TRIGGERS.includes(e.originalEvent.data))return void n.state.setSavedDisplay(!1)}o!=n.blog[a]&&n.action(K({},a,o))},this.blurBlurb=function(e){var t=$(".dashed-input[name=blurb]").val().trim();n.blog.blurb!=t&&n.changeProperty(e)},this.page=t,this.page.create=this,this.blog=h.a.createBlog(t.data.create.blog),this.state=new V.a(this),this.componentsManager=new j(this),this.submitStep=new H(this),this.quicklinks=new W(this),this.state.draw(),this.state.changeStep(this.page.data.create.step),$(".create-blog-page").on("blur",".dashed-input[name=blurb]",this.blurBlurb),$(".create-blog-page").on("input",".dashed-input",this.changeProperty),$(".create-blog-page").on("change",".watched-select",this.changeProperty),$(".create-blog-page").on("click",".watched-checkbox",this.changeCheckbox)}var t,n,a;return t=e,(n=[{key:"action",value:function(e){this.state.action(e)}},{key:"drawBlurb",value:function(){$("textarea[name='blurb']").val(this.blog.blurb);var e=(500-this.blog.blurb.length).toLocaleString();$("#char-remaining-blurb").html(e)}},{key:"drawStep1",value:function(){this.state.drawThumb(),this.drawBlurb(),$("input[name='title']").val(this.blog.title),$("select[name='language']").val(this.blog.language),$("select[name='private']").val(this.blog.private),$("select[name='tag']").val(this.blog.tag)}},{key:"drawStep2",value:function(){$("input[name='quicklinks']").prop("checked",this.blog.quicklinks),this.quicklinks.draw(this.blog.quicklinks),this.componentsManager.disposeAll(),$("#create-blog-content").html(0==this.blog.componentOrder.length?"<div class='placeholder' data-id='fake'>Drag and Drop here</div>":"");var e,t=Q(this.blog.componentOrder);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.componentsManager.createBlogComponent(this.blog.components[n])}}catch(e){t.e(e)}finally{t.f()}}},{key:"draw",value:function(){"1"==this.state.step?this.drawStep1():"2"==this.state.step?this.drawStep2():"3"==this.state.step&&this.submitStep.load()}}])&&J(t.prototype,n),a&&J(t,a),e}();function ee(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ne(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function te(e){return function(e){if(Array.isArray(e))return ae(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ne(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){if(e){if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function oe(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var re=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.changeProperty=function(e){if(null!=n.selectedSeries){var t=e.target,a=t.name,o=t.value;if("name"==a){var r=o;o=r.substr(0,64),r!=o&&$(".dashed-input[name=name]").val(o)}if("description"==a){var i=o;o=i.substr(0,500),i!=o&&$(".dashed-input[name=description]").val(o)}o!=n.selectedSeries[a]&&(n.selectedSeries[a]=o,n.setSaved(!1))}},this.beforeUnload=function(){if(!n.saved)return"You have unsaved changes!"},this.setSaved=function(e){n.saved=e,$("#btn-save-series").prop("disabled",e)},this.createNew=function(){n.selectedSeries={id:-1,name:"",description:"",language:"english",contents:[]},n.draw()},this.editSeries=function(e){n.selectedId=$(e.target).closest(".series").data("id"),n.saved?n.editSeriesEx():s.a.choice("Warning","You have unsaved changes, are you sure you want to change series?",["Yes","Cancel"],[function(){return n.editSeriesEx()},null])},this.editSeriesEx=function(){if(!n.saved){var e;(e=n.unusedblogs).push.apply(e,te(n.additions));var t,a=ee(n.removals);try{for(a.s();!(t=a.n()).done;){var o=t.value;n.removeFromArray(n.unusedblogs,o)}}catch(e){a.e(e)}finally{a.f()}}n.additions=[],n.removals=[],n.setSaved(!0),n.selectedSeries=Object.assign({},n.series[n.selectedId]),n.selectedSeries.contents=Object.assign([],n.selectedSeries.contents),n.draw()},this.save=function(){if(null!=n.selectedSeries)if(""!=o.a.normalizeString(n.selectedSeries.name))if(0!=n.selectedSeries.contents.length){var e,t=ee(n.additions);try{for(t.s();!(e=t.n()).done;){var a=e.value;n.removeFromArray(n.unusedblogs,a)}}catch(e){t.e(e)}finally{t.f()}var r,l=ee(n.removals);try{for(l.s();!(r=l.n()).done;){a=r.value;n.unusedblogs.includes(a)||n.unusedblogs.push(a)}}catch(e){l.e(e)}finally{l.f()}i.a.go({url:"/api/blogs/save-blog-series.php",data:{series:JSON.stringify(n.selectedSeries)},loading:"Saving series ...",timeoutMsg:"Timeout. Series not saved.",callback:function(e){n.setSaved(!0),n.series[e.id]=e,-1==n.selectedSeries.id?s.a.alert("Success","Your series has been saved",(function(){return location.reload()})):s.a.alert("Success","Your series has been saved",(function(){return n.draw()}))}})}else s.a.alert("Error","Please add a blog to your series");else s.a.alert("Error","Please enter a name for your series")},this.delete=function(){null!=n.selectedSeries&&(-1!=n.selectedSeries.id?s.a.choice("Delete Series","Are you sure you want to delete this series?<p>The blogs in this series will <b>not</b> be deleted.</p>",["Yes","Cancel"],[n.deleteEx,null]):s.a.alert("Error","This series has not been created yet!"))},this.deleteEx=function(){i.a.go({url:"/api/blogs/delete-blog-series.php",data:{id:n.selectedSeries.id},loading:"Deleting series ...",timeoutMsg:"Timeout. Series not deleted.",callback:function(e){s.a.alert("Success","Your series has been deleted",(function(){return location.reload()}))}})},this.deleteSeries=function(e){n.selectedId=$(e.target).closest(".series").data("id"),n.selectedSeries=n.series[n.selectedId],n.delete()},this.clickBlog=function(e){var t=parseInt($(e.target).closest(".blog").data("id"));$(e.target).closest(".blog").hasClass("used")?n.removeBlog(t):n.addBlog(t)},this.drawSeries=function(e){var t=null!=n.selectedSeries&&n.selectedSeries.id==e.id?"used":"";return'\n      <div class="series item '.concat(t,'" data-id="').concat(e.id,'">\n        <div class="name">\n          ').concat(e.name,'\n        </div>\n        <div class="buttons">\n          <a href="/blog-series/').concat(n.page.user.url,"/").concat(e.url,'" target="_blank"><button class="btn-sm green">Live</button></a>\n          <button class="btn-sm blue series-edit">Edit</button>\n          <button class="btn-sm red series-delete">Delete</button>\n        </div>\n      </div>')},this.drawBlog=function(e){var t=n.selectedSeries.contents.includes(e)?"used":"",a=n.blogs[e],o=2==a.private?"<i class='fa fa-user-secret' name='Private'></i>":"";return'\n      <div class="blog item '.concat(t,'" data-id="').concat(a.id,'">\n        ').concat(a.title," ").concat(o,"\n      </div>")},this.seriesSort=function(e,t){return o.a.normalizeWords(e.name)>o.a.normalizeWords(t.name)?1:-1},this.strSort=function(e,t){return o.a.normalizeWords(n.blogs[e].title)>o.a.normalizeWords(n.blogs[t].title)?1:-1},this.page=t,this.unusedblogs=t.data.unusedblogs,this.series=t.data.series,this.blogs=t.data.blogs,this.editId=t.data.editid,this.saved=!0,this.additions=[],this.removals=[],this.selectedId=null,this.selectedSeries=null,$("#series-editor").hide(),$(".dashed-input").on("input",this.changeProperty),$(".watched-select").on("change",this.changeProperty),$("#btn-save-series").on("click",this.save),$("#btn-delete-series").on("click",this.delete),$("#btn-add-series").on("click",this.createNew),$(window).bind("beforeunload",this.beforeUnload),this.draw(),this.setSaved(!0),$(".list").on("click",".blog",this.clickBlog),$(".list").on("click",".series-edit, .series",this.editSeries),$(".list").on("click",".series-delete",this.deleteSeries),-1!=this.editId&&(this.selectedId=this.editId,this.selectedSeries=Object.assign({},this.series[this.selectedId]),this.selectedSeries.contents=Object.assign([],this.selectedSeries.contents),this.draw())}var t,n,a;return t=e,(n=[{key:"addBlog",value:function(e){this.additions.push(e),this.removeFromArray(this.removals,e),this.removeFromArray(this.unusedblogs,e),this.selectedSeries.contents.push(e),this.setSaved(!1),this.draw()}},{key:"removeBlog",value:function(e){this.removals.push(e),this.unusedblogs.push(e),this.removeFromArray(this.additions,e),this.removeFromArray(this.selectedSeries.contents,e),this.setSaved(!1),this.draw()}},{key:"draw",value:function(){var e,t=this,n=Object.assign([],this.series);if(n.sort(this.seriesSort),""==(n=n.map((function(e){return t.drawSeries(e)})).join(""))&&(n="<div class='placeholder'>"+r.a.translate("You have no blog series yet")+"</div>"),$("#series-list").html(n),null!=this.selectedSeries){var a=Object.assign([],this.unusedblogs);(e=a).push.apply(e,te(this.selectedSeries.contents)),a.sort(this.strSort),a=a.map((function(e){return t.drawBlog(e)})).join(""),$("#blog-list").html(a),$(".dashed-input[name=name]").val(this.selectedSeries.name),$(".dashed-input[name=description]").val(this.selectedSeries.description),$(".watched-select").val(this.selectedSeries.language),$("#series-editor").show(),$("#btn-delete-series").prop("disabled",-1==this.selectedSeries.id)}else $("#series-editor").hide()}},{key:"removeFromArray",value:function(e,t){-1!=e.indexOf(t)&&e.splice(e.indexOf(t),1)}}])&&oe(t.prototype,n),a&&oe(t,a),e}();n(37),$(document).ready((function(){var e=new a.a(_page);switch(e.pageType){case"create-blog":new Z(e);break;case"create-blog-series":new re(e);break;case"blog-page":case"blog-featured":case"blog-feed":case"blog-user":case"blog-tag":case"blog-tags-index":case"recent-blogs":case"user-blogs":case"blog-series":case"blog-series-index":case"create-blog-index":new d(e)}}))}]);